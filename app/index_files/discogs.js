/*1*/
function _log(a){if(_canLog){var b=Array.prototype.slice.apply(arguments,[1]),c=new Date,d=c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()+"."+c.getMilliseconds();b[0]=d+" - "+b[0];try{switch(a){case"info":window.console.info.apply(window.console,b);break;case"warn":window.console.warn.apply(window.console,b);break;default:window.console.log.apply(window.console,b)}}catch(e){window.console?-2146827850===e.number&&window.console.log(b.join(", ")):_canLog=!1}}}function _checkBrowser(){function a(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}}var b,c;return b=a(navigator.userAgent),c={},b.browser&&(c[b.browser]=!0,c.version=b.version),c.chrome?c.webkit=!0:c.webkit&&(c.safari=!0),c}function logMsg(){Array.prototype.unshift.apply(arguments,["debug"]),_log.apply(this,arguments)}function Breakpoints(a){function b(){var b,e=h.width(),f=[];for(b=0;d>b;b++)f.push(a[b].value<e),f[b]!=g[b]&&(c(a[b],f[b]),g[b]=f[b]);return f}function c(a,b){var c=f[1*b],d="breakpoint"+c+a.name;return h.trigger(d)}this._breakpoints=a=a||Breakpoints.defaults;var d=a.length,e=300,f=["<=",">"],g=[];this._published=g;var h=$(window);this.measure=function(){return b()},h.on("resize",_.throttle(b,e,{leading:!1}))}"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?(this._wrapped=a,void 0):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.2";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return arguments.length<2||c?a[x.random(a.length-1)]:x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={},f=null==c?x.identity:B(c);return y(b,function(c,g){var h=f.call(d,c,g,b);a(e,h,c)}),e}};x.groupBy=C(function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),!function(a,b){"use strict";function c(a,b){var c,d,e=a.toLowerCase();for(b=[].concat(b),c=0;c<b.length;c+=1)if(d=b[c]){if(d.test&&d.test(a))return!0;if(d.toLowerCase()===e)return!0}}var d=b.prototype.trim,e=b.prototype.trimRight,f=b.prototype.trimLeft,g=function(a){return 1*a||0},h=function(a,b){if(1>b)return"";for(var c="";b>0;)1&b&&(c+=a),b>>=1,a+=a;return c},i=[].slice,j=function(a){return null==a?"\\s":a.source?a.source:"["+o.escapeRegExp(a)+"]"},k={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},l={};for(var m in k)l[k[m]]=m;l["'"]="#39";var n=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var c=h,d=function(){return d.cache.hasOwnProperty(arguments[0])||(d.cache[arguments[0]]=d.parse(arguments[0])),d.format.call(null,d.cache[arguments[0]],arguments)};return d.format=function(d,e){var f,g,h,i,j,k,l,m=1,o=d.length,p="",q=[];for(g=0;o>g;g++)if(p=a(d[g]),"string"===p)q.push(d[g]);else if("array"===p){if(i=d[g],i[2])for(f=e[m],h=0;h<i[2].length;h++){if(!f.hasOwnProperty(i[2][h]))throw new Error(n('[_.sprintf] property "%s" does not exist',i[2][h]));f=f[i[2][h]]}else f=i[1]?e[i[1]]:e[m++];if(/[^s]/.test(i[8])&&"number"!=a(f))throw new Error(n("[_.sprintf] expecting number but found %s",a(f)));switch(i[8]){case"b":f=f.toString(2);break;case"c":f=b.fromCharCode(f);break;case"d":f=parseInt(f,10);break;case"e":f=i[7]?f.toExponential(i[7]):f.toExponential();break;case"f":f=i[7]?parseFloat(f).toFixed(i[7]):parseFloat(f);break;case"o":f=f.toString(8);break;case"s":f=(f=b(f))&&i[7]?f.substring(0,i[7]):f;break;case"u":f=Math.abs(f);break;case"x":f=f.toString(16);break;case"X":f=f.toString(16).toUpperCase()}f=/[def]/.test(i[8])&&i[3]&&f>=0?"+"+f:f,k=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",l=i[6]-b(f).length,j=i[6]?c(k,l):"",q.push(i[5]?f+j:j+f)}return q.join("")},d.cache={},d.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw new Error("[_.sprintf] huh?");if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw new Error("[_.sprintf] huh?");for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw new Error("[_.sprintf] huh?");f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");d.push(c)}b=b.substring(c[0].length)}return d},d}(),o={VERSION:"2.3.0",isBlank:function(a){return null==a&&(a=""),/^\s*$/.test(a)},stripTags:function(a){return null==a?"":b(a).replace(/<\/?[^>]+>/g,"")},capitalize:function(a){return a=null==a?"":b(a),a.charAt(0).toUpperCase()+a.slice(1)},chop:function(a,c){return null==a?[]:(a=b(a),c=~~c,c>0?a.match(new RegExp(".{1,"+c+"}","g")):[a])},clean:function(a){return o.strip(a).replace(/\s+/g," ")},count:function(a,c){if(null==a||null==c)return 0;a=b(a),c=b(c);for(var d=0,e=0,f=c.length;;){if(e=a.indexOf(c,e),-1===e)break;d++,e+=f}return d},chars:function(a){return null==a?[]:b(a).split("")},swapCase:function(a){return null==a?"":b(a).replace(/\S/g,function(a){return a===a.toUpperCase()?a.toLowerCase():a.toUpperCase()})},escapeHTML:function(a){return null==a?"":b(a).replace(/[&<>"']/g,function(a){return"&"+l[a]+";"})},unescapeHTML:function(a){return null==a?"":b(a).replace(/\&([^;]+);/g,function(a,c){var d;return c in k?k[c]:(d=c.match(/^#x([\da-fA-F]+)$/))?b.fromCharCode(parseInt(d[1],16)):(d=c.match(/^#(\d+)$/))?b.fromCharCode(~~d[1]):a})},escapeRegExp:function(a){return null==a?"":b(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(a,b,c,d){var e=o.chars(a);return e.splice(~~b,~~c,d),e.join("")},insert:function(a,b,c){return o.splice(a,b,0,c)},include:function(a,c){return""===c?!0:null==a?!1:-1!==b(a).indexOf(c)},join:function(){var a=i.call(arguments),b=a.shift();return null==b&&(b=""),a.join(b)},lines:function(a){return null==a?[]:b(a).split("\n")},reverse:function(a){return o.chars(a).reverse().join("")},startsWith:function(a,c){return""===c?!0:null==a||null==c?!1:(a=b(a),c=b(c),a.length>=c.length&&a.slice(0,c.length)===c)},endsWith:function(a,c){return""===c?!0:null==a||null==c?!1:(a=b(a),c=b(c),a.length>=c.length&&a.slice(a.length-c.length)===c)},succ:function(a){return null==a?"":(a=b(a),a.slice(0,-1)+b.fromCharCode(a.charCodeAt(a.length-1)+1))},titleize:function(a){return null==a?"":(a=b(a).toLowerCase(),a.replace(/(?:^|\s|-)\S/g,function(a){return a.toUpperCase()}))},camelize:function(a){return o.trim(a).replace(/[-_\s]+(.)?/g,function(a,b){return b?b.toUpperCase():""})},underscored:function(a){return o.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(a){return o.trim(a).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(a){return o.titleize(b(a).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(a){return o.capitalize(o.underscored(a).replace(/_id$/,"").replace(/_/g," "))},trim:function(a,c){return null==a?"":!c&&d?d.call(a):(c=j(c),b(a).replace(new RegExp("^"+c+"+|"+c+"+$","g"),""))},ltrim:function(a,c){return null==a?"":!c&&f?f.call(a):(c=j(c),b(a).replace(new RegExp("^"+c+"+"),""))},rtrim:function(a,c){return null==a?"":!c&&e?e.call(a):(c=j(c),b(a).replace(new RegExp(c+"+$"),""))},truncate:function(a,c,d){return null==a?"":(a=b(a),d=d||"...",c=~~c,a.length>c?a.slice(0,c)+d:a)},prune:function(a,c,d){if(null==a)return"";if(a=b(a),c=~~c,d=null!=d?b(d):"...",a.length<=c)return a;var e=function(a){return a.toUpperCase()!==a.toLowerCase()?"A":" "},f=a.slice(0,c+1).replace(/.(?=\W*\w*$)/g,e);return f=f.slice(f.length-2).match(/\w\w/)?f.replace(/\s*\S+$/,""):o.rtrim(f.slice(0,f.length-1)),(f+d).length>a.length?a:a.slice(0,f.length)+d},words:function(a,b){return o.isBlank(a)?[]:o.trim(a,b).split(b||/\s+/)},pad:function(a,c,d,e){a=null==a?"":b(a),c=~~c;var f=0;switch(d?d.length>1&&(d=d.charAt(0)):d=" ",e){case"right":return f=c-a.length,a+h(d,f);case"both":return f=c-a.length,h(d,Math.ceil(f/2))+a+h(d,Math.floor(f/2));default:return f=c-a.length,h(d,f)+a}},lpad:function(a,b,c){return o.pad(a,b,c)},rpad:function(a,b,c){return o.pad(a,b,c,"right")},lrpad:function(a,b,c){return o.pad(a,b,c,"both")},sprintf:n,vsprintf:function(a,b){return b.unshift(a),n.apply(null,b)},toNumber:function(a,b){return a?(a=o.trim(a),a.match(/^-?\d+(?:\.\d+)?$/)?g(g(a).toFixed(~~b)):0/0):0},numberFormat:function(a,b,c,d){if(isNaN(a)||null==a)return"";a=a.toFixed(~~b),d="string"==typeof d?d:",";var e=a.split("."),f=e[0],g=e[1]?(c||".")+e[1]:"";return f.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+d)+g},strRight:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.indexOf(c):-1;return~d?a.slice(d+c.length,a.length):a},strRightBack:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.lastIndexOf(c):-1;return~d?a.slice(d+c.length,a.length):a},strLeft:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.indexOf(c):-1;return~d?a.slice(0,d):a},strLeftBack:function(a,b){if(null==a)return"";a+="",b=null!=b?""+b:b;var c=a.lastIndexOf(b);return~c?a.slice(0,c):a},toSentence:function(a,b,c,d){b=b||", ",c=c||" and ";var e=a.slice(),f=e.pop();return a.length>2&&d&&(c=o.rtrim(b)+c),e.length?e.join(b)+c+f:f},toSentenceSerial:function(){var a=i.call(arguments);return a[3]=!0,o.toSentence.apply(o,a)},slugify:function(a){if(null==a)return"";var c="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",d="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",e=new RegExp(j(c),"g");return a=b(a).toLowerCase().replace(e,function(a){var b=c.indexOf(a);return d.charAt(b)||"-"}),o.dasherize(a.replace(/[^\w\s-]/g,""))},surround:function(a,b){return[b,a,b].join("")},quote:function(a,b){return o.surround(a,b||'"')},unquote:function(a,b){return b=b||'"',a[0]===b&&a[a.length-1]===b?a.slice(1,a.length-1):a},exports:function(){var a={};for(var b in this)this.hasOwnProperty(b)&&!b.match(/^(?:include|contains|reverse)$/)&&(a[b]=this[b]);return a},repeat:function(a,c,d){if(null==a)return"";if(c=~~c,null==d)return h(b(a),c);for(var e=[];c>0;e[--c]=a);return e.join(d)},naturalCmp:function(a,c){if(a==c)return 0;if(!a)return-1;if(!c)return 1;for(var d=/(\.\d+)|(\d+)|(\D+)/g,e=b(a).toLowerCase().match(d),f=b(c).toLowerCase().match(d),g=Math.min(e.length,f.length),h=0;g>h;h++){var i=e[h],j=f[h];if(i!==j){var k=parseInt(i,10);if(!isNaN(k)){var l=parseInt(j,10);if(!isNaN(l)&&k-l)return k-l}return j>i?-1:1}}return e.length===f.length?e.length-f.length:c>a?-1:1},levenshtein:function(a,c){if(null==a&&null==c)return 0;if(null==a)return b(c).length;if(null==c)return b(a).length;a=b(a),c=b(c);for(var d,e,f=[],g=0;g<=c.length;g++)for(var h=0;h<=a.length;h++)e=g&&h?a.charAt(h-1)===c.charAt(g-1)?d:Math.min(f[h],f[h-1],d)+1:g+h,d=f[h],f[h]=e;return f.pop()},toBoolean:function(a,b,d){return"number"==typeof a&&(a=""+a),"string"!=typeof a?!!a:(a=o.trim(a),c(a,b||["true","1"])?!0:c(a,d||["false","0"])?!1:void 0)}};o.strip=o.trim,o.lstrip=o.ltrim,o.rstrip=o.rtrim,o.center=o.lrpad,o.rjust=o.lpad,o.ljust=o.rpad,o.contains=o.include,o.q=o.quote,o.toBool=o.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=o),exports._s=o),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return o}),a._=a._||{},a._.string=a._.str=o}(this,String),function(a,b){function c(a){var b=a.length,c=ib.type(a);return ib.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function d(a){var b=xb[a]={};return ib.each(a.match(kb)||[],function(a,c){b[c]=!0}),b}function e(a,c,d,e){if(ib.acceptData(a)){var f,g,h=ib.expando,i="string"==typeof c,j=a.nodeType,k=j?ib.cache:a,l=j?a[h]:a[h]&&h;if(l&&k[l]&&(e||k[l].data)||!i||d!==b)return l||(j?a[h]=l=_.pop()||ib.guid++:l=h),k[l]||(k[l]={},j||(k[l].toJSON=ib.noop)),("object"==typeof c||"function"==typeof c)&&(e?k[l]=ib.extend(k[l],c):k[l].data=ib.extend(k[l].data,c)),f=k[l],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[ib.camelCase(c)]=d),i?(g=f[c],null==g&&(g=f[ib.camelCase(c)])):g=f,g}}function f(a,b,c){if(ib.acceptData(a)){var d,e,f,g=a.nodeType,i=g?ib.cache:a,j=g?a[ib.expando]:ib.expando;if(i[j]){if(b&&(f=c?i[j]:i[j].data)){ib.isArray(b)?b=b.concat(ib.map(b,ib.camelCase)):b in f?b=[b]:(b=ib.camelCase(b),b=b in f?[b]:b.split(" "));for(d=0,e=b.length;e>d;d++)delete f[b[d]];if(!(c?h:ib.isEmptyObject)(f))return}(c||(delete i[j].data,h(i[j])))&&(g?ib.cleanData([a],!0):ib.support.deleteExpando||i!=i.window?delete i[j]:i[j]=null)}}}function g(a,c,d){if(d===b&&1===a.nodeType){var e="data-"+c.replace(zb,"-$1").toLowerCase();if(d=a.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:yb.test(d)?ib.parseJSON(d):d}catch(f){}ib.data(a,c,d)}else d=b}return d}function h(a){var b;for(b in a)if(("data"!==b||!ib.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function i(){return!0}function j(){return!1}function k(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function l(a,b,c){if(b=b||0,ib.isFunction(b))return ib.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return ib.grep(a,function(a){return a===b===c});if("string"==typeof b){var d=ib.grep(a,function(a){return 1===a.nodeType});if(Rb.test(b))return ib.filter(b,d,!c);b=ib.filter(b,d)}return ib.grep(a,function(a){return ib.inArray(a,b)>=0===c})}function m(a){var b=Ub.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function n(a,b){return a.getElementsByTagName(b)[0]||a.appendChild(a.ownerDocument.createElement(b))}function o(a){var b=a.getAttributeNode("type");return a.type=(b&&b.specified)+"/"+a.type,a}function p(a){var b=ec.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function q(a,b){for(var c,d=0;null!=(c=a[d]);d++)ib._data(c,"globalEval",!b||ib._data(b[d],"globalEval"))}function r(a,b){if(1===b.nodeType&&ib.hasData(a)){var c,d,e,f=ib._data(a),g=ib._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)ib.event.add(b,c,h[c][d])}g.data&&(g.data=ib.extend({},g.data))}}function s(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!ib.support.noCloneEvent&&b[ib.expando]){e=ib._data(b);for(d in e.events)ib.removeEvent(b,d,e.handle);b.removeAttribute(ib.expando)}"script"===c&&b.text!==a.text?(o(b).text=a.text,p(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),ib.support.html5Clone&&a.innerHTML&&!ib.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&bc.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}function t(a,c){var d,e,f=0,g=typeof a.getElementsByTagName!==V?a.getElementsByTagName(c||"*"):typeof a.querySelectorAll!==V?a.querySelectorAll(c||"*"):b;if(!g)for(g=[],d=a.childNodes||a;null!=(e=d[f]);f++)!c||ib.nodeName(e,c)?g.push(e):ib.merge(g,t(e,c));return c===b||c&&ib.nodeName(a,c)?ib.merge([a],g):g}function u(a){bc.test(a.type)&&(a.defaultChecked=a.checked)}function v(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=yc.length;e--;)if(b=yc[e]+c,b in a)return b;return d}function w(a,b){return a=b||a,"none"===ib.css(a,"display")||!ib.contains(a.ownerDocument,a)}function x(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=ib._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&w(d)&&(f[g]=ib._data(d,"olddisplay",B(d.nodeName)))):f[g]||(e=w(d),(c&&"none"!==c||!e)&&ib._data(d,"olddisplay",e?c:ib.css(d,"display"))));
for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function y(a,b,c){var d=rc.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function z(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=ib.css(a,c+xc[f],!0,e)),d?("content"===c&&(g-=ib.css(a,"padding"+xc[f],!0,e)),"margin"!==c&&(g-=ib.css(a,"border"+xc[f]+"Width",!0,e))):(g+=ib.css(a,"padding"+xc[f],!0,e),"padding"!==c&&(g+=ib.css(a,"border"+xc[f]+"Width",!0,e)));return g}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=kc(a),g=ib.support.boxSizing&&"border-box"===ib.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=lc(a,b,f),(0>e||null==e)&&(e=a.style[b]),sc.test(e))return e;d=g&&(ib.support.boxSizingReliable||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a){var b=W,c=uc[a];return c||(c=C(a,b),"none"!==c&&c||(jc=(jc||ib("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b.documentElement),b=(jc[0].contentWindow||jc[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),c=C(a,b),jc.detach()),uc[a]=c),c}function C(a,b){var c=ib(b.createElement(a)).appendTo(b.body),d=ib.css(c[0],"display");return c.remove(),d}function D(a,b,c,d){var e;if(ib.isArray(b))ib.each(b,function(b,e){c||Ac.test(a)?d(a,e):D(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==ib.type(b))d(a,b);else for(e in b)D(a+"["+e+"]",b[e],c,d)}function E(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(kb)||[];if(ib.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function F(a,b,c,d){function e(h){var i;return f[h]=!0,ib.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===Rc;return e(b.dataTypes[0])||!f["*"]&&e("*")}function G(a,c){var d,e,f=ib.ajaxSettings.flatOptions||{};for(e in c)c[e]!==b&&((f[e]?a:d||(d={}))[e]=c[e]);return d&&ib.extend(!0,a,d),a}function H(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(h in k)h in d&&(c[k[h]]=d[h]);for(;"*"===j[0];)j.shift(),f===b&&(f=a.mimeType||c.getResponseHeader("Content-Type"));if(f)for(h in i)if(i[h]&&i[h].test(f)){j.unshift(h);break}if(j[0]in d)g=j[0];else{for(h in d){if(!j[0]||a.converters[h+" "+j[0]]){g=h;break}e||(e=h)}g=g||e}return g?(g!==j[0]&&j.unshift(g),d[g]):void 0}function I(a,b){var c,d,e,f,g={},h=0,i=a.dataTypes.slice(),j=i[0];if(a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i[1])for(e in a.converters)g[e.toLowerCase()]=a.converters[e];for(;d=i[++h];)if("*"!==d){if("*"!==j&&j!==d){if(e=g[j+" "+d]||g["* "+d],!e)for(c in g)if(f=c.split(" "),f[1]===d&&(e=g[j+" "+f[0]]||g["* "+f[0]])){e===!0?e=g[c]:g[c]!==!0&&(d=f[0],i.splice(h--,0,d));break}if(e!==!0)if(e&&a["throws"])b=e(b);else try{b=e(b)}catch(k){return{state:"parsererror",error:e?k:"No conversion from "+j+" to "+d}}}j=d}return{state:"success",data:b}}function J(){try{return new a.XMLHttpRequest}catch(b){}}function K(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function L(){return setTimeout(function(){$c=b}),$c=ib.now()}function M(a,b){ib.each(b,function(b,c){for(var d=(ed[b]||[]).concat(ed["*"]),e=0,f=d.length;f>e;e++)if(d[e].call(a,b,c))return})}function N(a,b,c){var d,e,f=0,g=dd.length,h=ib.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$c||L(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:ib.extend({},b),opts:ib.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$c||L(),duration:c.duration,tweens:[],createTween:function(b,c){var d=ib.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(O(k,j.opts.specialEasing);g>f;f++)if(d=dd[f].call(j,a,k,j.opts))return d;return M(j,k),ib.isFunction(j.opts.start)&&j.opts.start.call(a,j),ib.fx.timer(ib.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function O(a,b){var c,d,e,f,g;for(e in a)if(d=ib.camelCase(e),f=b[d],c=a[e],ib.isArray(c)&&(f=c[1],c=a[e]=c[0]),e!==d&&(a[d]=c,delete a[e]),g=ib.cssHooks[d],g&&"expand"in g){c=g.expand(c),delete a[d];for(e in c)e in a||(a[e]=c[e],b[e]=f)}else b[d]=f}function P(a,b,c){var d,e,f,g,h,i,j,k,l,m=this,n=a.style,o={},p=[],q=a.nodeType&&w(a);c.queue||(k=ib._queueHooks(a,"fx"),null==k.unqueued&&(k.unqueued=0,l=k.empty.fire,k.empty.fire=function(){k.unqueued||l()}),k.unqueued++,m.always(function(){m.always(function(){k.unqueued--,ib.queue(a,"fx").length||k.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],"inline"===ib.css(a,"display")&&"none"===ib.css(a,"float")&&(ib.support.inlineBlockNeedsLayout&&"inline"!==B(a.nodeName)?n.zoom=1:n.display="inline-block")),c.overflow&&(n.overflow="hidden",ib.support.shrinkWrapBlocks||m.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(e in b)if(g=b[e],ad.exec(g)){if(delete b[e],i=i||"toggle"===g,g===(q?"hide":"show"))continue;p.push(e)}if(f=p.length){h=ib._data(a,"fxshow")||ib._data(a,"fxshow",{}),"hidden"in h&&(q=h.hidden),i&&(h.hidden=!q),q?ib(a).show():m.done(function(){ib(a).hide()}),m.done(function(){var b;ib._removeData(a,"fxshow");for(b in o)ib.style(a,b,o[b])});for(e=0;f>e;e++)d=p[e],j=m.createTween(d,q?h[d]:0),o[d]=h[d]||ib.style(a,d),d in h||(h[d]=j.start,q&&(j.end=j.start,j.start="width"===d||"height"===d?1:0))}}function Q(a,b,c,d,e){return new Q.prototype.init(a,b,c,d,e)}function R(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=xc[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function S(a){return ib.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var T,U,V=typeof b,W=a.document,X=a.location,Y=a.jQuery,Z=a.$,$={},_=[],ab="1.9.1",bb=_.concat,cb=_.push,db=_.slice,eb=_.indexOf,fb=$.toString,gb=$.hasOwnProperty,hb=ab.trim,ib=function(a,b){return new ib.fn.init(a,b,U)},jb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,kb=/\S+/g,lb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,mb=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,nb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ob=/^[\],:{}\s]*$/,pb=/(?:^|:|,)(?:\s*\[)+/g,qb=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,sb=/^-ms-/,tb=/-([\da-z])/gi,ub=function(a,b){return b.toUpperCase()},vb=function(a){(W.addEventListener||"load"===a.type||"complete"===W.readyState)&&(wb(),ib.ready())},wb=function(){W.addEventListener?(W.removeEventListener("DOMContentLoaded",vb,!1),a.removeEventListener("load",vb,!1)):(W.detachEvent("onreadystatechange",vb),a.detachEvent("onload",vb))};ib.fn=ib.prototype={jquery:ab,constructor:ib,init:function(a,c,d){var e,f;if(!a)return this;if("string"==typeof a){if(e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:mb.exec(a),!e||!e[1]&&c)return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a);if(e[1]){if(c=c instanceof ib?c[0]:c,ib.merge(this,ib.parseHTML(e[1],c&&c.nodeType?c.ownerDocument||c:W,!0)),nb.test(e[1])&&ib.isPlainObject(c))for(e in c)ib.isFunction(this[e])?this[e](c[e]):this.attr(e,c[e]);return this}if(f=W.getElementById(e[2]),f&&f.parentNode){if(f.id!==e[2])return d.find(a);this.length=1,this[0]=f}return this.context=W,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):ib.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),ib.makeArray(a,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return db.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a){var b=ib.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return ib.each(this,a,b)},ready:function(a){return ib.ready.promise().done(a),this},slice:function(){return this.pushStack(db.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},map:function(a){return this.pushStack(ib.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:cb,sort:[].sort,splice:[].splice},ib.fn.init.prototype=ib.fn,ib.extend=ib.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[1]||{},i=2),"object"==typeof h||ib.isFunction(h)||(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(f=arguments[i]))for(e in f)a=h[e],d=f[e],h!==d&&(k&&d&&(ib.isPlainObject(d)||(c=ib.isArray(d)))?(c?(c=!1,g=a&&ib.isArray(a)?a:[]):g=a&&ib.isPlainObject(a)?a:{},h[e]=ib.extend(k,g,d)):d!==b&&(h[e]=d));return h},ib.extend({noConflict:function(b){return a.$===ib&&(a.$=Z),b&&a.jQuery===ib&&(a.jQuery=Y),ib},isReady:!1,readyWait:1,holdReady:function(a){a?ib.readyWait++:ib.ready(!0)},ready:function(a){if(a===!0?!--ib.readyWait:!ib.isReady){if(!W.body)return setTimeout(ib.ready);ib.isReady=!0,a!==!0&&--ib.readyWait>0||(T.resolveWith(W,[ib]),ib.fn.trigger&&ib(W).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===ib.type(a)},isArray:Array.isArray||function(a){return"array"===ib.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?$[fb.call(a)]||"object":typeof a},isPlainObject:function(a){if(!a||"object"!==ib.type(a)||a.nodeType||ib.isWindow(a))return!1;try{if(a.constructor&&!gb.call(a,"constructor")&&!gb.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||gb.call(a,d)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},error:function(a){throw new Error(a)},parseHTML:function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||W;var d=nb.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=ib.buildFragment([a],b,e),e&&ib(e).remove(),ib.merge([],d.childNodes))},parseJSON:function(b){return a.JSON&&a.JSON.parse?a.JSON.parse(b):null===b?b:"string"==typeof b&&(b=ib.trim(b),b&&ob.test(b.replace(qb,"@").replace(rb,"]").replace(pb,"")))?new Function("return "+b)():(ib.error("Invalid JSON: "+b),void 0)},parseXML:function(c){var d,e;if(!c||"string"!=typeof c)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return d&&d.documentElement&&!d.getElementsByTagName("parsererror").length||ib.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&ib.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(sb,"ms-").replace(tb,ub)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:hb&&!hb.call("﻿ ")?function(a){return null==a?"":hb.call(a)}:function(a){return null==a?"":(a+"").replace(lb,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?ib.merge(d,"string"==typeof a?[a]:a):cb.call(d,a)),d},inArray:function(a,b,c){var d;if(b){if(eb)return eb.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"==typeof d)for(;d>f;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;for(c=!!c;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&(i[i.length]=e);else for(f in a)e=b(a[f],f,d),null!=e&&(i[i.length]=e);return bb.apply([],i)},guid:1,proxy:function(a,c){var d,e,f;return"string"==typeof c&&(f=a[c],c=a,a=f),ib.isFunction(a)?(d=db.call(arguments,2),e=function(){return a.apply(c||this,d.concat(db.call(arguments)))},e.guid=a.guid=a.guid||ib.guid++,e):b},access:function(a,c,d,e,f,g,h){var i=0,j=a.length,k=null==d;if("object"===ib.type(d)){f=!0;for(i in d)ib.access(a,c,i,d[i],!0,g,h)}else if(e!==b&&(f=!0,ib.isFunction(e)||(h=!0),k&&(h?(c.call(a,e),c=null):(k=c,c=function(a,b,c){return k.call(ib(a),c)})),c))for(;j>i;i++)c(a[i],d,h?e:e.call(a[i],i,c(a[i],d)));return f?a:k?c.call(a):j?c(a[0],d):g},now:function(){return(new Date).getTime()}}),ib.ready.promise=function(b){if(!T)if(T=ib.Deferred(),"complete"===W.readyState)setTimeout(ib.ready);else if(W.addEventListener)W.addEventListener("DOMContentLoaded",vb,!1),a.addEventListener("load",vb,!1);else{W.attachEvent("onreadystatechange",vb),a.attachEvent("onload",vb);var c=!1;try{c=null==a.frameElement&&W.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!ib.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}wb(),ib.ready()}}()}return T.promise(b)},ib.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){$["[object "+b+"]"]=b.toLowerCase()}),U=ib(W);var xb={};ib.Callbacks=function(a){a="string"==typeof a?xb[a]||d(a):ib.extend({},a);var c,e,f,g,h,i,j=[],k=!a.once&&[],l=function(b){for(e=a.memory&&b,f=!0,h=i||0,i=0,g=j.length,c=!0;j&&g>h;h++)if(j[h].apply(b[0],b[1])===!1&&a.stopOnFalse){e=!1;break}c=!1,j&&(k?k.length&&l(k.shift()):e?j=[]:m.disable())},m={add:function(){if(j){var b=j.length;!function d(b){ib.each(b,function(b,c){var e=ib.type(c);"function"===e?a.unique&&m.has(c)||j.push(c):c&&c.length&&"string"!==e&&d(c)})}(arguments),c?g=j.length:e&&(i=b,l(e))}return this},remove:function(){return j&&ib.each(arguments,function(a,b){for(var d;(d=ib.inArray(b,j,d))>-1;)j.splice(d,1),c&&(g>=d&&g--,h>=d&&h--)}),this},has:function(a){return a?ib.inArray(a,j)>-1:!(!j||!j.length)},empty:function(){return j=[],this},disable:function(){return j=k=e=b,this},disabled:function(){return!j},lock:function(){return k=b,e||m.disable(),this},locked:function(){return!k},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],!j||f&&!k||(c?k.push(b):l(b)),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!f}};return m},ib.extend({Deferred:function(a){var b=[["resolve","done",ib.Callbacks("once memory"),"resolved"],["reject","fail",ib.Callbacks("once memory"),"rejected"],["notify","progress",ib.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return ib.Deferred(function(c){ib.each(b,function(b,f){var g=f[0],h=ib.isFunction(a[b])&&a[b];e[f[1]](function(){var a=h&&h.apply(this,arguments);a&&ib.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[g+"With"](this===d?c.promise():this,h?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?ib.extend(a,d):d}},e={};return d.pipe=d.then,ib.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=db.call(arguments),g=f.length,h=1!==g||a&&ib.isFunction(a.promise)?g:0,i=1===h?a:ib.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?db.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&ib.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}}),ib.support=function(){var b,c,d,e,f,g,h,i,j,k,l=W.createElement("div");if(l.setAttribute("className","t"),l.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=l.getElementsByTagName("*"),d=l.getElementsByTagName("a")[0],!c||!d||!c.length)return{};f=W.createElement("select"),h=f.appendChild(W.createElement("option")),e=l.getElementsByTagName("input")[0],d.style.cssText="top:1px;float:left;opacity:.5",b={getSetAttribute:"t"!==l.className,leadingWhitespace:3===l.firstChild.nodeType,tbody:!l.getElementsByTagName("tbody").length,htmlSerialize:!!l.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:!!e.value,optSelected:h.selected,enctype:!!W.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==W.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===W.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},e.checked=!0,b.noCloneChecked=e.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!h.disabled;try{delete l.test}catch(m){b.deleteExpando=!1}e=W.createElement("input"),e.setAttribute("value",""),b.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),b.radioValue="t"===e.value,e.setAttribute("checked","t"),e.setAttribute("name","t"),g=W.createDocumentFragment(),g.appendChild(e),b.appendChecked=e.checked,b.checkClone=g.cloneNode(!0).cloneNode(!0).lastChild.checked,l.attachEvent&&(l.attachEvent("onclick",function(){b.noCloneEvent=!1}),l.cloneNode(!0).click());for(k in{submit:!0,change:!0,focusin:!0})l.setAttribute(i="on"+k,"t"),b[k+"Bubbles"]=i in a||l.attributes[i].expando===!1;return l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle="content-box"===l.style.backgroundClip,ib(function(){var c,d,e,f="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",g=W.getElementsByTagName("body")[0];g&&(c=W.createElement("div"),c.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",g.appendChild(c).appendChild(l),l.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=l.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",j=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",b.reliableHiddenOffsets=j&&0===e[0].offsetHeight,l.innerHTML="",l.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=4===l.offsetWidth,b.doesNotIncludeMarginInBodyOffset=1!==g.offsetTop,a.getComputedStyle&&(b.pixelPosition="1%"!==(a.getComputedStyle(l,null)||{}).top,b.boxSizingReliable="4px"===(a.getComputedStyle(l,null)||{width:"4px"}).width,d=l.appendChild(W.createElement("div")),d.style.cssText=l.style.cssText=f,d.style.marginRight=d.style.width="0",l.style.width="1px",b.reliableMarginRight=!parseFloat((a.getComputedStyle(d,null)||{}).marginRight)),typeof l.style.zoom!==V&&(l.innerHTML="",l.style.cssText=f+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=3===l.offsetWidth,l.style.display="block",l.innerHTML="<div></div>",l.firstChild.style.width="5px",b.shrinkWrapBlocks=3!==l.offsetWidth,b.inlineBlockNeedsLayout&&(g.style.zoom=1)),g.removeChild(c),c=l=e=d=null)}),c=f=g=h=d=e=null,b}();var yb=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,zb=/([A-Z])/g;ib.extend({cache:{},expando:"jQuery"+(ab+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?ib.cache[a[ib.expando]]:a[ib.expando],!!a&&!h(a)},data:function(a,b,c){return e(a,b,c)},removeData:function(a,b){return f(a,b)},_data:function(a,b,c){return e(a,b,c,!0)},_removeData:function(a,b){return f(a,b,!0)},acceptData:function(a){if(a.nodeType&&1!==a.nodeType&&9!==a.nodeType)return!1;var b=a.nodeName&&ib.noData[a.nodeName.toLowerCase()];return!b||b!==!0&&a.getAttribute("classid")===b}}),ib.fn.extend({data:function(a,c){var d,e,f=this[0],h=0,i=null;if(a===b){if(this.length&&(i=ib.data(f),1===f.nodeType&&!ib._data(f,"parsedAttrs"))){for(d=f.attributes;h<d.length;h++)e=d[h].name,e.indexOf("data-")||(e=ib.camelCase(e.slice(5)),g(f,e,i[e]));ib._data(f,"parsedAttrs",!0)}return i}return"object"==typeof a?this.each(function(){ib.data(this,a)}):ib.access(this,function(c){return c===b?f?g(f,a,ib.data(f,a)):null:(this.each(function(){ib.data(this,a,c)}),void 0)},null,c,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){ib.removeData(this,a)})}}),ib.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=ib._data(a,b),c&&(!d||ib.isArray(c)?d=ib._data(a,b,ib.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=ib.queue(a,b),d=c.length,e=c.shift(),f=ib._queueHooks(a,b),g=function(){ib.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),f.cur=e,e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return ib._data(a,c)||ib._data(a,c,{empty:ib.Callbacks("once memory").add(function(){ib._removeData(a,b+"queue"),ib._removeData(a,c)})})}}),ib.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),arguments.length<d?ib.queue(this[0],a):c===b?this:this.each(function(){var b=ib.queue(this,a,c);ib._queueHooks(this,a),"fx"===a&&"inprogress"!==b[0]&&ib.dequeue(this,a)})},dequeue:function(a){return this.each(function(){ib.dequeue(this,a)})},delay:function(a,b){return a=ib.fx?ib.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=ib.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};for("string"!=typeof a&&(c=a,a=b),a=a||"fx";h--;)d=ib._data(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var Ab,Bb,Cb=/[\t\r\n]/g,Db=/\r/g,Eb=/^(?:input|select|textarea|button|object)$/i,Fb=/^(?:a|area)$/i,Gb=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Hb=/^(?:checked|selected)$/i,Ib=ib.support.getSetAttribute,Jb=ib.support.input;ib.fn.extend({attr:function(a,b){return ib.access(this,ib.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){ib.removeAttr(this,a)})},prop:function(a,b){return ib.access(this,ib.prop,a,b,arguments.length>1)},removeProp:function(a){return a=ib.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g=0,h=this.length,i="string"==typeof a&&a;if(ib.isFunction(a))return this.each(function(b){ib(this).addClass(a.call(this,b,this.className))});if(i)for(b=(a||"").match(kb)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Cb," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");c.className=ib.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this.length,i=0===arguments.length||"string"==typeof a&&a;if(ib.isFunction(a))return this.each(function(b){ib(this).removeClass(a.call(this,b,this.className))});if(i)for(b=(a||"").match(kb)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Cb," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");c.className=a?ib.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a,d="boolean"==typeof b;return ib.isFunction(a)?this.each(function(c){ib(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var e,f=0,g=ib(this),h=b,i=a.match(kb)||[];e=i[f++];)h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e);else(c===V||"boolean"===c)&&(this.className&&ib._data(this,"__className__",this.className),this.className=this.className||a===!1?"":ib._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(Cb," ").indexOf(b)>=0)return!0;return!1},val:function(a){var c,d,e,f=this[0];{if(arguments.length)return e=ib.isFunction(a),this.each(function(c){var f,g=ib(this);1===this.nodeType&&(f=e?a.call(this,c,g.val()):a,null==f?f="":"number"==typeof f?f+="":ib.isArray(f)&&(f=ib.map(f,function(a){return null==a?"":a+""})),d=ib.valHooks[this.type]||ib.valHooks[this.nodeName.toLowerCase()],d&&"set"in d&&d.set(this,f,"value")!==b||(this.value=f))});if(f)return d=ib.valHooks[f.type]||ib.valHooks[f.nodeName.toLowerCase()],d&&"get"in d&&(c=d.get(f,"value"))!==b?c:(c=f.value,"string"==typeof c?c.replace(Db,""):null==c?"":c)}}}),ib.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(ib.support.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&ib.nodeName(c.parentNode,"optgroup"))){if(b=ib(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c=ib.makeArray(b);return ib(a).find("option").each(function(){this.selected=ib.inArray(ib(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attr:function(a,c,d){var e,f,g,h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h)return typeof a.getAttribute===V?ib.prop(a,c,d):(f=1!==h||!ib.isXMLDoc(a),f&&(c=c.toLowerCase(),e=ib.attrHooks[c]||(Gb.test(c)?Bb:Ab)),d===b?e&&f&&"get"in e&&null!==(g=e.get(a,c))?g:(typeof a.getAttribute!==V&&(g=a.getAttribute(c)),null==g?b:g):null!==d?e&&f&&"set"in e&&(g=e.set(a,d,c))!==b?g:(a.setAttribute(c,d+""),d):(ib.removeAttr(a,c),void 0))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(kb);if(f&&1===a.nodeType)for(;c=f[e++];)d=ib.propFix[c]||c,Gb.test(c)?!Ib&&Hb.test(c)?a[ib.camelCase("default-"+c)]=a[d]=!1:a[d]=!1:ib.attr(a,c,""),a.removeAttribute(Ib?c:d)},attrHooks:{type:{set:function(a,b){if(!ib.support.radioValue&&"radio"===b&&ib.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h)return g=1!==h||!ib.isXMLDoc(a),g&&(c=ib.propFix[c]||c,f=ib.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):Eb.test(a.nodeName)||Fb.test(a.nodeName)&&a.href?0:b}}}}),Bb={get:function(a,c){var d=ib.prop(a,c),e="boolean"==typeof d&&a.getAttribute(c),f="boolean"==typeof d?Jb&&Ib?null!=e:Hb.test(c)?a[ib.camelCase("default-"+c)]:!!e:a.getAttributeNode(c);return f&&f.value!==!1?c.toLowerCase():b},set:function(a,b,c){return b===!1?ib.removeAttr(a,c):Jb&&Ib||!Hb.test(c)?a.setAttribute(!Ib&&ib.propFix[c]||c,c):a[ib.camelCase("default-"+c)]=a[c]=!0,c}},Jb&&Ib||(ib.attrHooks.value={get:function(a,c){var d=a.getAttributeNode(c);return ib.nodeName(a,"input")?a.defaultValue:d&&d.specified?d.value:b},set:function(a,b,c){return ib.nodeName(a,"input")?(a.defaultValue=b,void 0):Ab&&Ab.set(a,b,c)}}),Ib||(Ab=ib.valHooks.button={get:function(a,c){var d=a.getAttributeNode(c);return d&&("id"===c||"name"===c||"coords"===c?""!==d.value:d.specified)?d.value:b},set:function(a,c,d){var e=a.getAttributeNode(d);return e||a.setAttributeNode(e=a.ownerDocument.createAttribute(d)),e.value=c+="","value"===d||c===a.getAttribute(d)?c:b}},ib.attrHooks.contenteditable={get:Ab.get,set:function(a,b,c){Ab.set(a,""===b?!1:b,c)}},ib.each(["width","height"],function(a,b){ib.attrHooks[b]=ib.extend(ib.attrHooks[b],{set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}})})),ib.support.hrefNormalized||(ib.each(["href","src","width","height"],function(a,c){ib.attrHooks[c]=ib.extend(ib.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return null==d?b:d}})}),ib.each(["href","src"],function(a,b){ib.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}})),ib.support.style||(ib.attrHooks.style={get:function(a){return a.style.cssText||b},set:function(a,b){return a.style.cssText=b+""}}),ib.support.optSelected||(ib.propHooks.selected=ib.extend(ib.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),ib.support.enctype||(ib.propFix.enctype="encoding"),ib.support.checkOn||ib.each(["radio","checkbox"],function(){ib.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}}),ib.each(["radio","checkbox"],function(){ib.valHooks[this]=ib.extend(ib.valHooks[this],{set:function(a,b){return ib.isArray(b)?a.checked=ib.inArray(ib(a).val(),b)>=0:void 0}})});var Kb=/^(?:input|select|textarea)$/i,Lb=/^key/,Mb=/^(?:mouse|contextmenu)|click/,Nb=/^(?:focusinfocus|focusoutblur)$/,Ob=/^([^.]*)(?:\.(.+)|)$/;ib.event={global:{},add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r=ib._data(a);if(r){for(d.handler&&(j=d,d=j.handler,f=j.selector),d.guid||(d.guid=ib.guid++),(h=r.events)||(h=r.events={}),(l=r.handle)||(l=r.handle=function(a){return typeof ib===V||a&&ib.event.triggered===a.type?b:ib.event.dispatch.apply(l.elem,arguments)},l.elem=a),c=(c||"").match(kb)||[""],i=c.length;i--;)g=Ob.exec(c[i])||[],o=q=g[1],p=(g[2]||"").split(".").sort(),k=ib.event.special[o]||{},o=(f?k.delegateType:k.bindType)||o,k=ib.event.special[o]||{},m=ib.extend({type:o,origType:q,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&ib.expr.match.needsContext.test(f),namespace:p.join(".")},j),(n=h[o])||(n=h[o]=[],n.delegateCount=0,k.setup&&k.setup.call(a,e,p,l)!==!1||(a.addEventListener?a.addEventListener(o,l,!1):a.attachEvent&&a.attachEvent("on"+o,l))),k.add&&(k.add.call(a,m),m.handler.guid||(m.handler.guid=d.guid)),f?n.splice(n.delegateCount++,0,m):n.push(m),ib.event.global[o]=!0;a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=ib.hasData(a)&&ib._data(a);if(q&&(k=q.events)){for(b=(b||"").match(kb)||[""],j=b.length;j--;)if(h=Ob.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=ib.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||ib.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)ib.event.remove(a,n+b[j],c,d,!0);ib.isEmptyObject(k)&&(delete q.handle,ib._removeData(a,"events"))}},trigger:function(c,d,e,f){var g,h,i,j,k,l,m,n=[e||W],o=gb.call(c,"type")?c.type:c,p=gb.call(c,"namespace")?c.namespace.split("."):[];if(i=l=e=e||W,3!==e.nodeType&&8!==e.nodeType&&!Nb.test(o+ib.event.triggered)&&(o.indexOf(".")>=0&&(p=o.split("."),o=p.shift(),p.sort()),h=o.indexOf(":")<0&&"on"+o,c=c[ib.expando]?c:new ib.Event(o,"object"==typeof c&&c),c.isTrigger=!0,c.namespace=p.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=b,c.target||(c.target=e),d=null==d?[c]:ib.makeArray(d,[c]),k=ib.event.special[o]||{},f||!k.trigger||k.trigger.apply(e,d)!==!1)){if(!f&&!k.noBubble&&!ib.isWindow(e)){for(j=k.delegateType||o,Nb.test(j+o)||(i=i.parentNode);i;i=i.parentNode)n.push(i),l=i;
l===(e.ownerDocument||W)&&n.push(l.defaultView||l.parentWindow||a)}for(m=0;(i=n[m++])&&!c.isPropagationStopped();)c.type=m>1?j:k.bindType||o,g=(ib._data(i,"events")||{})[c.type]&&ib._data(i,"handle"),g&&g.apply(i,d),g=h&&i[h],g&&ib.acceptData(i)&&g.apply&&g.apply(i,d)===!1&&c.preventDefault();if(c.type=o,!(f||c.isDefaultPrevented()||k._default&&k._default.apply(e.ownerDocument,d)!==!1||"click"===o&&ib.nodeName(e,"a")||!ib.acceptData(e)||!h||!e[o]||ib.isWindow(e))){l=e[h],l&&(e[h]=null),ib.event.triggered=o;try{e[o]()}catch(q){}ib.event.triggered=b,l&&(e[h]=l)}return c.result}},dispatch:function(a){a=ib.event.fix(a);var c,d,e,f,g,h=[],i=db.call(arguments),j=(ib._data(this,"events")||{})[a.type]||[],k=ib.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){for(h=ib.event.handlers.call(this,a,j),c=0;(f=h[c++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,g=0;(e=f.handlers[g++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,d=((ib.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),d!==b&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,c){var d,e,f,g,h=[],i=c.delegateCount,j=a.target;if(i&&j.nodeType&&(!a.button||"click"!==a.type))for(;j!=this;j=j.parentNode||this)if(1===j.nodeType&&(j.disabled!==!0||"click"!==a.type)){for(f=[],g=0;i>g;g++)e=c[g],d=e.selector+" ",f[d]===b&&(f[d]=e.needsContext?ib(d,this).index(j)>=0:ib.find(d,this,null,[j]).length),f[d]&&f.push(e);f.length&&h.push({elem:j,handlers:f})}return i<c.length&&h.push({elem:this,handlers:c.slice(i)}),h},fix:function(a){if(a[ib.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Mb.test(e)?this.mouseHooks:Lb.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new ib.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||W),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f,g=c.button,h=c.fromElement;return null==a.pageX&&null!=c.clientX&&(e=a.target.ownerDocument||W,f=e.documentElement,d=e.body,a.pageX=c.clientX+(f&&f.scrollLeft||d&&d.scrollLeft||0)-(f&&f.clientLeft||d&&d.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||d&&d.scrollTop||0)-(f&&f.clientTop||d&&d.clientTop||0)),!a.relatedTarget&&h&&(a.relatedTarget=h===a.target?c.toElement:h),a.which||g===b||(a.which=1&g?1:2&g?3:4&g?2:0),a}},special:{load:{noBubble:!0},click:{trigger:function(){return ib.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0}},focus:{trigger:function(){if(this!==W.activeElement&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===W.activeElement&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},beforeunload:{postDispatch:function(a){a.result!==b&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=ib.extend(new ib.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?ib.event.trigger(e,null,b):ib.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},ib.removeEvent=W.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===V&&(a[d]=null),a.detachEvent(d,c))},ib.Event=function(a,b){return this instanceof ib.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?i:j):this.type=a,b&&ib.extend(this,b),this.timeStamp=a&&a.timeStamp||ib.now(),this[ib.expando]=!0,void 0):new ib.Event(a,b)},ib.Event.prototype={isDefaultPrevented:j,isPropagationStopped:j,isImmediatePropagationStopped:j,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=i,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=i,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=i,this.stopPropagation()}},ib.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){ib.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!ib.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),ib.support.submitBubbles||(ib.event.special.submit={setup:function(){return ib.nodeName(this,"form")?!1:(ib.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=ib.nodeName(c,"input")||ib.nodeName(c,"button")?c.form:b;d&&!ib._data(d,"submitBubbles")&&(ib.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),ib._data(d,"submitBubbles",!0))}),void 0)},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&ib.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return ib.nodeName(this,"form")?!1:(ib.event.remove(this,"._submit"),void 0)}}),ib.support.changeBubbles||(ib.event.special.change={setup:function(){return Kb.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ib.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),ib.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),ib.event.simulate("change",this,a,!0)})),!1):(ib.event.add(this,"beforeactivate._change",function(a){var b=a.target;Kb.test(b.nodeName)&&!ib._data(b,"changeBubbles")&&(ib.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||ib.event.simulate("change",this.parentNode,a,!0)}),ib._data(b,"changeBubbles",!0))}),void 0)},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ib.event.remove(this,"._change"),!Kb.test(this.nodeName)}}),ib.support.focusinBubbles||ib.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){ib.event.simulate(b,a.target,ib.event.fix(a),!0)};ib.event.special[b]={setup:function(){0===c++&&W.addEventListener(a,d,!0)},teardown:function(){0===--c&&W.removeEventListener(a,d,!0)}}}),ib.fn.extend({on:function(a,c,d,e,f){var g,h;if("object"==typeof a){"string"!=typeof c&&(d=d||c,c=b);for(g in a)this.on(g,c,d,a[g],f);return this}if(null==d&&null==e?(e=c,d=c=b):null==e&&("string"==typeof c?(e=d,d=b):(e=d,d=c,c=b)),e===!1)e=j;else if(!e)return this;return 1===f&&(h=e,e=function(a){return ib().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=ib.guid++)),this.each(function(){ib.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,ib(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(f in a)this.off(f,c,a[f]);return this}return(c===!1||"function"==typeof c)&&(d=c,c=b),d===!1&&(d=j),this.each(function(){ib.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){ib.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?ib.event.trigger(a,b,c,!0):void 0}}),function(a,b){function c(a){return ob.test(a+"")}function d(){var a,b=[];return a=function(c,d){return b.push(c+=" ")>y.cacheLength&&delete a[b.shift()],a[c]=d}}function e(a){return a[N]=!0,a}function f(a){var b=F.createElement("div");try{return a(b)}catch(c){return!1}finally{b=null}}function g(a,b,c,d){var e,f,g,h,i,j,k,n,o,p;if((b?b.ownerDocument||b:O)!==F&&E(b),b=b||F,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(!H&&!d){if(e=pb.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&L(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return Z.apply(c,$.call(b.getElementsByTagName(a),0)),c;if((g=e[3])&&P.getByClassName&&b.getElementsByClassName)return Z.apply(c,$.call(b.getElementsByClassName(g),0)),c}if(P.qsa&&!I.test(a)){if(k=!0,n=N,o=b,p=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=l(a),(k=b.getAttribute("id"))?n=k.replace(sb,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",i=j.length;i--;)j[i]=n+m(j[i]);o=nb.test(a)&&b.parentNode||b,p=j.join(",")}if(p)try{return Z.apply(c,$.call(o.querySelectorAll(p),0)),c}catch(q){}finally{k||b.removeAttribute("id")}}}return u(a.replace(gb,"$1"),b,c,d)}function h(a,b){var c=b&&a,d=c&&(~b.sourceIndex||W)-(~a.sourceIndex||W);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function i(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function j(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function k(a){return e(function(b){return b=+b,e(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function l(a,b){var c,d,e,f,h,i,j,k=T[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=y.preFilter;h;){(!c||(d=hb.exec(h)))&&(d&&(h=h.slice(d[0].length)||h),i.push(e=[])),c=!1,(d=jb.exec(h))&&(c=d.shift(),e.push({value:c,type:d[0].replace(gb," ")}),h=h.slice(c.length));for(f in y.filter)!(d=mb[f].exec(h))||j[f]&&!(d=j[f](d))||(c=d.shift(),e.push({value:c,type:f,matches:d}),h=h.slice(c.length));if(!c)break}return b?h.length:h?g.error(a):T(a,i).slice(0)}function m(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=R++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=Q+" "+f;if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e)if(j=b[N]||(b[N]={}),(i=j[d])&&i[0]===k){if((h=i[1])===!0||h===x)return h===!0}else if(i=j[d]=[k],i[1]=a(b,c,g)||x,i[1]===!0)return!0}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function p(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function q(a,b,c,d,f,g){return d&&!d[N]&&(d=q(d)),f&&!f[N]&&(f=q(f,g)),e(function(e,g,h,i){var j,k,l,m=[],n=[],o=g.length,q=e||t(b||"*",h.nodeType?[h]:h,[]),r=!a||!e&&b?q:p(q,m,a,h,i),s=c?f||(e?a:o||d)?[]:g:r;if(c&&c(r,s,h,i),d)for(j=p(s,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(s[n[k]]=!(r[n[k]]=l));if(e){if(f||a){if(f){for(j=[],k=s.length;k--;)(l=s[k])&&j.push(r[k]=l);f(null,s=[],j,i)}for(k=s.length;k--;)(l=s[k])&&(j=f?_.call(e,l):m[k])>-1&&(e[j]=!(g[j]=l))}}else s=p(s===g?s.splice(o,s.length):s),f?f(null,g,s,i):Z.apply(g,s)})}function r(a){for(var b,c,d,e=a.length,f=y.relative[a[0].type],g=f||y.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return _.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==D)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=y.relative[a[h].type])k=[n(o(k),c)];else{if(c=y.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!y.relative[a[d].type];d++);return q(h>1&&o(k),h>1&&m(a.slice(0,h-1)).replace(gb,"$1"),c,d>h&&r(a.slice(h,d)),e>d&&r(a=a.slice(d)),e>d&&m(a))}k.push(c)}return o(k)}function s(a,b){var c=0,d=b.length>0,f=a.length>0,h=function(e,h,i,j,k){var l,m,n,o=[],q=0,r="0",s=e&&[],t=null!=k,u=D,v=e||f&&y.find.TAG("*",k&&h.parentNode||h),w=Q+=null==u?1:Math.random()||.1;for(t&&(D=h!==F&&h,x=c);null!=(l=v[r]);r++){if(f&&l){for(m=0;n=a[m++];)if(n(l,h,i)){j.push(l);break}t&&(Q=w,x=++c)}d&&((l=!n&&l)&&q--,e&&s.push(l))}if(q+=r,d&&r!==q){for(m=0;n=b[m++];)n(s,o,h,i);if(e){if(q>0)for(;r--;)s[r]||o[r]||(o[r]=Y.call(j));o=p(o)}Z.apply(j,o),t&&!e&&o.length>0&&q+b.length>1&&g.uniqueSort(j)}return t&&(Q=w,D=u),s};return d?e(h):h}function t(a,b,c){for(var d=0,e=b.length;e>d;d++)g(a,b[d],c);return c}function u(a,b,c,d){var e,f,g,h,i,j=l(a);if(!d&&1===j.length){if(f=j[0]=j[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&9===b.nodeType&&!H&&y.relative[f[1].type]){if(b=y.find.ID(g.matches[0].replace(ub,vb),b)[0],!b)return c;a=a.slice(f.shift().value.length)}for(e=mb.needsContext.test(a)?0:f.length;e--&&(g=f[e],!y.relative[h=g.type]);)if((i=y.find[h])&&(d=i(g.matches[0].replace(ub,vb),nb.test(f[0].type)&&b.parentNode||b))){if(f.splice(e,1),a=d.length&&m(f),!a)return Z.apply(c,$.call(d,0)),c;break}}return B(a,j)(d,b,H,c,nb.test(a)),c}function v(){}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P={},Q=0,R=0,S=d(),T=d(),U=d(),V=typeof b,W=1<<31,X=[],Y=X.pop,Z=X.push,$=X.slice,_=X.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},ab="[\\x20\\t\\r\\n\\f]",bb="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",cb=bb.replace("w","w#"),db="([*^$|!~]?=)",eb="\\["+ab+"*("+bb+")"+ab+"*(?:"+db+ab+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+cb+")|)|)"+ab+"*\\]",fb=":("+bb+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+eb.replace(3,8)+")*)|.*)\\)|)",gb=new RegExp("^"+ab+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ab+"+$","g"),hb=new RegExp("^"+ab+"*,"+ab+"*"),jb=new RegExp("^"+ab+"*([\\x20\\t\\r\\n\\f>+~])"+ab+"*"),kb=new RegExp(fb),lb=new RegExp("^"+cb+"$"),mb={ID:new RegExp("^#("+bb+")"),CLASS:new RegExp("^\\.("+bb+")"),NAME:new RegExp("^\\[name=['\"]?("+bb+")['\"]?\\]"),TAG:new RegExp("^("+bb.replace("w","w*")+")"),ATTR:new RegExp("^"+eb),PSEUDO:new RegExp("^"+fb),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ab+"*(even|odd|(([+-]|)(\\d*)n|)"+ab+"*(?:([+-]|)"+ab+"*(\\d+)|))"+ab+"*\\)|)","i"),needsContext:new RegExp("^"+ab+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ab+"*((?:-\\d)?\\d*)"+ab+"*\\)|)(?=[^-]|$)","i")},nb=/[\x20\t\r\n\f]*[+~]/,ob=/^[^{]+\{\s*\[native code/,pb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,qb=/^(?:input|select|textarea|button)$/i,rb=/^h\d$/i,sb=/'|\\/g,tb=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,ub=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,vb=function(a,b){var c="0x"+b-65536;return c!==c?b:0>c?String.fromCharCode(c+65536):String.fromCharCode(55296|c>>10,56320|1023&c)};try{$.call(O.documentElement.childNodes,0)[0].nodeType}catch(wb){$=function(a){for(var b,c=[];b=this[a++];)c.push(b);return c}}A=g.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},E=g.setDocument=function(a){var d=a?a.ownerDocument||a:O;return d!==F&&9===d.nodeType&&d.documentElement?(F=d,G=d.documentElement,H=A(d),P.tagNameNoComments=f(function(a){return a.appendChild(d.createComment("")),!a.getElementsByTagName("*").length}),P.attributes=f(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return"boolean"!==b&&"string"!==b}),P.getByClassName=f(function(a){return a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",a.getElementsByClassName&&a.getElementsByClassName("e").length?(a.lastChild.className="e",2===a.getElementsByClassName("e").length):!1}),P.getByName=f(function(a){a.id=N+0,a.innerHTML="<a name='"+N+"'></a><div name='"+N+"'></div>",G.insertBefore(a,G.firstChild);var b=d.getElementsByName&&d.getElementsByName(N).length===2+d.getElementsByName(N+0).length;return P.getIdNotName=!d.getElementById(N),G.removeChild(a),b}),y.attrHandle=f(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==V&&"#"===a.firstChild.getAttribute("href")})?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},P.getIdNotName?(y.find.ID=function(a,b){if(typeof b.getElementById!==V&&!H){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},y.filter.ID=function(a){var b=a.replace(ub,vb);return function(a){return a.getAttribute("id")===b}}):(y.find.ID=function(a,c){if(typeof c.getElementById!==V&&!H){var d=c.getElementById(a);return d?d.id===a||typeof d.getAttributeNode!==V&&d.getAttributeNode("id").value===a?[d]:b:[]}},y.filter.ID=function(a){var b=a.replace(ub,vb);return function(a){var c=typeof a.getAttributeNode!==V&&a.getAttributeNode("id");return c&&c.value===b}}),y.find.TAG=P.tagNameNoComments?function(a,b){return typeof b.getElementsByTagName!==V?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},y.find.NAME=P.getByName&&function(a,b){return typeof b.getElementsByName!==V?b.getElementsByName(name):void 0},y.find.CLASS=P.getByClassName&&function(a,b){return typeof b.getElementsByClassName===V||H?void 0:b.getElementsByClassName(a)},J=[],I=[":focus"],(P.qsa=c(d.querySelectorAll))&&(f(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||I.push("\\["+ab+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||I.push(":checked")}),f(function(a){a.innerHTML="<input type='hidden' i=''/>",a.querySelectorAll("[i^='']").length&&I.push("[*^$]="+ab+"*(?:\"\"|'')"),a.querySelectorAll(":enabled").length||I.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),I.push(",.*:")})),(P.matchesSelector=c(K=G.matchesSelector||G.mozMatchesSelector||G.webkitMatchesSelector||G.oMatchesSelector||G.msMatchesSelector))&&f(function(a){P.disconnectedMatch=K.call(a,"div"),K.call(a,"[s!='']:x"),J.push("!=",fb)}),I=new RegExp(I.join("|")),J=new RegExp(J.join("|")),L=c(G.contains)||G.compareDocumentPosition?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},M=G.compareDocumentPosition?function(a,b){var c;return a===b?(C=!0,0):(c=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b))?1&c||a.parentNode&&11===a.parentNode.nodeType?a===d||L(O,a)?-1:b===d||L(O,b)?1:0:4&c?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var c,e=0,f=a.parentNode,g=b.parentNode,i=[a],j=[b];if(a===b)return C=!0,0;if(!f||!g)return a===d?-1:b===d?1:f?-1:g?1:0;if(f===g)return h(a,b);for(c=a;c=c.parentNode;)i.unshift(c);for(c=b;c=c.parentNode;)j.unshift(c);for(;i[e]===j[e];)e++;return e?h(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},C=!1,[0,0].sort(M),P.detectDuplicates=C,F):F},g.matches=function(a,b){return g(a,null,null,b)},g.matchesSelector=function(a,b){if((a.ownerDocument||a)!==F&&E(a),b=b.replace(tb,"='$1']"),!(!P.matchesSelector||H||J&&J.test(b)||I.test(b)))try{var c=K.call(a,b);if(c||P.disconnectedMatch||a.document&&11!==a.document.nodeType)return c}catch(d){}return g(b,F,null,[a]).length>0},g.contains=function(a,b){return(a.ownerDocument||a)!==F&&E(a),L(a,b)},g.attr=function(a,b){var c;return(a.ownerDocument||a)!==F&&E(a),H||(b=b.toLowerCase()),(c=y.attrHandle[b])?c(a):H||P.attributes?a.getAttribute(b):((c=a.getAttributeNode(b))||a.getAttribute(b))&&a[b]===!0?b:c&&c.specified?c.value:null},g.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},g.uniqueSort=function(a){var b,c=[],d=1,e=0;if(C=!P.detectDuplicates,a.sort(M),C){for(;b=a[d];d++)b===a[d-1]&&(e=c.push(d));for(;e--;)a.splice(c[e],1)}return a},z=g.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=z(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d];d++)c+=z(b);return c},y=g.selectors={cacheLength:50,createPseudo:e,match:mb,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ub,vb),a[3]=(a[4]||a[5]||"").replace(ub,vb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||g.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&g.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return mb.CHILD.test(a[0])?null:(a[4]?a[2]=a[4]:c&&kb.test(c)&&(b=l(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){return"*"===a?function(){return!0}:(a=a.replace(ub,vb).toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=S[a+" "];return b||(b=new RegExp("(^|"+ab+")"+a+"("+ab+"|$)"))&&S(a,function(a){return b.test(a.className||typeof a.getAttribute!==V&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=g.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===Q&&j[1],m=j[0]===Q&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[Q,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===Q)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[Q,m]),l!==b)););return m-=e,m===d||0===m%d&&m/d>=0}}},PSEUDO:function(a,b){var c,d=y.pseudos[a]||y.setFilters[a.toLowerCase()]||g.error("unsupported pseudo: "+a);return d[N]?d(b):d.length>1?(c=[a,a,"",b],y.setFilters.hasOwnProperty(a.toLowerCase())?e(function(a,c){for(var e,f=d(a,b),g=f.length;g--;)e=_.call(a,f[g]),a[e]=!(c[e]=f[g])}):function(a){return d(a,0,c)}):d}},pseudos:{not:e(function(a){var b=[],c=[],d=B(a.replace(gb,"$1"));return d[N]?e(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:e(function(a){return function(b){return g(a,b).length>0}}),contains:e(function(a){return function(b){return(b.textContent||b.innerText||z(b)).indexOf(a)>-1}}),lang:e(function(a){return lb.test(a||"")||g.error("unsupported lang: "+a),a=a.replace(ub,vb).toLowerCase(),function(b){var c;do if(c=H?b.getAttribute("xml:lang")||b.getAttribute("lang"):b.lang)return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===G},focus:function(a){return a===F.activeElement&&(!F.hasFocus||F.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeName>"@"||3===a.nodeType||4===a.nodeType)return!1;return!0},parent:function(a){return!y.pseudos.empty(a)},header:function(a){return rb.test(a.nodeName)},input:function(a){return qb.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:k(function(){return[0]}),last:k(function(a,b){return[b-1]}),eq:k(function(a,b,c){return[0>c?c+b:c]}),even:k(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:k(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:k(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:k(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}};for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})y.pseudos[w]=i(w);for(w in{submit:!0,reset:!0})y.pseudos[w]=j(w);B=g.compile=function(a,b){var c,d=[],e=[],f=U[a+" "];if(!f){for(b||(b=l(a)),c=b.length;c--;)f=r(b[c]),f[N]?d.push(f):e.push(f);f=U(a,s(e,d))}return f},y.pseudos.nth=y.pseudos.eq,y.filters=v.prototype=y.pseudos,y.setFilters=new v,E(),g.attr=ib.attr,ib.find=g,ib.expr=g.selectors,ib.expr[":"]=ib.expr.pseudos,ib.unique=g.uniqueSort,ib.text=g.getText,ib.isXMLDoc=g.isXML,ib.contains=g.contains}(a);var Pb=/Until$/,Qb=/^(?:parents|prev(?:Until|All))/,Rb=/^.[^:#\[\.,]*$/,Sb=ib.expr.match.needsContext,Tb={children:!0,contents:!0,next:!0,prev:!0};ib.fn.extend({find:function(a){var b,c,d,e=this.length;if("string"!=typeof a)return d=this,this.pushStack(ib(a).filter(function(){for(b=0;e>b;b++)if(ib.contains(d[b],this))return!0}));for(c=[],b=0;e>b;b++)ib.find(a,this[b],c);return c=this.pushStack(e>1?ib.unique(c):c),c.selector=(this.selector?this.selector+" ":"")+a,c},has:function(a){var b,c=ib(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(ib.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(l(this,a,!1))},filter:function(a){return this.pushStack(l(this,a,!0))},is:function(a){return!!a&&("string"==typeof a?Sb.test(a)?ib(a,this.context).index(this[0])>=0:ib.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=Sb.test(a)||"string"!=typeof a?ib(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c.ownerDocument&&c!==b&&11!==c.nodeType;){if(g?g.index(c)>-1:ib.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}return this.pushStack(f.length>1?ib.unique(f):f)},index:function(a){return a?"string"==typeof a?ib.inArray(this[0],ib(a)):ib.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){var c="string"==typeof a?ib(a,b):ib.makeArray(a&&a.nodeType?[a]:a),d=ib.merge(this.get(),c);return this.pushStack(ib.unique(d))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),ib.fn.andSelf=ib.fn.addBack,ib.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return ib.dir(a,"parentNode")},parentsUntil:function(a,b,c){return ib.dir(a,"parentNode",c)},next:function(a){return k(a,"nextSibling")},prev:function(a){return k(a,"previousSibling")},nextAll:function(a){return ib.dir(a,"nextSibling")},prevAll:function(a){return ib.dir(a,"previousSibling")},nextUntil:function(a,b,c){return ib.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return ib.dir(a,"previousSibling",c)},siblings:function(a){return ib.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return ib.sibling(a.firstChild)},contents:function(a){return ib.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:ib.merge([],a.childNodes)}},function(a,b){ib.fn[a]=function(c,d){var e=ib.map(this,b,c);return Pb.test(a)||(d=c),d&&"string"==typeof d&&(e=ib.filter(d,e)),e=this.length>1&&!Tb[a]?ib.unique(e):e,this.length>1&&Qb.test(a)&&(e=e.reverse()),this.pushStack(e)}}),ib.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),1===b.length?ib.find.matchesSelector(b[0],a)?[b[0]]:[]:ib.find.matches(a,b)},dir:function(a,c,d){for(var e=[],f=a[c];f&&9!==f.nodeType&&(d===b||1!==f.nodeType||!ib(f).is(d));)1===f.nodeType&&e.push(f),f=f[c];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Ub="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Vb=/ jQuery\d+="(?:null|\d+)"/g,Wb=new RegExp("<(?:"+Ub+")[\\s/>]","i"),Xb=/^\s+/,Yb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Zb=/<([\w:]+)/,$b=/<tbody/i,_b=/<|&#?\w+;/,ac=/<(?:script|style|link)/i,bc=/^(?:checkbox|radio)$/i,cc=/checked\s*(?:[^=]|=\s*.checked.)/i,dc=/^$|\/(?:java|ecma)script/i,ec=/^true\/(.*)/,fc=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,gc={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ib.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},hc=m(W),ic=hc.appendChild(W.createElement("div"));gc.optgroup=gc.option,gc.tbody=gc.tfoot=gc.colgroup=gc.caption=gc.thead,gc.th=gc.td,ib.fn.extend({text:function(a){return ib.access(this,function(a){return a===b?ib.text(this):this.empty().append((this[0]&&this[0].ownerDocument||W).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(ib.isFunction(a))return this.each(function(b){ib(this).wrapAll(a.call(this,b))});if(this[0]){var b=ib(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return ib.isFunction(a)?this.each(function(b){ib(this).wrapInner(a.call(this,b))}):this.each(function(){var b=ib(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=ib.isFunction(a);return this.each(function(c){ib(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){ib.nodeName(this,"body")||ib(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(a,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,!1,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=0;null!=(c=this[d]);d++)(!a||ib.filter(a,[c]).length>0)&&(b||1!==c.nodeType||ib.cleanData(t(c)),c.parentNode&&(b&&ib.contains(c.ownerDocument,c)&&q(t(c,"script")),c.parentNode.removeChild(c)));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&ib.cleanData(t(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&ib.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return ib.clone(this,a,b)})},html:function(a){return ib.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(Vb,""):b;if(!("string"!=typeof a||ac.test(a)||!ib.support.htmlSerialize&&Wb.test(a)||!ib.support.leadingWhitespace&&Xb.test(a)||gc[(Zb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(Yb,"<$1></$2>");
try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(ib.cleanData(t(c,!1)),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){var b=ib.isFunction(a);return b||"string"==typeof a||(a=ib(a).not(this).detach()),this.domManip([a],!0,function(a){var b=this.nextSibling,c=this.parentNode;c&&(ib(this).remove(),c.insertBefore(a,b))})},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=bb.apply([],a);var e,f,g,h,i,j,k=0,l=this.length,m=this,q=l-1,r=a[0],s=ib.isFunction(r);if(s||!(1>=l||"string"!=typeof r||ib.support.checkClone)&&cc.test(r))return this.each(function(e){var f=m.eq(e);s&&(a[0]=r.call(this,e,c?f.html():b)),f.domManip(a,c,d)});if(l&&(j=ib.buildFragment(a,this[0].ownerDocument,!1,this),e=j.firstChild,1===j.childNodes.length&&(j=e),e)){for(c=c&&ib.nodeName(e,"tr"),h=ib.map(t(j,"script"),o),g=h.length;l>k;k++)f=j,k!==q&&(f=ib.clone(f,!0,!0),g&&ib.merge(h,t(f,"script"))),d.call(c&&ib.nodeName(this[k],"table")?n(this[k],"tbody"):this[k],f,k);if(g)for(i=h[h.length-1].ownerDocument,ib.map(h,p),k=0;g>k;k++)f=h[k],dc.test(f.type||"")&&!ib._data(f,"globalEval")&&ib.contains(i,f)&&(f.src?ib.ajax({url:f.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):ib.globalEval((f.text||f.textContent||f.innerHTML||"").replace(fc,"")));j=e=null}return this}}),ib.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){ib.fn[a]=function(a){for(var c,d=0,e=[],f=ib(a),g=f.length-1;g>=d;d++)c=d===g?this:this.clone(!0),ib(f[d])[b](c),cb.apply(e,c.get());return this.pushStack(e)}}),ib.extend({clone:function(a,b,c){var d,e,f,g,h,i=ib.contains(a.ownerDocument,a);if(ib.support.html5Clone||ib.isXMLDoc(a)||!Wb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ic.innerHTML=a.outerHTML,ic.removeChild(f=ic.firstChild)),!(ib.support.noCloneEvent&&ib.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||ib.isXMLDoc(a)))for(d=t(f),h=t(a),g=0;null!=(e=h[g]);++g)d[g]&&s(e,d[g]);if(b)if(c)for(h=h||t(a),d=d||t(f),g=0;null!=(e=h[g]);g++)r(e,d[g]);else r(a,f);return d=t(f,"script"),d.length>0&&q(d,!i&&t(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,l=a.length,n=m(b),o=[],p=0;l>p;p++)if(f=a[p],f||0===f)if("object"===ib.type(f))ib.merge(o,f.nodeType?[f]:f);else if(_b.test(f)){for(h=h||n.appendChild(b.createElement("div")),i=(Zb.exec(f)||["",""])[1].toLowerCase(),k=gc[i]||gc._default,h.innerHTML=k[1]+f.replace(Yb,"<$1></$2>")+k[2],e=k[0];e--;)h=h.lastChild;if(!ib.support.leadingWhitespace&&Xb.test(f)&&o.push(b.createTextNode(Xb.exec(f)[0])),!ib.support.tbody)for(f="table"!==i||$b.test(f)?"<table>"!==k[1]||$b.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;e--;)ib.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);for(ib.merge(o,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=n.lastChild}else o.push(b.createTextNode(f));for(h&&n.removeChild(h),ib.support.appendChecked||ib.grep(t(o,"input"),u),p=0;f=o[p++];)if((!d||-1===ib.inArray(f,d))&&(g=ib.contains(f.ownerDocument,f),h=t(n.appendChild(f),"script"),g&&q(h),c))for(e=0;f=h[e++];)dc.test(f.type||"")&&c.push(f);return h=null,n},cleanData:function(a,b){for(var c,d,e,f,g=0,h=ib.expando,i=ib.cache,j=ib.support.deleteExpando,k=ib.event.special;null!=(c=a[g]);g++)if((b||ib.acceptData(c))&&(e=c[h],f=e&&i[e])){if(f.events)for(d in f.events)k[d]?ib.event.remove(c,d):ib.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==V?c.removeAttribute(h):c[h]=null,_.push(e))}}});var jc,kc,lc,mc=/alpha\([^)]*\)/i,nc=/opacity\s*=\s*([^)]*)/,oc=/^(top|right|bottom|left)$/,pc=/^(none|table(?!-c[ea]).+)/,qc=/^margin/,rc=new RegExp("^("+jb+")(.*)$","i"),sc=new RegExp("^("+jb+")(?!px)[a-z%]+$","i"),tc=new RegExp("^([+-])=("+jb+")","i"),uc={BODY:"block"},vc={position:"absolute",visibility:"hidden",display:"block"},wc={letterSpacing:0,fontWeight:400},xc=["Top","Right","Bottom","Left"],yc=["Webkit","O","Moz","ms"];ib.fn.extend({css:function(a,c){return ib.access(this,function(a,c,d){var e,f,g={},h=0;if(ib.isArray(c)){for(f=kc(a),e=c.length;e>h;h++)g[c[h]]=ib.css(a,c[h],!1,f);return g}return d!==b?ib.style(a,c,d):ib.css(a,c)},a,c,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(a){var b="boolean"==typeof a;return this.each(function(){(b?a:w(this))?ib(this).show():ib(this).hide()})}}),ib.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=lc(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ib.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h,i=ib.camelCase(c),j=a.style;if(c=ib.cssProps[i]||(ib.cssProps[i]=v(j,i)),h=ib.cssHooks[c]||ib.cssHooks[i],d===b)return h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c];if(g=typeof d,"string"===g&&(f=tc.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(ib.css(a,c)),g="number"),!(null==d||"number"===g&&isNaN(d)||("number"!==g||ib.cssNumber[i]||(d+="px"),ib.support.clearCloneStyle||""!==d||0!==c.indexOf("background")||(j[c]="inherit"),h&&"set"in h&&(d=h.set(a,d,e))===b)))try{j[c]=d}catch(k){}}},css:function(a,c,d,e){var f,g,h,i=ib.camelCase(c);return c=ib.cssProps[i]||(ib.cssProps[i]=v(a.style,i)),h=ib.cssHooks[c]||ib.cssHooks[i],h&&"get"in h&&(g=h.get(a,!0,d)),g===b&&(g=lc(a,c,e)),"normal"===g&&c in wc&&(g=wc[c]),""===d||d?(f=parseFloat(g),d===!0||ib.isNumeric(f)?f||0:g):g},swap:function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e}}),a.getComputedStyle?(kc=function(b){return a.getComputedStyle(b,null)},lc=function(a,c,d){var e,f,g,h=d||kc(a),i=h?h.getPropertyValue(c)||h[c]:b,j=a.style;return h&&(""!==i||ib.contains(a.ownerDocument,a)||(i=ib.style(a,c)),sc.test(i)&&qc.test(c)&&(e=j.width,f=j.minWidth,g=j.maxWidth,j.minWidth=j.maxWidth=j.width=i,i=h.width,j.width=e,j.minWidth=f,j.maxWidth=g)),i}):W.documentElement.currentStyle&&(kc=function(a){return a.currentStyle},lc=function(a,c,d){var e,f,g,h=d||kc(a),i=h?h[c]:b,j=a.style;return null==i&&j&&j[c]&&(i=j[c]),sc.test(i)&&!oc.test(c)&&(e=j.left,f=a.runtimeStyle,g=f&&f.left,g&&(f.left=a.currentStyle.left),j.left="fontSize"===c?"1em":i,i=j.pixelLeft+"px",j.left=e,g&&(f.left=g)),""===i?"auto":i}),ib.each(["height","width"],function(a,b){ib.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&pc.test(ib.css(a,"display"))?ib.swap(a,vc,function(){return A(a,b,d)}):A(a,b,d):void 0},set:function(a,c,d){var e=d&&kc(a);return y(a,c,d?z(a,b,d,ib.support.boxSizing&&"border-box"===ib.css(a,"boxSizing",!1,e),e):0)}}}),ib.support.opacity||(ib.cssHooks.opacity={get:function(a,b){return nc.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=ib.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===ib.trim(f.replace(mc,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=mc.test(f)?f.replace(mc,e):f+" "+e)}}),ib(function(){ib.support.reliableMarginRight||(ib.cssHooks.marginRight={get:function(a,b){return b?ib.swap(a,{display:"inline-block"},lc,[a,"marginRight"]):void 0}}),!ib.support.pixelPosition&&ib.fn.position&&ib.each(["top","left"],function(a,b){ib.cssHooks[b]={get:function(a,c){return c?(c=lc(a,b),sc.test(c)?ib(a).position()[b]+"px":c):void 0}}})}),ib.expr&&ib.expr.filters&&(ib.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!ib.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||ib.css(a,"display"))},ib.expr.filters.visible=function(a){return!ib.expr.filters.hidden(a)}),ib.each({margin:"",padding:"",border:"Width"},function(a,b){ib.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+xc[d]+b]=f[d]||f[d-2]||f[0];return e}},qc.test(a)||(ib.cssHooks[a+b].set=y)});var zc=/%20/g,Ac=/\[\]$/,Bc=/\r?\n/g,Cc=/^(?:submit|button|image|reset|file)$/i,Dc=/^(?:input|select|textarea|keygen)/i;ib.fn.extend({serialize:function(){return ib.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=ib.prop(this,"elements");return a?ib.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!ib(this).is(":disabled")&&Dc.test(this.nodeName)&&!Cc.test(a)&&(this.checked||!bc.test(a))}).map(function(a,b){var c=ib(this).val();return null==c?null:ib.isArray(c)?ib.map(c,function(a){return{name:b.name,value:a.replace(Bc,"\r\n")}}):{name:b.name,value:c.replace(Bc,"\r\n")}}).get()}}),ib.param=function(a,c){var d,e=[],f=function(a,b){b=ib.isFunction(b)?b():null==b?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b&&(c=ib.ajaxSettings&&ib.ajaxSettings.traditional),ib.isArray(a)||a.jquery&&!ib.isPlainObject(a))ib.each(a,function(){f(this.name,this.value)});else for(d in a)D(d,a[d],c,f);return e.join("&").replace(zc,"+")},ib.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){ib.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),ib.fn.hover=function(a,b){return this.mouseenter(a).mouseleave(b||a)};var Ec,Fc,Gc=ib.now(),Hc=/\?/,Ic=/#.*$/,Jc=/([?&])_=[^&]*/,Kc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Lc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mc=/^(?:GET|HEAD)$/,Nc=/^\/\//,Oc=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Pc=ib.fn.load,Qc={},Rc={},Sc="*/".concat("*");try{Fc=X.href}catch(Tc){Fc=W.createElement("a"),Fc.href="",Fc=Fc.href}Ec=Oc.exec(Fc.toLowerCase())||[],ib.fn.load=function(a,c,d){if("string"!=typeof a&&Pc)return Pc.apply(this,arguments);var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),ib.isFunction(c)?(d=c,c=b):c&&"object"==typeof c&&(g="POST"),h.length>0&&ib.ajax({url:a,type:g,dataType:"html",data:c}).done(function(a){f=arguments,h.html(e?ib("<div>").append(ib.parseHTML(a)).find(e):a)}).complete(d&&function(a,b){h.each(d,f||[a.responseText,b,a])}),this},ib.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){ib.fn[b]=function(a){return this.on(b,a)}}),ib.each(["get","post"],function(a,c){ib[c]=function(a,d,e,f){return ib.isFunction(d)&&(f=f||e,e=d,d=b),ib.ajax({url:a,type:c,dataType:f,data:d,success:e})}}),ib.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Fc,type:"GET",isLocal:Lc.test(Ec[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Sc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":ib.parseJSON,"text xml":ib.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?G(G(a,ib.ajaxSettings),b):G(ib.ajaxSettings,a)},ajaxPrefilter:E(Qc),ajaxTransport:E(Rc),ajax:function(a,c){function d(a,c,d,e){var f,l,s,t,v,x=c;2!==u&&(u=2,i&&clearTimeout(i),k=b,h=e||"",w.readyState=a>0?4:0,d&&(t=H(m,w,d)),a>=200&&300>a||304===a?(m.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(ib.lastModified[g]=v),v=w.getResponseHeader("etag"),v&&(ib.etag[g]=v)),204===a?(f=!0,x="nocontent"):304===a?(f=!0,x="notmodified"):(f=I(m,t),x=f.state,l=f.data,s=f.error,f=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),w.status=a,w.statusText=(c||x)+"",f?p.resolveWith(n,[l,x,w]):p.rejectWith(n,[w,x,s]),w.statusCode(r),r=b,j&&o.trigger(f?"ajaxSuccess":"ajaxError",[w,m,f?l:s]),q.fireWith(n,[w,x]),j&&(o.trigger("ajaxComplete",[w,m]),--ib.active||ib.event.trigger("ajaxStop")))}"object"==typeof a&&(c=a,a=b),c=c||{};var e,f,g,h,i,j,k,l,m=ib.ajaxSetup({},c),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?ib(n):ib.event,p=ib.Deferred(),q=ib.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!l)for(l={};b=Kc.exec(h);)l[b[1].toLowerCase()]=b[2];b=l[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?h:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>u)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){var b=a||v;return k&&k.abort(b),d(0,b),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((a||m.url||Fc)+"").replace(Ic,"").replace(Nc,Ec[1]+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=ib.trim(m.dataType||"*").toLowerCase().match(kb)||[""],null==m.crossDomain&&(e=Oc.exec(m.url.toLowerCase()),m.crossDomain=!(!e||e[1]===Ec[1]&&e[2]===Ec[2]&&(e[3]||("http:"===e[1]?80:443))==(Ec[3]||("http:"===Ec[1]?80:443)))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=ib.param(m.data,m.traditional)),F(Qc,m,c,w),2===u)return w;j=m.global,j&&0===ib.active++&&ib.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Mc.test(m.type),g=m.url,m.hasContent||(m.data&&(g=m.url+=(Hc.test(g)?"&":"?")+m.data,delete m.data),m.cache===!1&&(m.url=Jc.test(g)?g.replace(Jc,"$1_="+Gc++):g+(Hc.test(g)?"&":"?")+"_="+Gc++)),m.ifModified&&(ib.lastModified[g]&&w.setRequestHeader("If-Modified-Since",ib.lastModified[g]),ib.etag[g]&&w.setRequestHeader("If-None-Match",ib.etag[g])),(m.data&&m.hasContent&&m.contentType!==!1||c.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Sc+"; q=0.01":""):m.accepts["*"]);for(f in m.headers)w.setRequestHeader(f,m.headers[f]);if(m.beforeSend&&(m.beforeSend.call(n,w,m)===!1||2===u))return w.abort();v="abort";for(f in{success:1,error:1,complete:1})w[f](m[f]);if(k=F(Rc,m,c,w)){w.readyState=1,j&&o.trigger("ajaxSend",[w,m]),m.async&&m.timeout>0&&(i=setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,k.send(s,d)}catch(x){if(!(2>u))throw x;d(-1,x)}}else d(-1,"No Transport");return w},getScript:function(a,c){return ib.get(a,b,c,"script")},getJSON:function(a,b,c){return ib.get(a,b,c,"json")}}),ib.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return ib.globalEval(a),a}}}),ib.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),ib.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=W.head||ib("head")[0]||W.documentElement;return{send:function(b,e){c=W.createElement("script"),c.async=!0,a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,b){(b||!c.readyState||/loaded|complete/.test(c.readyState))&&(c.onload=c.onreadystatechange=null,c.parentNode&&c.parentNode.removeChild(c),c=null,b||e(200,"success"))},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(b,!0)}}}});var Uc=[],Vc=/(=)\?(?=&|$)|\?\?/;ib.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Uc.pop()||ib.expando+"_"+Gc++;return this[a]=!0,a}}),ib.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.jsonp!==!1&&(Vc.test(c.url)?"url":"string"==typeof c.data&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vc.test(c.data)&&"data");return i||"jsonp"===c.dataTypes[0]?(f=c.jsonpCallback=ib.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,i?c[i]=c[i].replace(Vc,"$1"+f):c.jsonp!==!1&&(c.url+=(Hc.test(c.url)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||ib.error(f+" was not called"),h[0]},c.dataTypes[0]="json",g=a[f],a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,Uc.push(f)),h&&ib.isFunction(g)&&g(h[0]),h=g=b}),"script"):void 0});var Wc,Xc,Yc=0,Zc=a.ActiveXObject&&function(){var a;for(a in Wc)Wc[a](b,!0)};ib.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&J()||K()}:J,Xc=ib.ajaxSettings.xhr(),ib.support.cors=!!Xc&&"withCredentials"in Xc,Xc=ib.support.ajax=!!Xc,Xc&&ib.ajaxTransport(function(c){if(!c.crossDomain||ib.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();if(c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async),c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l;try{if(d&&(e||4===i.readyState))if(d=b,g&&(i.onreadystatechange=ib.noop,Zc&&delete Wc[g]),e)4!==i.readyState&&i.abort();else{l={},h=i.status,j=i.getAllResponseHeaders(),"string"==typeof i.responseText&&(l.text=i.responseText);try{k=i.statusText}catch(m){k=""}h||!c.isLocal||c.crossDomain?1223===h&&(h=204):h=l.text?200:404}}catch(n){e||f(-1,n)}l&&f(h,k,l,j)},c.async?4===i.readyState?setTimeout(d):(g=++Yc,Zc&&(Wc||(Wc={},ib(a).unload(Zc)),Wc[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(b,!0)}}}});var $c,_c,ad=/^(?:toggle|show|hide)$/,bd=new RegExp("^(?:([+-])=|)("+jb+")([a-z%]*)$","i"),cd=/queueHooks$/,dd=[P],ed={"*":[function(a,b){var c,d,e=this.createTween(a,b),f=bd.exec(b),g=e.cur(),h=+g||0,i=1,j=20;if(f){if(c=+f[2],d=f[3]||(ib.cssNumber[a]?"":"px"),"px"!==d&&h){h=ib.css(e.elem,a,!0)||c||1;do i=i||".5",h/=i,ib.style(e.elem,a,h+d);while(i!==(i=e.cur()/g)&&1!==i&&--j)}e.unit=d,e.start=h,e.end=f[1]?h+(f[1]+1)*c:c}return e}]};ib.Animation=ib.extend(N,{tweener:function(a,b){ib.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],ed[c]=ed[c]||[],ed[c].unshift(b)},prefilter:function(a,b){b?dd.unshift(a):dd.push(a)}}),ib.Tween=Q,Q.prototype={constructor:Q,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(ib.cssNumber[c]?"":"px")},cur:function(){var a=Q.propHooks[this.prop];return a&&a.get?a.get(this):Q.propHooks._default.get(this)},run:function(a){var b,c=Q.propHooks[this.prop];return this.pos=b=this.options.duration?ib.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Q.propHooks._default.set(this),this}},Q.prototype.init.prototype=Q.prototype,Q.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=ib.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){ib.fx.step[a.prop]?ib.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[ib.cssProps[a.prop]]||ib.cssHooks[a.prop])?ib.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Q.propHooks.scrollTop=Q.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},ib.each(["toggle","show","hide"],function(a,b){var c=ib.fn[b];ib.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(R(b,!0),a,d,e)}}),ib.fn.extend({fadeTo:function(a,b,c,d){return this.filter(w).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=ib.isEmptyObject(a),f=ib.speed(b,c,d),g=function(){var b=N(this,ib.extend({},a),f);g.finish=function(){b.stop(!0)},(e||ib._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return"string"!=typeof a&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=ib.timers,g=ib._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&cd.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&ib.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=ib._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=ib.timers,g=d?d.length:0;for(c.finish=!0,ib.queue(this,a,[]),e&&e.cur&&e.cur.finish&&e.cur.finish.call(this),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),ib.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){ib.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),ib.speed=function(a,b,c){var d=a&&"object"==typeof a?ib.extend({},a):{complete:c||!c&&b||ib.isFunction(a)&&a,duration:a,easing:c&&b||b&&!ib.isFunction(b)&&b};return d.duration=ib.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in ib.fx.speeds?ib.fx.speeds[d.duration]:ib.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){ib.isFunction(d.old)&&d.old.call(this),d.queue&&ib.dequeue(this,d.queue)},d},ib.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},ib.timers=[],ib.fx=Q.prototype.init,ib.fx.tick=function(){var a,c=ib.timers,d=0;for($c=ib.now();d<c.length;d++)a=c[d],a()||c[d]!==a||c.splice(d--,1);c.length||ib.fx.stop(),$c=b},ib.fx.timer=function(a){a()&&ib.timers.push(a)&&ib.fx.start()},ib.fx.interval=13,ib.fx.start=function(){_c||(_c=setInterval(ib.fx.tick,ib.fx.interval))},ib.fx.stop=function(){clearInterval(_c),_c=null},ib.fx.speeds={slow:600,fast:200,_default:400},ib.fx.step={},ib.expr&&ib.expr.filters&&(ib.expr.filters.animated=function(a){return ib.grep(ib.timers,function(b){return a===b.elem}).length}),ib.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){ib.offset.setOffset(this,a,b)});var c,d,e={top:0,left:0},f=this[0],g=f&&f.ownerDocument;if(g)return c=g.documentElement,ib.contains(c,f)?(typeof f.getBoundingClientRect!==V&&(e=f.getBoundingClientRect()),d=S(g),{top:e.top+(d.pageYOffset||c.scrollTop)-(c.clientTop||0),left:e.left+(d.pageXOffset||c.scrollLeft)-(c.clientLeft||0)}):e},ib.offset={setOffset:function(a,b,c){var d=ib.css(a,"position");"static"===d&&(a.style.position="relative");var e,f,g=ib(a),h=g.offset(),i=ib.css(a,"top"),j=ib.css(a,"left"),k=("absolute"===d||"fixed"===d)&&ib.inArray("auto",[i,j])>-1,l={},m={};k?(m=g.position(),e=m.top,f=m.left):(e=parseFloat(i)||0,f=parseFloat(j)||0),ib.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(l.top=b.top-h.top+e),null!=b.left&&(l.left=b.left-h.left+f),"using"in b?b.using.call(a,l):g.css(l)}},ib.fn.extend({position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===ib.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),ib.nodeName(a[0],"html")||(c=a.offset()),c.top+=ib.css(a[0],"borderTopWidth",!0),c.left+=ib.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-ib.css(d,"marginTop",!0),left:b.left-c.left-ib.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||W.documentElement;a&&!ib.nodeName(a,"html")&&"static"===ib.css(a,"position");)a=a.offsetParent;return a||W.documentElement})}}),ib.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);ib.fn[a]=function(e){return ib.access(this,function(a,e,f){var g=S(a);return f===b?g?c in g?g[c]:g.document.documentElement[e]:a[e]:(g?g.scrollTo(d?ib(g).scrollLeft():f,d?f:ib(g).scrollTop()):a[e]=f,void 0)},a,e,arguments.length,null)}}),ib.each({Height:"height",Width:"width"},function(a,c){ib.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){ib.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!=typeof e),h=d||(e===!0||f===!0?"margin":"border");return ib.access(this,function(c,d,e){var f;return ib.isWindow(c)?c.document.documentElement["client"+a]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?ib.css(c,d,h):ib.style(c,d,e,h)},c,g?e:b,g,null)}})}),a.jQuery=a.$=ib,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return ib})}(window),function(a){"use strict";function b(b){var c=b.data;b.isDefaultPrevented()||(b.preventDefault(),a(this).ajaxSubmit(c))}function c(b){var c=b.target,d=a(c);if(!d.is("[type=submit],[type=image]")){var e=d.closest("[type=submit]");if(0===e.length)return;c=e[0]}var f=this;if(f.clk=c,"image"==c.type)if(void 0!==b.offsetX)f.clk_x=b.offsetX,f.clk_y=b.offsetY;else if("function"==typeof a.fn.offset){var g=d.offset();f.clk_x=b.pageX-g.left,f.clk_y=b.pageY-g.top}else f.clk_x=b.pageX-c.offsetLeft,f.clk_y=b.pageY-c.offsetTop;setTimeout(function(){f.clk=f.clk_x=f.clk_y=null},100)}function d(){if(a.fn.ajaxSubmit.debug){var b="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(b):window.opera&&window.opera.postError&&window.opera.postError(b)}}var e={};e.fileapi=void 0!==a("<input type='file'/>").get(0).files,e.formdata=void 0!==window.FormData;var f=!!a.fn.prop;a.fn.attr2=function(){if(!f)return this.attr.apply(this,arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"==typeof a?a:this.attr.apply(this,arguments)},a.fn.ajaxSubmit=function(b){function c(c){var d,e,f=a.param(c,b.traditional).split("&"),g=f.length,h=[];for(d=0;g>d;d++)f[d]=f[d].replace(/\+/g," "),e=f[d].split("="),h.push([decodeURIComponent(e[0]),decodeURIComponent(e[1])]);return h}function g(d){for(var e=new FormData,f=0;f<d.length;f++)e.append(d[f].name,d[f].value);if(b.extraData){var g=c(b.extraData);for(f=0;f<g.length;f++)g[f]&&e.append(g[f][0],g[f][1])}b.data=null;var h=a.extend(!0,{},a.ajaxSettings,b,{contentType:!1,processData:!1,cache:!1,type:i||"POST"});b.uploadProgress&&(h.xhr=function(){var c=a.ajaxSettings.xhr();return c.upload&&c.upload.addEventListener("progress",function(a){var c=0,d=a.loaded||a.position,e=a.total;a.lengthComputable&&(c=Math.ceil(100*(d/e))),b.uploadProgress(a,d,e,c)},!1),c}),h.data=null;var j=h.beforeSend;return h.beforeSend=function(a,b){b.data=e,j&&j.call(this,a,b)},a.ajax(h)}function h(c){function e(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(c){d("cannot get iframe.contentWindow document: "+c)}if(b)return b;try{b=a.contentDocument?a.contentDocument:a.document}catch(c){d("cannot get iframe.contentDocument: "+c),b=a.document}return b}function g(){function b(){try{var a=e(r).readyState;d("state = "+a),a&&"uninitialized"==a.toLowerCase()&&setTimeout(b,50)}catch(c){d("Server abort: ",c," (",c.name,")"),h(A),w&&clearTimeout(w),w=void 0}}var c=l.attr2("target"),f=l.attr2("action");x.setAttribute("target",o),i||x.setAttribute("method","POST"),f!=m.url&&x.setAttribute("action",m.url),m.skipEncodingOverride||i&&!/post/i.test(i)||l.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),m.timeout&&(w=setTimeout(function(){v=!0,h(z)},m.timeout));var g=[];try{if(m.extraData)for(var j in m.extraData)m.extraData.hasOwnProperty(j)&&(a.isPlainObject(m.extraData[j])&&m.extraData[j].hasOwnProperty("name")&&m.extraData[j].hasOwnProperty("value")?g.push(a('<input type="hidden" name="'+m.extraData[j].name+'">').val(m.extraData[j].value).appendTo(x)[0]):g.push(a('<input type="hidden" name="'+j+'">').val(m.extraData[j]).appendTo(x)[0]));m.iframeTarget||(q.appendTo("body"),r.attachEvent?r.attachEvent("onload",h):r.addEventListener("load",h,!1)),setTimeout(b,15);try{x.submit()}catch(k){var n=document.createElement("form").submit;n.apply(x)}}finally{x.setAttribute("action",f),c?x.setAttribute("target",c):l.removeAttr("target"),a(g).remove()}}function h(b){if(!s.aborted&&!F){if(E=e(r),E||(d("cannot access response document"),b=A),b===z&&s)return s.abort("timeout"),y.reject(s,"timeout"),void 0;if(b==A&&s)return s.abort("server abort"),y.reject(s,"error","server abort"),void 0;if(E&&E.location.href!=m.iframeSrc||v){r.detachEvent?r.detachEvent("onload",h):r.removeEventListener("load",h,!1);var c,f="success";try{if(v)throw"timeout";var g="xml"==m.dataType||E.XMLDocument||a.isXMLDoc(E);if(d("isXml="+g),!g&&window.opera&&(null===E.body||!E.body.innerHTML)&&--G)return d("requeing onLoad callback, DOM not available"),setTimeout(h,250),void 0;var i=E.body?E.body:E.documentElement;s.responseText=i?i.innerHTML:null,s.responseXML=E.XMLDocument?E.XMLDocument:E,g&&(m.dataType="xml"),s.getResponseHeader=function(a){var b={"content-type":m.dataType};return b[a]},i&&(s.status=Number(i.getAttribute("status"))||s.status,s.statusText=i.getAttribute("statusText")||s.statusText);var j=(m.dataType||"").toLowerCase(),k=/(json|script|text)/.test(j);if(k||m.textarea){var l=E.getElementsByTagName("textarea")[0];if(l)s.responseText=l.value,s.status=Number(l.getAttribute("status"))||s.status,s.statusText=l.getAttribute("statusText")||s.statusText;else if(k){var o=E.getElementsByTagName("pre")[0],p=E.getElementsByTagName("body")[0];o?s.responseText=o.textContent?o.textContent:o.innerText:p&&(s.responseText=p.textContent?p.textContent:p.innerText)}}else"xml"==j&&!s.responseXML&&s.responseText&&(s.responseXML=H(s.responseText));try{D=J(s,j,m)}catch(t){f="parsererror",s.error=c=t||f}}catch(t){d("error caught: ",t),f="error",s.error=c=t||f}s.aborted&&(d("upload aborted"),f=null),s.status&&(f=s.status>=200&&s.status<300||304===s.status?"success":"error"),"success"===f?(m.success&&m.success.call(m.context,D,"success",s),y.resolve(s.responseText,"success",s),n&&a.event.trigger("ajaxSuccess",[s,m])):f&&(void 0===c&&(c=s.statusText),m.error&&m.error.call(m.context,s,f,c),y.reject(s,"error",c),n&&a.event.trigger("ajaxError",[s,m,c])),n&&a.event.trigger("ajaxComplete",[s,m]),n&&!--a.active&&a.event.trigger("ajaxStop"),m.complete&&m.complete.call(m.context,s,f),F=!0,m.timeout&&clearTimeout(w),setTimeout(function(){m.iframeTarget||q.remove(),s.responseXML=null},100)}}}var j,k,m,n,o,q,r,s,t,u,v,w,x=l[0],y=a.Deferred();if(c)for(k=0;k<p.length;k++)j=a(p[k]),f?j.prop("disabled",!1):j.removeAttr("disabled");if(m=a.extend(!0,{},a.ajaxSettings,b),m.context=m.context||m,o="jqFormIO"+(new Date).getTime(),m.iframeTarget?(q=a(m.iframeTarget),u=q.attr2("name"),u?o=u:q.attr2("name",o)):(q=a('<iframe name="'+o+'" src="'+m.iframeSrc+'" />'),q.css({position:"absolute",top:"-1000px",left:"-1000px"})),r=q[0],s={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(b){var c="timeout"===b?"timeout":"aborted";d("aborting upload... "+c),this.aborted=1;try{r.contentWindow.document.execCommand&&r.contentWindow.document.execCommand("Stop")}catch(e){}q.attr("src",m.iframeSrc),s.error=c,m.error&&m.error.call(m.context,s,c,b),n&&a.event.trigger("ajaxError",[s,m,c]),m.complete&&m.complete.call(m.context,s,c)}},n=m.global,n&&0===a.active++&&a.event.trigger("ajaxStart"),n&&a.event.trigger("ajaxSend",[s,m]),m.beforeSend&&m.beforeSend.call(m.context,s,m)===!1)return m.global&&a.active--,y.reject(),y;if(s.aborted)return y.reject(),y;t=x.clk,t&&(u=t.name,u&&!t.disabled&&(m.extraData=m.extraData||{},m.extraData[u]=t.value,"image"==t.type&&(m.extraData[u+".x"]=x.clk_x,m.extraData[u+".y"]=x.clk_y)));var z=1,A=2,B=a("meta[name=csrf-token]").attr("content"),C=a("meta[name=csrf-param]").attr("content");C&&B&&(m.extraData=m.extraData||{},m.extraData[C]=B),m.forceSync?g():setTimeout(g,10);var D,E,F,G=50,H=a.parseXML||function(a,b){return window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null
},I=a.parseJSON||function(a){return window.eval("("+a+")")},J=function(b,c,d){var e=b.getResponseHeader("content-type")||"",f="xml"===c||!c&&e.indexOf("xml")>=0,g=f?b.responseXML:b.responseText;return f&&"parsererror"===g.documentElement.nodeName&&a.error&&a.error("parsererror"),d&&d.dataFilter&&(g=d.dataFilter(g,c)),"string"==typeof g&&("json"===c||!c&&e.indexOf("json")>=0?g=I(g):("script"===c||!c&&e.indexOf("javascript")>=0)&&a.globalEval(g)),g};return y}if(!this.length)return d("ajaxSubmit: skipping submit process - no element selected"),this;var i,j,k,l=this;"function"==typeof b?b={success:b}:void 0===b&&(b={}),i=b.type||this.attr2("method"),j=b.url||this.attr2("action"),k="string"==typeof j?a.trim(j):"",k=k||window.location.href||"",k&&(k=(k.match(/^([^#]+)/)||[])[1]),b=a.extend(!0,{url:k,success:a.ajaxSettings.success,type:i||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},b);var m={};if(this.trigger("form-pre-serialize",[this,b,m]),m.veto)return d("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(b.beforeSerialize&&b.beforeSerialize(this,b)===!1)return d("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var n=b.traditional;void 0===n&&(n=a.ajaxSettings.traditional);var o,p=[],q=this.formToArray(b.semantic,p);if(b.data&&(b.extraData=b.data,o=a.param(b.data,n)),b.beforeSubmit&&b.beforeSubmit(q,this,b)===!1)return d("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[q,this,b,m]),m.veto)return d("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var r=a.param(q,n);o&&(r=r?r+"&"+o:o),"GET"==b.type.toUpperCase()?(b.url+=(b.url.indexOf("?")>=0?"&":"?")+r,b.data=null):b.data=r;var s=[];if(b.resetForm&&s.push(function(){l.resetForm()}),b.clearForm&&s.push(function(){l.clearForm(b.includeHidden)}),!b.dataType&&b.target){var t=b.success||function(){};s.push(function(c){var d=b.replaceTarget?"replaceWith":"html";a(b.target)[d](c).each(t,arguments)})}else b.success&&s.push(b.success);if(b.success=function(a,c,d){for(var e=b.context||this,f=0,g=s.length;g>f;f++)s[f].apply(e,[a,c,d||l,l])},b.error){var u=b.error;b.error=function(a,c,d){var e=b.context||this;u.apply(e,[a,c,d,l])}}if(b.complete){var v=b.complete;b.complete=function(a,c){var d=b.context||this;v.apply(d,[a,c,l])}}var w=a('input[type=file]:enabled[value!=""]',this),x=w.length>0,y="multipart/form-data",z=l.attr("enctype")==y||l.attr("encoding")==y,A=e.fileapi&&e.formdata;d("fileAPI :"+A);var B,C=(x||z)&&!A;b.iframe!==!1&&(b.iframe||C)?b.closeKeepAlive?a.get(b.closeKeepAlive,function(){B=h(q)}):B=h(q):B=(x||z)&&A?g(q):a.ajax(b),l.removeData("jqxhr").data("jqxhr",B);for(var D=0;D<p.length;D++)p[D]=null;return this.trigger("form-submit-notify",[this,b]),this},a.fn.ajaxForm=function(e){if(e=e||{},e.delegation=e.delegation&&a.isFunction(a.fn.on),!e.delegation&&0===this.length){var f={s:this.selector,c:this.context};return!a.isReady&&f.s?(d("DOM not ready, queuing ajaxForm"),a(function(){a(f.s,f.c).ajaxForm(e)}),this):(d("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)")),this)}return e.delegation?(a(document).off("submit.form-plugin",this.selector,b).off("click.form-plugin",this.selector,c).on("submit.form-plugin",this.selector,e,b).on("click.form-plugin",this.selector,e,c),this):this.ajaxFormUnbind().bind("submit.form-plugin",e,b).bind("click.form-plugin",e,c)},a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},a.fn.formToArray=function(b,c){var d=[];if(0===this.length)return d;var f=this[0],g=b?f.getElementsByTagName("*"):f.elements;if(!g)return d;var h,i,j,k,l,m,n;for(h=0,m=g.length;m>h;h++)if(l=g[h],j=l.name,j&&!l.disabled)if(b&&f.clk&&"image"==l.type)f.clk==l&&(d.push({name:j,value:a(l).val(),type:l.type}),d.push({name:j+".x",value:f.clk_x},{name:j+".y",value:f.clk_y}));else if(k=a.fieldValue(l,!0),k&&k.constructor==Array)for(c&&c.push(l),i=0,n=k.length;n>i;i++)d.push({name:j,value:k[i]});else if(e.fileapi&&"file"==l.type){c&&c.push(l);var o=l.files;if(o.length)for(i=0;i<o.length;i++)d.push({name:j,value:o[i],type:l.type});else d.push({name:j,value:"",type:l.type})}else null!==k&&"undefined"!=typeof k&&(c&&c.push(l),d.push({name:j,value:k,type:l.type,required:l.required}));if(!b&&f.clk){var p=a(f.clk),q=p[0];j=q.name,j&&!q.disabled&&"image"==q.type&&(d.push({name:j,value:p.val()}),d.push({name:j+".x",value:f.clk_x},{name:j+".y",value:f.clk_y}))}return d},a.fn.formSerialize=function(b){return a.param(this.formToArray(b))},a.fn.fieldSerialize=function(b){var c=[];return this.each(function(){var d=this.name;if(d){var e=a.fieldValue(this,b);if(e&&e.constructor==Array)for(var f=0,g=e.length;g>f;f++)c.push({name:d,value:e[f]});else null!==e&&"undefined"!=typeof e&&c.push({name:this.name,value:e})}}),a.param(c)},a.fn.fieldValue=function(b){for(var c=[],d=0,e=this.length;e>d;d++){var f=this[d],g=a.fieldValue(f,b);null===g||"undefined"==typeof g||g.constructor==Array&&!g.length||(g.constructor==Array?a.merge(c,g):c.push(g))}return c},a.fieldValue=function(b,c){var d=b.name,e=b.type,f=b.tagName.toLowerCase();if(void 0===c&&(c=!0),c&&(!d||b.disabled||"reset"==e||"button"==e||("checkbox"==e||"radio"==e)&&!b.checked||("submit"==e||"image"==e)&&b.form&&b.form.clk!=b||"select"==f&&-1==b.selectedIndex))return null;if("select"==f){var g=b.selectedIndex;if(0>g)return null;for(var h=[],i=b.options,j="select-one"==e,k=j?g+1:i.length,l=j?g:0;k>l;l++){var m=i[l];if(m.selected){var n=m.value;if(n||(n=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value),j)return n;h.push(n)}}return h}return a(b).val()},a.fn.clearForm=function(b){return this.each(function(){a("input,select,textarea",this).clearFields(b)})},a.fn.clearFields=a.fn.clearInputs=function(b){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();c.test(d)||"textarea"==e?this.value="":"checkbox"==d||"radio"==d?this.checked=!1:"select"==e?this.selectedIndex=-1:"file"==d?/MSIE/.test(navigator.userAgent)?a(this).replaceWith(a(this).clone(!0)):a(this).val(""):b&&(b===!0&&/hidden/.test(d)||"string"==typeof b&&a(this).is(b))&&(this.value="")})},a.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},a.fn.enable=function(a){return void 0===a&&(a=!0),this.each(function(){this.disabled=!a})},a.fn.selected=function(b){return void 0===b&&(b=!0),this.each(function(){var c=this.type;if("checkbox"==c||"radio"==c)this.checked=b;else if("option"==this.tagName.toLowerCase()){var d=a(this).parent("select");b&&d[0]&&"select-one"==d[0].type&&d.find("option").selected(!1),this.selected=b}})},a.fn.ajaxSubmit.debug=!1}(jQuery),function(a){function b(b,d,e){var f=this;return this.on("click.pjax",b,function(b){var g=a.extend({},m(d,e));g.container||(g.container=a(this).attr("data-pjax")||f),c(b,g)})}function c(b,c,d){d=m(c,d);var f=b.currentTarget;if("A"!==f.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(b.which>1||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey||location.protocol!==f.protocol||location.hostname!==f.hostname||f.hash&&f.href.replace(f.hash,"")===location.href.replace(location.hash,"")||f.href===location.href+"#")){var g={url:f.href,container:a(f).attr("data-pjax"),target:f},h=a.extend({},g,d),i=a.Event("pjax:click");a(f).trigger(i,[h]),i.isDefaultPrevented()||(e(h),b.preventDefault())}}function d(b,c,d){d=m(c,d);var f=b.currentTarget;if("FORM"!==f.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var g={type:f.method.toUpperCase(),url:f.action,data:a(f).serializeArray(),container:a(f).attr("data-pjax"),target:f};e(a.extend({},g,d)),b.preventDefault()}function e(b){function c(b,c){var e=a.Event(b,{relatedTarget:d});return h.trigger(e,c),!e.isDefaultPrevented()}b=a.extend(!0,{},a.ajaxSettings,e.defaults,b),a.isFunction(b.url)&&(b.url=b.url());var d=b.target,f=l(b.url).hash,h=b.context=n(b.container);b.data||(b.data={}),b.data._pjax=h.selector;var i;b.beforeSend=function(a,d){return"GET"!==d.type&&(d.timeout=0),a.setRequestHeader("X-PJAX","true"),a.setRequestHeader("X-PJAX-Container",h.selector),c("pjax:beforeSend",[a,d])?(d.timeout>0&&(i=setTimeout(function(){c("pjax:timeout",[a,b])&&a.abort("timeout")},d.timeout),d.timeout=0),b.requestUrl=l(d.url).href,void 0):!1},b.complete=function(a,d){i&&clearTimeout(i),c("pjax:complete",[a,d,b]),c("pjax:end",[a,b])},b.error=function(a,d,e){var f=q("",a,b),h=c("pjax:error",[a,d,e,b]);"GET"==b.type&&"abort"!==d&&h&&g(f.url)},b.success=function(d,i,k){var m="function"==typeof a.pjax.defaults.version?a.pjax.defaults.version():a.pjax.defaults.version,n=k.getResponseHeader("X-PJAX-Version"),o=q(d,k,b);if(m&&n&&m!==n)return g(o.url),void 0;if(!o.contents)return g(o.url),void 0;e.state={id:b.id||j(),url:o.url,title:o.title,container:h.selector,fragment:b.fragment,timeout:b.timeout},(b.push||b.replace)&&window.history.replaceState(e.state,o.title,o.url),document.activeElement.blur(),o.title&&(document.title=o.title),h.html(o.contents);var p=h.find("input[autofocus], textarea[autofocus]").last()[0];if(p&&document.activeElement!==p&&p.focus(),r(o.scripts),"number"==typeof b.scrollTo&&a(window).scrollTop(b.scrollTo),""!==f){var s=l(o.url);s.hash=f,e.state.url=s.href,window.history.replaceState(e.state,o.title,s.href);var t=a(s.hash);t.length&&a(window).scrollTop(t.offset().top)}c("pjax:success",[d,i,k,b])},e.state||(e.state={id:j(),url:window.location.href,title:document.title,container:h.selector,fragment:b.fragment,timeout:b.timeout},window.history.replaceState(e.state,document.title));var m=e.xhr;m&&m.readyState<4&&(m.onreadystatechange=a.noop,m.abort()),e.options=b;var m=e.xhr=a.ajax(b);return m.readyState>0&&(b.push&&!b.replace&&(s(e.state.id,h.clone().contents()),window.history.pushState(null,"",k(b.requestUrl))),c("pjax:start",[m,b]),c("pjax:send",[m,b])),e.xhr}function f(b,c){var d={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return e(a.extend(d,m(b,c)))}function g(a){window.history.replaceState(null,"","#"),window.location.replace(a)}function h(b){var c=b.state;if(c&&c.container){if(x&&y==c.url)return;if(e.state.id===c.id)return;var d=a(c.container);if(d.length){var f,h=A[c.id];e.state&&(f=e.state.id<c.id?"forward":"back",t(f,e.state.id,d.clone().contents()));var i=a.Event("pjax:popstate",{state:c,direction:f});d.trigger(i);var j={id:c.id,url:c.url,container:d,push:!1,fragment:c.fragment,timeout:c.timeout,scrollTo:!1};h?(d.trigger("pjax:start",[null,j]),c.title&&(document.title=c.title),d.html(h),e.state=c,d.trigger("pjax:end",[null,j])):e(j),d[0].offsetHeight}else g(location.href)}x=!1}function i(b){var c=a.isFunction(b.url)?b.url():b.url,d=b.type?b.type.toUpperCase():"GET",e=a("<form>",{method:"GET"===d?"GET":"POST",action:c,style:"display:none"});"GET"!==d&&"POST"!==d&&e.append(a("<input>",{type:"hidden",name:"_method",value:d.toLowerCase()}));var f=b.data;if("string"==typeof f)a.each(f.split("&"),function(b,c){var d=c.split("=");e.append(a("<input>",{type:"hidden",name:d[0],value:d[1]}))});else if("object"==typeof f)for(key in f)e.append(a("<input>",{type:"hidden",name:key,value:f[key]}));a(document.body).append(e),e.submit()}function j(){return(new Date).getTime()}function k(a){return a.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function l(a){var b=document.createElement("a");return b.href=a,b}function m(b,c){return b&&c?c.container=b:c=a.isPlainObject(b)?b:{container:b},c.container&&(c.container=n(c.container)),c}function n(b){if(b=a(b),b.length){if(""!==b.selector&&b.context===document)return b;if(b.attr("id"))return a("#"+b.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+b.selector}function o(a,b){return a.filter(b).add(a.find(b))}function p(b){return a.parseHTML(b,document,!0)}function q(b,c,d){var e={};if(e.url=k(c.getResponseHeader("X-PJAX-URL")||d.requestUrl),/<html/i.test(b))var f=a(p(b.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),g=a(p(b.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var f=g=a(p(b));if(0===g.length)return e;if(e.title=o(f,"title").last().text(),d.fragment){if("body"===d.fragment)var h=g;else var h=o(g,d.fragment).first();h.length&&(e.contents=h.contents(),e.title||(e.title=h.attr("title")||h.data("title")))}else/<html/i.test(b)||(e.contents=g);return e.contents&&(e.contents=e.contents.not(function(){return a(this).is("title")}),e.contents.find("title").remove(),e.scripts=o(e.contents,"script[src]").remove(),e.contents=e.contents.not(e.scripts)),e.title&&(e.title=a.trim(e.title)),e}function r(b){if(b){var c=a("script[src]");b.each(function(){var b=this.src,d=c.filter(function(){return this.src===b});if(!d.length){var e=document.createElement("script");e.type=a(this).attr("type"),e.src=a(this).attr("src"),document.head.appendChild(e)}})}}function s(a,b){for(A[a]=b,C.push(a);B.length;)delete A[B.shift()];for(;C.length>e.defaults.maxCacheLength;)delete A[C.shift()]}function t(a,b,c){var d,e;A[b]=c,"forward"===a?(d=C,e=B):(d=B,e=C),d.push(b),(b=e.pop())&&delete A[b]}function u(){return a("meta").filter(function(){var b=a(this).attr("http-equiv");return b&&"X-PJAX-VERSION"===b.toUpperCase()}).attr("content")}function v(){a.fn.pjax=b,a.pjax=e,a.pjax.enable=a.noop,a.pjax.disable=w,a.pjax.click=c,a.pjax.submit=d,a.pjax.reload=f,a.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:u},a(window).on("popstate.pjax",h)}function w(){a.fn.pjax=function(){return this},a.pjax=i,a.pjax.enable=v,a.pjax.disable=a.noop,a.pjax.click=a.noop,a.pjax.submit=a.noop,a.pjax.reload=function(){window.location.reload()},a(window).off("popstate.pjax",h)}var x=!0,y=window.location.href,z=window.history.state;z&&z.container&&(e.state=z),"state"in window.history&&(x=!1);var A={},B=[],C=[];a.inArray("state",a.event.props)<0&&a.event.props.push("state"),a.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/),a.support.pjax?v():w()}(jQuery),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?(arguments.length&&this._createWidget(a,b),void 0):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}(),void 0):(i[b]=d,void 0)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; "+"attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a,b){function c(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function d(b,c){return parseInt(a.css(b,c),10)||0}function e(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(f!==b)return f;var c,d,e=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),g=e.children()[0];return a("body").append(e),c=g.offsetWidth,e.css("overflow","scroll"),d=g.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(b){var c=b.isWindow?"":b.element.css("overflow-x"),d=b.isWindow?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]);return{element:c,isWindow:d,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d?c.width():c.outerWidth(),height:d?c.height():c.outerHeight()}}},a.fn.position=function(b){if(!b||!b.of)return o.apply(this,arguments);b=a.extend({},b);var f,n,p,q,r,s,t=a(b.of),u=a.position.getWithinInfo(b.within),v=a.position.getScrollInfo(u),w=(b.collision||"flip").split(" "),x={};return s=e(t),t[0].preventDefault&&(b.at="left top"),n=s.width,p=s.height,q=s.offset,r=a.extend({},q),a.each(["my","at"],function(){var a,c,d=(b[this]||"").split(" ");1===d.length&&(d=j.test(d[0])?d.concat(["center"]):k.test(d[0])?["center"].concat(d):["center","center"]),d[0]=j.test(d[0])?d[0]:"center",d[1]=k.test(d[1])?d[1]:"center",a=l.exec(d[0]),c=l.exec(d[1]),x[this]=[a?a[0]:0,c?c[0]:0],b[this]=[m.exec(d[0])[0],m.exec(d[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===b.at[0]?r.left+=n:"center"===b.at[0]&&(r.left+=n/2),"bottom"===b.at[1]?r.top+=p:"center"===b.at[1]&&(r.top+=p/2),f=c(x.at,n,p),r.left+=f[0],r.top+=f[1],this.each(function(){var e,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=d(this,"marginLeft"),s=d(this,"marginTop"),y=l+o+d(this,"marginRight")+v.width,z=m+s+d(this,"marginBottom")+v.height,A=a.extend({},r),B=c(x.my,k.outerWidth(),k.outerHeight());"right"===b.my[0]?A.left-=l:"center"===b.my[0]&&(A.left-=l/2),"bottom"===b.my[1]?A.top-=m:"center"===b.my[1]&&(A.top-=m/2),A.left+=B[0],A.top+=B[1],a.support.offsetFractions||(A.left=i(A.left),A.top=i(A.top)),e={marginLeft:o,marginTop:s},a.each(["left","top"],function(c,d){a.ui.position[w[c]]&&a.ui.position[w[c]][d](A,{targetWidth:n,targetHeight:p,elemWidth:l,elemHeight:m,collisionPosition:e,collisionWidth:y,collisionHeight:z,offset:[f[0]+B[0],f[1]+B[1]],my:b.my,at:b.at,within:u,elem:k})}),b.using&&(j=function(a){var c=q.left-A.left,d=c+n-l,e=q.top-A.top,f=e+p-m,i={target:{element:t,left:q.left,top:q.top,width:n,height:p},element:{element:k,left:A.left,top:A.top,width:l,height:m},horizontal:0>d?"left":c>0?"right":"center",vertical:0>f?"top":e>0?"bottom":"middle"};l>n&&h(c+d)<n&&(i.horizontal="center"),m>p&&h(e+f)<p&&(i.vertical="middle"),i.important=g(h(c),h(d))>g(h(e),h(f))?"horizontal":"vertical",b.using.call(this,a,i)}),k.offset(a.extend(A,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):a.left=j>0&&0>=i?e:i>j?e+f-b.collisionWidth:e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):a.top=j>0&&0>=i?e:i>j?e+f-b.collisionHeight:e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];
0>k?(c=a.left+m+n+o+b.collisionWidth-g-f,(0>c||c<h(k))&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||h(d)<l)&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(0>d||d<h(k))&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||h(c)<l)&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");b=document.createElement(g?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(h),c=g||document.documentElement,c.insertBefore(b,c.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",e=a(h).offset().left,a.support.offsetFractions=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(jQuery),function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===e.containment?(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):e.containment.constructor===Array?(this.containment=e.containment,void 0):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c),void 0):(this.containment=null,void 0)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=Math.abs(j-t)<=p,e=Math.abs(k-s)<=p,f=Math.abs(h-r)<=p,g=Math.abs(i-q)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=Math.abs(j-s)<=p,e=Math.abs(k-t)<=p,f=Math.abs(h-q)<=p,g=Math.abs(i-r)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}a.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b=this.options,c=b.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=0,c=a.ui.ddmanager.droppables[this.options.scope];b<c.length;b++)c[b]===this&&c.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){"accept"===b&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return d&&(d.currentItem||d.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"ui-droppable");return b.options.greedy&&!b.options.disabled&&b.options.scope===d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)?(e=!0,!1):void 0}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(a,c,d){if(!c.offset)return!1;var e,f,g=(a.positionAbs||a.position.absolute).left,h=g+a.helperProportions.width,i=(a.positionAbs||a.position.absolute).top,j=i+a.helperProportions.height,k=c.offset.left,l=k+c.proportions.width,m=c.offset.top,n=m+c.proportions.height;switch(d){case"fit":return g>=k&&l>=h&&i>=m&&n>=j;case"intersect":return k<g+a.helperProportions.width/2&&h-a.helperProportions.width/2<l&&m<i+a.helperProportions.height/2&&j-a.helperProportions.height/2<n;case"pointer":return e=(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,f=(a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,b(f,m,c.proportions.height)&&b(e,k,c.proportions.width);case"touch":return(i>=m&&n>=i||j>=m&&n>=j||m>i&&j>n)&&(g>=k&&l>=g||h>=k&&l>=h||k>g&&h>l);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;d<f.length;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;e<h.length;e++)if(h[e]===f[d].element[0]){f[d].proportions.height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions={width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight})}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a.data(this,"ui-droppable").options.scope===e}),f.length&&(d=a.data(f[0],"ui-droppable"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(jQuery),function(a){function b(a){return parseInt(a,10)||0}function c(a){return!isNaN(parseInt(a,10))}a.widget("ui.resizable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var b,c,d,e,f,g=this,h=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=h.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),b=this.handles.split(","),this.handles={},c=0;c<b.length;c++)d=a.trim(b[c]),f="ui-resizable-"+d,e=a("<div class='ui-resizable-handle "+f+"'></div>"),e.css({zIndex:h.zIndex}),"se"===d&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[d]=".ui-resizable-"+d,this.element.append(e);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String&&(this.handles[c]=a(this.handles[c],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),a(this.handles[c]).length},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){g.resizing||(this.className&&(e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),g.axis=e&&e[1]?e[1]:"se")}),h.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){h.disabled||(a(this).removeClass("ui-resizable-autohide"),g._handles.show())}).mouseleave(function(){h.disabled||g.resizing||(a(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)d=a(this.handles[c])[0],(d===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(c){var d,e,f,g=this.options,h=this.element.position(),i=this.element;return this.resizing=!0,/absolute/.test(i.css("position"))?i.css({position:"absolute",top:i.css("top"),left:i.css("left")}):i.is(".ui-draggable")&&i.css({position:"absolute",top:h.top,left:h.left}),this._renderProxy(),d=b(this.helper.css("left")),e=b(this.helper.css("top")),g.containment&&(d+=a(g.containment).scrollLeft()||0,e+=a(g.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:d,top:e},this.size=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.originalSize=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.originalPosition={left:d,top:e},this.sizeDiff={width:i.outerWidth()-i.width(),height:i.outerHeight()-i.height()},this.originalMousePosition={left:c.pageX,top:c.pageY},this.aspectRatio="number"==typeof g.aspectRatio?g.aspectRatio:this.originalSize.width/this.originalSize.height||1,f=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===f?this.axis+"-resize":f),i.addClass("ui-resizable-resizing"),this._propagate("start",c),!0},_mouseDrag:function(b){var c,d=this.helper,e={},f=this.originalMousePosition,g=this.axis,h=this.position.top,i=this.position.left,j=this.size.width,k=this.size.height,l=b.pageX-f.left||0,m=b.pageY-f.top||0,n=this._change[g];return n?(c=n.apply(this,[b,l,m]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),this.position.top!==h&&(e.top=this.position.top+"px"),this.position.left!==i&&(e.left=this.position.left+"px"),this.size.width!==j&&(e.width=this.size.width+"px"),this.size.height!==k&&(e.height=this.size.height+"px"),d.css(e),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(e)||this._trigger("resize",b,this.ui()),!1):!1},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&a.ui.hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1
},_updateVirtualBoundaries:function(a){var b,d,e,f,g,h=this.options;g={minWidth:c(h.minWidth)?h.minWidth:0,maxWidth:c(h.maxWidth)?h.maxWidth:1/0,minHeight:c(h.minHeight)?h.minHeight:0,maxHeight:c(h.maxHeight)?h.maxHeight:1/0},(this._aspectRatio||a)&&(b=g.minHeight*this.aspectRatio,e=g.minWidth/this.aspectRatio,d=g.maxHeight*this.aspectRatio,f=g.maxWidth/this.aspectRatio,b>g.minWidth&&(g.minWidth=b),e>g.minHeight&&(g.minHeight=e),d<g.maxWidth&&(g.maxWidth=d),f<g.maxHeight&&(g.maxHeight=f)),this._vBoundaries=g},_updateCache:function(a){this.offset=this.helper.offset(),c(a.left)&&(this.position.left=a.left),c(a.top)&&(this.position.top=a.top),c(a.height)&&(this.size.height=a.height),c(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,d=this.size,e=this.axis;return c(a.height)?a.width=a.height*this.aspectRatio:c(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===e&&(a.left=b.left+(d.width-a.width),a.top=null),"nw"===e&&(a.top=b.top+(d.height-a.height),a.left=b.left+(d.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,d=this.axis,e=c(a.width)&&b.maxWidth&&b.maxWidth<a.width,f=c(a.height)&&b.maxHeight&&b.maxHeight<a.height,g=c(a.width)&&b.minWidth&&b.minWidth>a.width,h=c(a.height)&&b.minHeight&&b.minHeight>a.height,i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,k=/sw|nw|w/.test(d),l=/nw|ne|n/.test(d);return g&&(a.width=b.minWidth),h&&(a.height=b.minHeight),e&&(a.width=b.maxWidth),f&&(a.height=b.maxHeight),g&&k&&(a.left=i-b.minWidth),e&&k&&(a.left=i-b.maxWidth),h&&l&&(a.top=j-b.minHeight),f&&l&&(a.top=j-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var a,b,c,d,e,f=this.helper||this.element;for(a=0;a<this._proportionallyResizeElements.length;a++){if(e=this._proportionallyResizeElements[a],!this.borderDif)for(this.borderDif=[],c=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],d=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")],b=0;b<c.length;b++)this.borderDif[b]=(parseInt(c[b],10)||0)+(parseInt(d[b],10)||0);e.css({height:f.height()-this.borderDif[0]-this.borderDif[2]||0,width:f.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize,d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize,e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("ui-resizable"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var c,d,e,f,g,h,i,j=a(this).data("ui-resizable"),k=j.options,l=j.element,m=k.containment,n=m instanceof a?m.get(0):/parent/.test(m)?l.parent().get(0):m;n&&(j.containerElement=a(n),/document/.test(m)||m===document?(j.containerOffset={left:0,top:0},j.containerPosition={left:0,top:0},j.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(c=a(n),d=[],a(["Top","Right","Left","Bottom"]).each(function(a,e){d[a]=b(c.css("padding"+e))}),j.containerOffset=c.offset(),j.containerPosition=c.position(),j.containerSize={height:c.innerHeight()-d[3],width:c.innerWidth()-d[1]},e=j.containerOffset,f=j.containerSize.height,g=j.containerSize.width,h=a.ui.hasScroll(n,"left")?n.scrollWidth:g,i=a.ui.hasScroll(n)?n.scrollHeight:f,j.parentData={element:n,left:e.left,top:e.top,width:h,height:i}))},resize:function(b){var c,d,e,f,g=a(this).data("ui-resizable"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio),g.position.top=g._helper?i.top:0),g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top,c=Math.abs((g._helper?g.offset.left-l.left:g.offset.left-l.left)+g.sizeDiff.width),d=Math.abs((g._helper?g.offset.top-l.top:g.offset.top-i.top)+g.sizeDiff.height),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f&&(c-=g.parentData.left),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio)),d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio))},stop:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"!=typeof c.alsoResize||c.alsoResize.parentNode?d(c.alsoResize):c.alsoResize.length?(c.alsoResize=c.alsoResize[0],d(c.alsoResize)):a.each(c.alsoResize,function(a){d(a)})},resize:function(b,c){var d=a(this).data("ui-resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("ui-resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};"object"!=typeof e.alsoResize||e.alsoResize.nodeType?i(e.alsoResize):a.each(e.alsoResize,function(a,b){i(a,b)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("ui-resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("ui-resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size,e=b.originalSize,f=b.originalPosition,g=b.axis,h="number"==typeof c.grid?[c.grid,c.grid]:c.grid,i=h[0]||1,j=h[1]||1,k=Math.round((d.width-e.width)/i)*i,l=Math.round((d.height-e.height)/j)*j,m=e.width+k,n=e.height+l,o=c.maxWidth&&c.maxWidth<m,p=c.maxHeight&&c.maxHeight<n,q=c.minWidth&&c.minWidth>m,r=c.minHeight&&c.minHeight>n;c.grid=h,q&&(m+=i),r&&(n+=j),o&&(m-=i),p&&(n-=j),/^(se|s|e)$/.test(g)?(b.size.width=m,b.size.height=n):/^(ne)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.top=f.top-l):/^(sw)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.left=f.left-k):(b.size.width=m,b.size.height=n,b.position.top=f.top-l,b.position.left=f.left-k)}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}function c(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))}a.widget("ui.sortable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===a.axis||c(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),d?!this.options.handle||c||(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),e)?(this.currentItem=d,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d),f&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],e):!0)){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(a){var c="x"===this.options.axis||b(this.positionAbs.top+this.offset.click.top,a.top,a.height),d="y"===this.options.axis||b(this.positionAbs.left+this.offset.click.left,a.left,a.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1):!1},_intersectsWithSides:function(a){var c=b(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),d=b(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&c||"up"===e&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c,d,e,f,g=[],h=[],i=this._connectWith();if(i&&b)for(c=i.length-1;c>=0;c--)for(e=a(i[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&h.push([a.isFunction(f.options.items)?f.options.items.call(f.element):a(f.options.items,f.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),f]);for(h.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),c=h.length-1;c>=0;c--)h[c][0].each(function(){g.push(this)});return a(g)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;c<b.length;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(d){var e,f,g,h,i,j,k,l,m,n,o=null,p=null;for(e=this.containers.length-1;e>=0;e--)if(!a.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(o&&a.contains(this.containers[e].element[0],o.element[0]))continue;o=this.containers[e],p=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",d,this._uiHash(this)),this.containers[e].containerCache.over=0);if(o)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",d,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(g=1e4,h=null,n=o.floating||c(this.currentItem),i=n?"left":"top",j=n?"width":"height",k=this.positionAbs[i]+this.offset.click[i],f=this.items.length-1;f>=0;f--)a.contains(this.containers[p].element[0],this.items[f].item[0])&&this.items[f].item[0]!==this.currentItem[0]&&(!n||b(this.positionAbs.top+this.offset.click.top,this.items[f].top,this.items[f].height))&&(l=this.items[f].item.offset()[i],m=!1,Math.abs(l-k)>Math.abs(l+this.items[f][j]-k)&&(m=!0,l+=this.items[f][j]),Math.abs(l-k)<g&&(g=Math.abs(l-k),h=this.items[f],this.direction=m?"up":"down"));if(!h&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;h?this._rearrange(d,h,null,!0):this._rearrange(d,null,this.containers[p].element,!0),this._trigger("change",d,this._uiHash()),this.containers[p]._trigger("change",d,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",d,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){this.reverting=!1;var c,d=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(c in this._storedCSS)("auto"===this._storedCSS[c]||"static"===this._storedCSS[c])&&(this._storedCSS[c]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))
}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||d.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(d.push(function(a){this._trigger("remove",a,this._uiHash())}),d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),c=this.containers.length-1;c>=0;c--)b||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){for(this._trigger("beforeStop",a,this._uiHash()),c=0;c<d.length;c++)d[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(c=0;c<d.length;c++)d[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}(jQuery),function(a){var b=0;a.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var b,c,d,e=this.element[0].nodeName.toLowerCase(),f="textarea"===e,g="input"===e;this.isMultiLine=f?!0:g?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[f||g?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))return b=!0,d=!0,c=!0,void 0;b=!1,d=!1,c=!1;var f=a.ui.keyCode;switch(e.keyCode){case f.PAGE_UP:b=!0,this._move("previousPage",e);break;case f.PAGE_DOWN:b=!0,this._move("nextPage",e);break;case f.UP:b=!0,this._keyEvent("previous",e);break;case f.DOWN:b=!0,this._keyEvent("next",e);break;case f.ENTER:case f.NUMPAD_ENTER:this.menu.active&&(b=!0,e.preventDefault(),this.menu.select(e));break;case f.TAB:this.menu.active&&this.menu.select(e);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}},keypress:function(d){if(b)return b=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&d.preventDefault(),void 0;if(!c){var e=a.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:this._move("previousPage",d);break;case e.PAGE_DOWN:this._move("nextPage",d);break;case e.UP:this._keyEvent("previous",d);break;case e.DOWN:this._keyEvent("next",d)}}},input:function(a){return d?(d=!1,a.preventDefault(),void 0):(this._searchTimeout(a),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(a){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(a),this._change(a),void 0)}}),this._initSource(),this.menu=a("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(b){b.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var c=this.menu.element[0];a(b.target).closest(".ui-menu-item").length||this._delay(function(){var b=this;this.document.one("mousedown",function(d){d.target===b.element[0]||d.target===c||a.contains(c,d.target)||b.close()})})},menufocus:function(b,c){if(this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type)))return this.menu.blur(),this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)}),void 0;var d=c.item.data("ui-autocomplete-item");!1!==this._trigger("focus",b,{item:d})?b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(d.value):this.liveRegion.text(d.value)},menuselect:function(a,b){var c=b.item.data("ui-autocomplete-item"),d=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d,this.selectedItem=c})),!1!==this._trigger("select",a,{item:c})&&this._value(c.value),this.term=this._value(),this.close(a),this.selectedItem=c}}),this.liveRegion=a("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(a,b){this._super(a,b),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&b&&this.xhr&&this.xhr.abort()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_initSource:function(){var b,c,d=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(c,d){d(a.ui.autocomplete.filter(b,c.term))}):"string"==typeof this.options.source?(c=this.options.source,this.source=function(b,e){d.xhr&&d.xhr.abort(),d.xhr=a.ajax({url:c,data:b,dataType:"json",success:function(a){e(a)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){return a=null!=a?a:this._value(),this.term=this._value(),a.length<this.options.minLength?this.close(b):this._trigger("search",b)!==!1?this._search(a):void 0},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:a},this._response())},_response:function(){var a=this,c=++b;return function(d){c===b&&a.__response(d),a.pending--,a.pending||a.element.removeClass("ui-autocomplete-loading")}},__response:function(a){a&&(a=this._normalize(a)),this._trigger("response",null,{content:a}),!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0,this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty();this._renderMenu(c,b),this.isNewMenu=!0,this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItemData(b,c)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){return a("<li>").append(a("<a>").text(c.label)).appendTo(b)},_move:function(a,b){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this._value(this.term),this.menu.blur(),void 0):(this.menu[a](b),void 0):(this.search(null,b),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(a,b),b.preventDefault())}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}}),a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(a){var b;this._superApply(arguments),this.options.disabled||this.cancelSearch||(b=a&&a.length?this.options.messages.results(a.length):this.options.messages.noResults,this.liveRegion.text(b))}})}(jQuery),function(a){var b,c,d,e,f="ui-button ui-widget ui-state-default ui-corner-all",g="ui-state-hover ui-state-active ",h="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",i=function(){var b=a(this);setTimeout(function(){b.find(":ui-button").button("refresh")},1)},j=function(b){var c=b.name,d=b.form,e=a([]);return c&&(c=c.replace(/'/g,"\\'"),e=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,i),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var g=this,h=this.options,k="checkbox"===this.type||"radio"===this.type,l=k?"":"ui-state-active",m="ui-state-focus";null===h.label&&(h.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(f).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){h.disabled||this===b&&a(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){h.disabled||a(this).removeClass(l)}).bind("click"+this.eventNamespace,function(a){h.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){g.buttonElement.addClass(m)}).bind("blur"+this.eventNamespace,function(){g.buttonElement.removeClass(m)}),k&&(this.element.bind("change"+this.eventNamespace,function(){e||g.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(a){h.disabled||(e=!1,c=a.pageX,d=a.pageY)}).bind("mouseup"+this.eventNamespace,function(a){h.disabled||(c!==a.pageX||d!==a.pageY)&&(e=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return h.disabled||e?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(h.disabled||e)return!1;a(this).addClass("ui-state-active"),g.buttonElement.attr("aria-pressed","true");var b=g.element[0];j(b).not(b).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return h.disabled?!1:(a(this).addClass("ui-state-active"),b=this,g.document.one("mouseup",function(){b=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return h.disabled?!1:(a(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(b){return h.disabled?!1:((b.keyCode===a.ui.keyCode.SPACE||b.keyCode===a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",h.disabled),this._resetButton()},_determineButtonType:function(){var a,b,c;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),c=this.element.is(":checked"),c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(f+" "+g+" "+h).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){return this._super(a,b),"disabled"===a?(b?this.element.prop("disabled",!0):this.element.prop("disabled",!1),void 0):(this._resetButton(),void 0)},refresh:function(){var b=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");b!==this.options.disabled&&this._setOption("disabled",b),"radio"===this.type?j(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var b=this.buttonElement.removeClass(h),c=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(c)))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}),a.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b),this._super(a,b)},refresh:function(){var b="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(a){var b={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},c={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&a.fn.draggable&&this._makeDraggable(),this.options.resizable&&a.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var b=this.options.appendTo;return b&&(b.jquery||b.nodeType)?a(b):this.document.find(b||"body").eq(0)},_destroy:function(){var a,b=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),a=b.parent.children().eq(b.index),a.length&&a[0]!==this.element[0]?a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(b){var c=this;this._isOpen&&this._trigger("beforeClose",b)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||a(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){c._trigger("close",b)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(a,b){var c=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return c&&!b&&this._trigger("focus",a),c},open:function(){var b=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=a(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){b._focusTabbable(),b._trigger("focus")}),this._trigger("open"),void 0)},_focusTabbable:function(){var a=this.element.find("[autofocus]");a.length||(a=this.element.find(":tabbable")),a.length||(a=this.uiDialogButtonPane.find(":tabbable")),a.length||(a=this.uiDialogTitlebarClose.filter(":tabbable")),a.length||(a=this.uiDialog),a.eq(0).focus()},_keepFocus:function(b){function c(){var b=this.document[0].activeElement,c=this.uiDialog[0]===b||a.contains(this.uiDialog[0],b);c||this._focusTabbable()}b.preventDefault(),c.call(this),this._delay(c)},_createWrapper:function(){this.uiDialog=a("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(b){if(this.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE)return b.preventDefault(),this.close(b),void 0;if(b.keyCode===a.ui.keyCode.TAB){var c=this.uiDialog.find(":tabbable"),d=c.filter(":first"),e=c.filter(":last");b.target!==e[0]&&b.target!==this.uiDialog[0]||b.shiftKey?b.target!==d[0]&&b.target!==this.uiDialog[0]||!b.shiftKey||(e.focus(1),b.preventDefault()):(d.focus(1),b.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var b;this.uiDialogTitlebar=a("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(b){a(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=a("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(a){a.preventDefault(),this.close(a)}}),b=a("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(b),this.uiDialog.attr({"aria-labelledby":b.attr("id")})},_title:function(a){this.options.title||a.html("&#160;"),a.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=a("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=a("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var b=this,c=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),a.isEmptyObject(c)||a.isArray(c)&&!c.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(a.each(c,function(c,d){var e,f;d=a.isFunction(d)?{click:d,text:c}:d,d=a.extend({type:"button"},d),e=d.click,d.click=function(){e.apply(b.element[0],arguments)},f={icons:d.icons,text:d.showText},delete d.icons,delete d.showText,a("<button></button>",d).button(f).appendTo(b.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,e){a(this).addClass("ui-dialog-dragging"),c._blockFrames(),c._trigger("dragStart",d,b(e))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(e,f){d.position=[f.position.left-c.document.scrollLeft(),f.position.top-c.document.scrollTop()],a(this).removeClass("ui-dialog-dragging"),c._unblockFrames(),c._trigger("dragStop",e,b(f))}})},_makeResizable:function(){function b(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var c=this,d=this.options,e=d.resizable,f=this.uiDialog.css("position"),g="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:this._minHeight(),handles:g,start:function(d,e){a(this).addClass("ui-dialog-resizing"),c._blockFrames(),c._trigger("resizeStart",d,b(e))},resize:function(a,d){c._trigger("resize",a,b(d))},stop:function(e,f){d.height=a(this).height(),d.width=a(this).width(),a(this).removeClass("ui-dialog-resizing"),c._unblockFrames(),c._trigger("resizeStop",e,b(f))}}).css("position",f)},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a=this.uiDialog.is(":visible");a||this.uiDialog.show(),this.uiDialog.position(this.options.position),a||this.uiDialog.hide()},_setOptions:function(d){var e=this,f=!1,g={};a.each(d,function(a,d){e._setOption(a,d),a in b&&(f=!0),a in c&&(g[a]=d)}),f&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",g)},_setOption:function(a,b){var c,d,e=this.uiDialog;"dialogClass"===a&&e.removeClass(this.options.dialogClass).addClass(b),"disabled"!==a&&(this._super(a,b),"appendTo"===a&&this.uiDialog.appendTo(this._appendTo()),"buttons"===a&&this._createButtons(),"closeText"===a&&this.uiDialogTitlebarClose.button({label:""+b}),"draggable"===a&&(c=e.is(":data(ui-draggable)"),c&&!b&&e.draggable("destroy"),!c&&b&&this._makeDraggable()),"position"===a&&this._position(),"resizable"===a&&(d=e.is(":data(ui-resizable)"),d&&!b&&e.resizable("destroy"),d&&"string"==typeof b&&e.resizable("option","handles",b),d||b===!1||this._makeResizable()),"title"===a&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var a,b,c,d=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),d.minWidth>d.width&&(d.width=d.minWidth),a=this.uiDialog.css({height:"auto",width:d.width}).outerHeight(),b=Math.max(0,d.minHeight-a),c="number"==typeof d.maxHeight?Math.max(0,d.maxHeight-a):"none","auto"===d.height?this.element.css({minHeight:b,maxHeight:c,height:"auto"}):this.element.height(Math.max(0,d.height-a)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var b=a(this);return a("<div>").css({position:"absolute",width:b.outerWidth(),height:b.outerHeight()}).appendTo(b.parent()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(b){return a(b.target).closest(".ui-dialog").length?!0:!!a(b.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var b=this,c=this.widgetFullName;a.ui.dialog.overlayInstances||this._delay(function(){a.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(d){b._allowInteraction(d)||(d.preventDefault(),a(".ui-dialog:visible:last .ui-dialog-content").data(c)._focusTabbable())})}),this.overlay=a("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),a.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(a.ui.dialog.overlayInstances--,a.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),a.ui.dialog.overlayInstances=0,a.uiBackCompat!==!1&&a.widget("ui.dialog",a.ui.dialog,{_position:function(){var b,c=this.options.position,d=[],e=[0,0];c?(("string"==typeof c||"object"==typeof c&&"0"in c)&&(d=c.split?c.split(" "):[c[0],c[1]],1===d.length&&(d[1]=d[0]),a.each(["left","top"],function(a,b){+d[a]===d[a]&&(e[a]=d[a],d[a]=b)}),c={my:d[0]+(e[0]<0?e[0]:"+"+e[0])+" "+d[1]+(e[1]<0?e[1]:"+"+e[1]),at:d.join(" ")}),c=a.extend({},a.ui.dialog.prototype.options.position,c)):c=a.ui.dialog.prototype.options.position,b=this.uiDialog.is(":visible"),b||this.uiDialog.show(),this.uiDialog.position(c),b||this.uiDialog.hide()}})}(jQuery),function(a){a.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,a.proxy(function(a){this.options.disabled&&a.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(a){a.preventDefault()},"click .ui-state-disabled > a":function(a){a.preventDefault()},"click .ui-menu-item:has(a)":function(b){var c=a(b.target).closest(".ui-menu-item");!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(b),c.has(".ui-menu").length?this.expand(b):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){var c=a(b.currentTarget);c.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.children(".ui-menu-item").eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var d,e,f,g,h,i=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:i=!1,e=this.previousFilter||"",f=String.fromCharCode(b.keyCode),g=!1,clearTimeout(this.filterTimer),f===e?g=!0:f=e+f,h=new RegExp("^"+c(f),"i"),d=this.activeMenu.children(".ui-menu-item").filter(function(){return h.test(a(this).children("a").text())}),d=g&&-1!==d.index(this.active.next())?this.active.nextAll(".ui-menu-item"):d,d.length||(f=String.fromCharCode(b.keyCode),h=new RegExp("^"+c(f),"i"),d=this.activeMenu.children(".ui-menu-item").filter(function(){return h.test(a(this).children("a").text())})),d.length?(this.focus(b,d),d.length>1?(this.previousFilter=f,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}i&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(a):this.select(a))},refresh:function(){var b,c=this.options.icons.submenu,d=this.element.find(this.options.menus);d.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),d=b.prev("a"),e=a("<span>").addClass("ui-menu-icon ui-icon "+c).data("ui-menu-submenu-carat",!0);
d.attr("aria-haspopup","true").prepend(e),b.attr("aria-labelledby",d.attr("id"))}),b=d.add(this.element),b.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),b.children(":not(.ui-menu-item)").each(function(){var b=a(this);/[^\-\u2014\u2013\s]/.test(b.text())||b.addClass("ui-widget-content ui-menu-divider")}),b.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.height(),0>e?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.children(".ui-menu-item")[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;return this.active?(this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d-e<0}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())),void 0):(this.next(b),void 0)},previousPage:function(b){var c,d,e;return this.active?(this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item").first())),void 0):(this.next(b),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)}})}(jQuery),function(a,b){var c="ui-effects-";a.effects={effect:{}},function(a,b){function c(a,b,c){var d=l[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:d.max<a?d.max:a)}function d(b){var c=j(),d=c._rgba=[];return b=b.toLowerCase(),o(i,function(a,e){var f,g=e.re.exec(b),h=g&&e.parse(g),i=e.space||"rgba";return h?(f=c[i](h),c[k[i].cache]=f[k[i].cache],d=c._rgba=f._rgba,!1):void 0}),d.length?("0,0,0,0"===d.join()&&a.extend(d,f.transparent),c):f[b]}function e(a,b,c){return c=(c+1)%1,1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var f,g="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",h=/^([\-+])=\s*(\d+\.?\d*)/,i=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],j=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},k={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},l={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},m=j.support={},n=a("<p>")[0],o=a.each;n.style.cssText="background-color:rgba(1,1,1,.5)",m.rgba=n.style.backgroundColor.indexOf("rgba")>-1,o(k,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),j.fn=a.extend(j.prototype,{parse:function(e,g,h,i){if(e===b)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=a(e).css(g),g=b);var l=this,m=a.type(e),n=this._rgba=[];return g!==b&&(e=[e,g,h,i],m="array"),"string"===m?this.parse(d(e)||f._default):"array"===m?(o(k.rgba.props,function(a,b){n[b.idx]=c(e[b.idx],b)}),this):"object"===m?(e instanceof j?o(k,function(a,b){e[b.cache]&&(l[b.cache]=e[b.cache].slice())}):o(k,function(b,d){var f=d.cache;o(d.props,function(a,b){if(!l[f]&&d.to){if("alpha"===a||null==e[a])return;l[f]=d.to(l._rgba)}l[f][b.idx]=c(e[a],b,!0)}),l[f]&&a.inArray(null,l[f].slice(0,3))<0&&(l[f][3]=1,d.from&&(l._rgba=d.from(l[f])))}),this):void 0},is:function(a){var b=j(a),c=!0,d=this;return o(k,function(a,e){var f,g=b[e.cache];return g&&(f=d[e.cache]||e.to&&e.to(d._rgba)||[],o(e.props,function(a,b){return null!=g[b.idx]?c=g[b.idx]===f[b.idx]:void 0})),c}),c},_space:function(){var a=[],b=this;return o(k,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var d=j(a),e=d._space(),f=k[e],g=0===this.alpha()?j("transparent"):this,h=g[f.cache]||f.to(g._rgba),i=h.slice();return d=d[f.cache],o(f.props,function(a,e){var f=e.idx,g=h[f],j=d[f],k=l[e.type]||{};null!==j&&(null===g?i[f]=j:(k.mod&&(j-g>k.mod/2?g+=k.mod:g-j>k.mod/2&&(g-=k.mod)),i[f]=c((j-g)*b+g,e)))}),this[e](i)},blend:function(b){if(1===this._rgba[3])return this;var c=this._rgba.slice(),d=c.pop(),e=j(b)._rgba;return j(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return null==a?b>2?1:0:a});return 1===c[3]&&(c.pop(),b="rgb("),b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return null==a&&(a=b>2?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===c[3]&&(c.pop(),b="hsl("),b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return b&&c.push(~~(255*d)),"#"+a.map(c,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),j.fn.parse.prototype=j.fn,k.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=a[3],h=Math.max(d,e,f),i=Math.min(d,e,f),j=h-i,k=h+i,l=.5*k;return b=i===h?0:d===h?60*(e-f)/j+360:e===h?60*(f-d)/j+120:60*(d-e)/j+240,c=0===j?0:.5>=l?j/k:j/(2-k),[Math.round(b)%360,c,l,null==g?1:g]},k.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],f=a[3],g=.5>=d?d*(1+c):d+c-d*c,h=2*d-g;return[Math.round(255*e(h,g,b+1/3)),Math.round(255*e(h,g,b)),Math.round(255*e(h,g,b-1/3)),f]},o(k,function(d,e){var f=e.props,g=e.cache,i=e.to,k=e.from;j.fn[d]=function(d){if(i&&!this[g]&&(this[g]=i(this._rgba)),d===b)return this[g].slice();var e,h=a.type(d),l="array"===h||"object"===h?d:arguments,m=this[g].slice();return o(f,function(a,b){var d=l["object"===h?a:b.idx];null==d&&(d=m[b.idx]),m[b.idx]=c(d,b)}),k?(e=j(k(m)),e[g]=m,e):j(m)},o(f,function(b,c){j.fn[b]||(j.fn[b]=function(e){var f,g=a.type(e),i="alpha"===b?this._hsla?"hsla":"rgba":d,j=this[i](),k=j[c.idx];return"undefined"===g?k:("function"===g&&(e=e.call(this,k),g=a.type(e)),null==e&&c.empty?this:("string"===g&&(f=h.exec(e),f&&(e=k+parseFloat(f[2])*("+"===f[1]?1:-1))),j[c.idx]=e,this[i](j)))})})}),j.hook=function(b){var c=b.split(" ");o(c,function(b,c){a.cssHooks[c]={set:function(b,e){var f,g,h="";if("transparent"!==e&&("string"!==a.type(e)||(f=d(e)))){if(e=j(f||e),!m.rgba&&1!==e._rgba[3]){for(g="backgroundColor"===c?b.parentNode:b;(""===h||"transparent"===h)&&g&&g.style;)try{h=a.css(g,"backgroundColor"),g=g.parentNode}catch(i){}e=e.blend(h&&"transparent"!==h?h:"_default")}e=e.toRgbaString()}try{b.style[c]=e}catch(i){}}},a.fx.step[c]=function(b){b.colorInit||(b.start=j(b.elem,c),b.end=j(b.end),b.colorInit=!0),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})},j.hook(g),a.cssHooks.borderColor={expand:function(a){var b={};return o(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},f=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function c(b){var c,d,e=b.ownerDocument.defaultView?b.ownerDocument.defaultView.getComputedStyle(b,null):b.currentStyle,f={};if(e&&e.length&&e[0]&&e[e[0]])for(d=e.length;d--;)c=e[d],"string"==typeof e[c]&&(f[a.camelCase(c)]=e[c]);else for(c in e)"string"==typeof e[c]&&(f[c]=e[c]);return f}function d(b,c){var d,e,g={};for(d in c)e=c[d],b[d]!==e&&(f[d]||(a.fx.step[d]||!isNaN(parseFloat(e)))&&(g[d]=e));return g}var e=["add","remove","toggle"],f={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){a.fx.step[c]=function(a){("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)&&(jQuery.style(a.elem,c,a.end),a.setAttr=!0)}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a.effects.animateClass=function(b,f,g,h){var i=a.speed(f,g,h);return this.queue(function(){var f,g=a(this),h=g.attr("class")||"",j=i.children?g.find("*").addBack():g;j=j.map(function(){var b=a(this);return{el:b,start:c(this)}}),f=function(){a.each(e,function(a,c){b[c]&&g[c+"Class"](b[c])})},f(),j=j.map(function(){return this.end=c(this.el[0]),this.diff=d(this.start,this.end),this}),g.attr("class",h),j=j.map(function(){var b=this,c=a.Deferred(),d=a.extend({},i,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()}),a.when.apply(a,j.get()).done(function(){f(),a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})}),i.complete.call(g[0])})})},a.fn.extend({addClass:function(b){return function(c,d,e,f){return d?a.effects.animateClass.call(this,{add:c},d,e,f):b.apply(this,arguments)}}(a.fn.addClass),removeClass:function(b){return function(c,d,e,f){return arguments.length>1?a.effects.animateClass.call(this,{remove:c},d,e,f):b.apply(this,arguments)}}(a.fn.removeClass),toggleClass:function(c){return function(d,e,f,g,h){return"boolean"==typeof e||e===b?f?a.effects.animateClass.call(this,e?{add:d}:{remove:d},f,g,h):c.apply(this,arguments):a.effects.animateClass.call(this,{toggle:d},e,f,g)}}(a.fn.toggleClass),switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,{add:c,remove:b},d,e,f)}})}(),function(){function d(b,c,d,e){return a.isPlainObject(b)&&(c=b,b=b.effect),b={effect:b},null==c&&(c={}),a.isFunction(c)&&(e=c,d=null,c={}),("number"==typeof c||a.fx.speeds[c])&&(e=d,d=c,c={}),a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b}function e(b){return!b||"number"==typeof b||a.fx.speeds[b]?!0:"string"!=typeof b||a.effects.effect[b]?a.isFunction(b)?!0:"object"!=typeof b||b.effect?!1:!0:!0}a.extend(a.effects,{version:"1.10.3",save:function(a,b){for(var d=0;d<b.length;d++)null!==b[d]&&a.data(c+b[d],a[0].style[b[d]])},restore:function(a,d){var e,f;for(f=0;f<d.length;f++)null!==d[f]&&(e=a.data(c+d[f]),e===b&&(e=""),a.css(d[f],e))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(g){f=document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),"static"===b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(){function b(b){function d(){a.isFunction(f)&&f.call(e[0]),a.isFunction(b)&&b()}var e=a(this),f=c.complete,h=c.mode;(e.is(":hidden")?"hide"===h:"show"===h)?(e[h](),d()):g.call(e[0],c,d)}var c=d.apply(this,arguments),e=c.mode,f=c.queue,g=a.effects.effect[c.effect];return a.fx.off||!g?e?this[e](c.duration,c.complete):this.each(function(){c.complete&&c.complete.call(this)}):f===!1?this.each(b):this.queue(f||"fx",b)},show:function(a){return function(b){if(e(b))return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="show",this.effect.call(this,c)}}(a.fn.show),hide:function(a){return function(b){if(e(b))return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="hide",this.effect.call(this,c)}}(a.fn.hide),toggle:function(a){return function(b){if(e(b)||"boolean"==typeof b)return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="toggle",this.effect.call(this,c)}}(a.fn.toggle),cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}})}(),function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,c){b[c]=function(b){return Math.pow(b,a+2)}}),a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,--c))-1)/11;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),a.each(b,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return.5>a?c(2*a)/2:1-c(-2*a+2)/2}})}()}(jQuery),function(a){a.effects.effect.highlight=function(b,c){var d=a(this),e=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(d,b.mode||"show"),g={backgroundColor:d.css("backgroundColor")};"hide"===f&&(g.opacity=0),a.effects.save(d,e),d.show().css({backgroundImage:"none",backgroundColor:b.color||"#ffff99"}).animate(g,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===f&&d.hide(),a.effects.restore(d,e),c()}})}}(jQuery),function(a){a.effects.effect.pulsate=function(b,c){var d,e=a(this),f=a.effects.setMode(e,b.mode||"show"),g="show"===f,h="hide"===f,i=g||"hide"===f,j=2*(b.times||5)+(i?1:0),k=b.duration/j,l=0,m=e.queue(),n=m.length;for((g||!e.is(":visible"))&&(e.css("opacity",0).show(),l=1),d=1;j>d;d++)e.animate({opacity:l},k,b.easing),l=1-l;e.animate({opacity:l},k,b.easing),e.queue(function(){h&&e.hide(),c()}),n>1&&m.splice.apply(m,[1,0].concat(m.splice(n,j+1))),e.dequeue()}}(jQuery),function(a){a.effects.effect.slide=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","width","height"],g=a.effects.setMode(e,b.mode||"show"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i,l={};a.effects.save(e,f),e.show(),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0),a.effects.createWrapper(e).css({overflow:"hidden"}),h&&e.css(j,k?isNaN(d)?"-"+d:-d:d),l[j]=(h?k?"+=":"-=":k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})}}(jQuery),function(a){var b=a({});a.subscribe=function(){b.on.apply(b,arguments)},a.unsubscribe=function(){b.off.apply(b,arguments)},a.publish=function(){b.trigger.apply(b,arguments)}}(jQuery),function(a,b,c){function d(a){return a}function e(a){return decodeURIComponent(a.replace(f," "))}var f=/\+/g;a.cookie=function(f,g,h){if(g!==c&&!/Object/.test(Object.prototype.toString.call(g))){if(h=a.extend({},a.cookie.defaults,h),null===g&&(h.expires=-1),"number"==typeof h.expires){var i=h.expires,j=h.expires=new Date;j.setDate(j.getDate()+i)}return g=String(g),b.cookie=[encodeURIComponent(f),"=",h.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}h=g||a.cookie.defaults||{};for(var k,l=h.raw?d:e,m=b.cookie.split("; "),n=0;k=m[n]&&m[n].split("=");n++)if(l(k.shift())===f)return l(k.join("="));return null},a.cookie.defaults={},a.removeCookie=function(b,c){return null!==a.cookie(b,c)?(a.cookie(b,null,c),!0):!1}}(jQuery,document),function(a,b){"$:nomunge";function c(a){return"string"==typeof a}function d(a){var b=r.call(arguments,1);return function(){return a.apply(this,b.concat(r.call(arguments)))}}function e(a){return a.replace(/^[^#]*#?(.*)$/,"$1")}function f(a){return a.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function g(d,e,f,g,h){var i,k,m,n,o;return g!==j?(m=f.match(d?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/),o=m[3]||"",2===h&&c(g)?k=g.replace(d?E:D,""):(n=l(m[2]),g=c(g)?l[d?y:x](g):g,k=2===h?g:1===h?a.extend({},g,n):a.extend({},n,g),k=t(k),d&&(k=k.replace(q,s))),i=m[1]+(d?"#":k||!m[1]?"?":"")+k+o):i=e(f!==j?f:b[A][B]),i}function h(a,b,d){return b===j||"boolean"==typeof b?(d=b,b=t[a?y:x]()):b=c(b)?b.replace(a?E:D,""):b,l(b,d)}function i(b,d,e,f){return c(e)||"object"==typeof e||(f=e,e=d,d=j),this.each(function(){var c=a(this),g=d||p()[(this.nodeName||"").toLowerCase()]||"",h=g&&c.attr(g)||"";c.attr(g,t[b](h,e,f))})}var j,k,l,m,n,o,p,q,r=Array.prototype.slice,s=decodeURIComponent,t=a.param,u=a.bbq=a.bbq||{},v=a.event.special,w="hashchange",x="querystring",y="fragment",z="elemUrlAttr",A="location",B="href",C="src",D=/^.*\?|#.*$/g,E=/^.*\#/,F={};t[x]=d(g,0,f),t[y]=k=d(g,1,e),k.noEscape=function(b){b=b||"";var c=a.map(b.split(""),encodeURIComponent);q=new RegExp(c.join("|"),"g")},k.noEscape(",/"),a.deparam=l=function(b,c){var d={},e={"true":!0,"false":!1,"null":null};return a.each(b.replace(/\+/g," ").split("&"),function(b,f){var g,h=f.split("="),i=s(h[0]),k=d,l=0,m=i.split("]["),n=m.length-1;if(/\[/.test(m[0])&&/\]$/.test(m[n])?(m[n]=m[n].replace(/\]$/,""),m=m.shift().split("[").concat(m),n=m.length-1):n=0,2===h.length)if(g=s(h[1]),c&&(g=g&&!isNaN(g)?+g:"undefined"===g?j:e[g]!==j?e[g]:g),n)for(;n>=l;l++)i=""===m[l]?k.length:m[l],k=k[i]=n>l?k[i]||(m[l+1]&&isNaN(m[l+1])?{}:[]):g;else a.isArray(d[i])?d[i].push(g):d[i]=d[i]!==j?[d[i],g]:g;else i&&(d[i]=c?j:"")}),d},l[x]=d(h,0),l[y]=m=d(h,1),a[z]||(a[z]=function(b){return a.extend(F,b)})({a:B,base:B,iframe:C,img:C,input:C,form:"action",link:B,script:C}),p=a[z],a.fn[x]=d(i,x),a.fn[y]=d(i,y),u.pushState=n=function(a,d){c(a)&&/^#/.test(a)&&d===j&&(d=2);var e=a!==j,f=k(b[A][B],e?a:{},e?d:2);b[A][B]=f+(/#/.test(f)?"":"#")},u.getState=o=function(a,b){return a===j||"boolean"==typeof a?m(a):m(b)[a]},u.removeState=function(b){var c={};b!==j&&(c=o(),a.each(a.isArray(b)?b:arguments,function(a,b){delete c[b]})),n(c,2)},v[w]=a.extend(v[w],{add:function(b){function c(a){var b=a[y]=k();a.getState=function(a,c){return a===j||"boolean"==typeof a?l(b,a):l(b,c)[a]},d.apply(this,arguments)}var d;return a.isFunction(b)?(d=b,c):(d=b.handler,b.handler=c,void 0)}})}(jQuery,this),function(a,b,c){"$:nomunge";function d(a){return a=a||b[g][i],a.replace(/^[^#]*#?(.*)$/,"$1")}var e,f=a.event.special,g="location",h="hashchange",i="href",j=document.documentMode,k=navigator.userAgent.match(/MSIE/i)&&(j===c||8>j),l="on"+h in b&&!k;a[h+"Delay"]=100,f[h]=a.extend(f[h],{setup:function(){return l?!1:(a(e.start),void 0)},teardown:function(){return l?!1:(a(e.stop),void 0)}}),e=function(){function c(){j=l=function(a){return a},k&&(f=a('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow,l=function(){return d(f.document[g][i])},j=function(a,b){if(a!==b){var c=f.document;c.open().close(),c[g].hash="#"+a}},j(d()))}var e,f,j,l,m={};return m.start=function(){if(!e){var f=d();j||c(),function k(){var c=d(),m=l(f);c!==f?(j(f=c,m),a(b).trigger(h)):m!==f&&(b[g][i]=b[g][i].replace(/#.*/,"")+"#"+m),e=setTimeout(k,a[h+"Delay"])}()}},m.stop=function(){f||(e&&clearTimeout(e),e=0)},m}()}(jQuery,this);var _canLog=!0,BROWSER=jQuery.browser||_checkBrowser(),getDynaTreePersistData=null,DTNodeStatus_Error=-1,DTNodeStatus_Loading=1,DTNodeStatus_Ok=0;!function($){function getDtNodeFromElement(a){return alert("getDtNodeFromElement is deprecated"),$.ui.dynatree.getNode(a)}function noop(){}function versionCompare(a,b){var c,d,e,f=(""+a).split("."),g=(""+b).split("."),h=Math.min(f.length,g.length);for(e=0;h>e;e++)if(c=parseInt(f[e],10),d=parseInt(g[e],10),isNaN(c)&&(c=f[e]),isNaN(d)&&(d=g[e]),c!=d)return c>d?1:d>c?-1:0/0;return f.length===g.length?0:f.length<g.length?-1:1}function _initDragAndDrop(a){var b=a.options.dnd||null;b&&(b.onDragStart||b.onDrop)&&_registerDnd(),b&&b.onDragStart&&a.$tree.draggable({addClasses:!1,appendTo:"body",containment:!1,delay:0,distance:4,revert:!1,scroll:!0,scrollSpeed:7,scrollSensitivity:10,connectToDynatree:!0,helper:function(a){var b=$.ui.dynatree.getNode(a.target);return b?b.tree._onDragEvent("helper",b,null,a,null,null):"<div></div>"},start:function(a,b){var c=b.helper.data("dtSourceNode");return!!c},_last:null}),b&&b.onDrop&&a.$tree.droppable({addClasses:!1,tolerance:"intersect",greedy:!1,_last:null})}var Class={create:function(){return function(){this.initialize.apply(this,arguments)}}},DynaTreeNode=Class.create();DynaTreeNode.prototype={initialize:function(a,b,c){this.parent=a,this.tree=b,"string"==typeof c&&(c={title:c}),c.key=c.key?""+c.key:"_"+b._nodeCount++,this.data=$.extend({},$.ui.dynatree.nodedatadefaults,c),this.li=null,this.span=null,this.ul=null,this.childList=null,this._isLoading=!1,this.hasSubSel=!1,this.bExpanded=!1,this.bSelected=!1},toString:function(){return"DynaTreeNode<"+this.data.key+">: '"+this.data.title+"'"},toDict:function(a,b){var c=$.extend({},this.data);if(c.activate=this.tree.activeNode===this,c.focus=this.tree.focusNode===this,c.expand=this.bExpanded,c.select=this.bSelected,b&&b(c),a&&this.childList){c.children=[];for(var d=0,e=this.childList.length;e>d;d++)c.children.push(this.childList[d].toDict(!0,b))}else delete c.children;return c},fromDict:function(a){var b=a.children;return void 0===b?(this.data=$.extend(this.data,a),this.render(),void 0):(a=$.extend({},a),a.children=void 0,this.data=$.extend(this.data,a),this.removeChildren(),this.addChild(b),void 0)},_getInnerHtml:function(){var a,b=this.tree,c=b.options,d=b.cache,e=this.getLevel(),f=this.data,g="";e<c.minExpandLevel?e>1&&(g+=d.tagConnector):g+=this.hasChildren()!==!1?d.tagExpander:d.tagConnector,c.checkbox&&f.hideCheckbox!==!0&&!f.isStatusNode&&(g+=d.tagCheckbox),f.icon?(a="/"===f.icon.charAt(0)?f.icon:c.imagePath+f.icon,g+="<img src='"+a+"' alt='' />"):f.icon===!1||(g+=f.iconClass?"<span class=' "+f.iconClass+"'></span>":d.tagNodeIcon);var h="";if(c.onCustomRender&&(h=c.onCustomRender.call(b,this)||""),!h){var i=f.tooltip?' title="'+f.tooltip.replace(/\"/g,"&quot;")+'"':"",j=f.href||"#";h=c.noLink||f.noLink?'<span style="display:inline-block;" class="'+c.classNames.title+'"'+i+">"+f.title+"</span>":'<a href="'+j+'" class="'+c.classNames.title+'"'+i+">"+f.title+"</a>"}return g+=h},_fixOrder:function(){var a=this.childList;if(a&&this.ul)for(var b=this.ul.firstChild,c=0,d=a.length-1;d>c;c++){var e=a[c],f=b.dtnode;e!==f?(this.tree.logDebug("_fixOrder: mismatch at index "+c+": "+e+" != "+f),this.ul.insertBefore(e.li,f.li)):b=b.nextSibling}},render:function(a,b){var c=this.tree,d=this.parent,e=this.data,f=c.options,g=f.classNames,h=this.isLastSibling(),i=!1;if(d||this.ul){if(d){this.li||(i=!0,this.li=document.createElement("li"),this.li.dtnode=this,e.key&&f.generateIds&&(this.li.id=f.idPrefix+e.key),this.span=document.createElement("span"),this.span.className=g.title,this.li.appendChild(this.span),d.ul||(d.ul=document.createElement("ul"),d.ul.style.display="none",d.li.appendChild(d.ul)),d.ul.appendChild(this.li)),this.span.innerHTML=this._getInnerHtml();var j=[];j.push(g.node),e.isFolder&&j.push(g.folder),this.bExpanded&&j.push(g.expanded),this.hasChildren()!==!1&&j.push(g.hasChildren),e.isLazy&&null===this.childList&&j.push(g.lazy),h&&j.push(g.lastsib),this.bSelected&&j.push(g.selected),this.hasSubSel&&j.push(g.partsel),c.activeNode===this&&j.push(g.active),e.addClass&&j.push(e.addClass),j.push(g.combinedExpanderPrefix+(this.bExpanded?"e":"c")+(e.isLazy&&null===this.childList?"d":"")+(h?"l":"")),j.push(g.combinedIconPrefix+(this.bExpanded?"e":"c")+(e.isFolder?"f":"")),this.span.className=j.join(" "),this.li.className=h?g.lastsib:"",i&&f.onCreate&&f.onCreate.call(c,this,this.span),f.onRender&&f.onRender.call(c,this,this.span)}}else this.li=this.span=null,this.ul=document.createElement("ul"),this.ul.className=f.minExpandLevel>1?g.container+" "+g.noConnector:g.container;if((this.bExpanded||b===!0)&&this.childList){for(var k=0,l=this.childList.length;l>k;k++)this.childList[k].render(!1,b);this._fixOrder()}if(this.ul){var m="none"===this.ul.style.display,n=!!this.bExpanded;if(a&&f.fx&&m===n){var o=f.fx.duration||200;$(this.ul).animate(f.fx,o)}else this.ul.style.display=this.bExpanded||!d?"":"none"}},getKeyPath:function(a){var b=[];return this.visitParents(function(a){a.parent&&b.unshift(a.data.key)},!a),"/"+b.join(this.tree.options.keyPathSeparator)},getParent:function(){return this.parent},getChildren:function(){return void 0===this.hasChildren()?void 0:this.childList},hasChildren:function(){return this.data.isLazy?null===this.childList||void 0===this.childList?void 0:0===this.childList.length?!1:1===this.childList.length&&this.childList[0].isStatusNode()?void 0:!0:!!this.childList},isFirstSibling:function(){var a=this.parent;return!a||a.childList[0]===this},isLastSibling:function(){var a=this.parent;return!a||a.childList[a.childList.length-1]===this},isLoading:function(){return!!this._isLoading},getPrevSibling:function(){if(!this.parent)return null;for(var a=this.parent.childList,b=1,c=a.length;c>b;b++)if(a[b]===this)return a[b-1];return null},getNextSibling:function(){if(!this.parent)return null;for(var a=this.parent.childList,b=0,c=a.length-1;c>b;b++)if(a[b]===this)return a[b+1];return null},isStatusNode:function(){return this.data.isStatusNode===!0},isChildOf:function(a){return this.parent&&this.parent===a},isDescendantOf:function(a){if(!a)return!1;for(var b=this.parent;b;){if(b===a)return!0;b=b.parent}return!1},countChildren:function(){var a=this.childList;if(!a)return 0;for(var b=a.length,c=0,d=b;d>c;c++){var e=a[c];b+=e.countChildren()}return b},sortChildren:function(a,b){var c=this.childList;if(c){if(a=a||function(a,b){var c=a.data.title.toLowerCase(),d=b.data.title.toLowerCase();return c===d?0:c>d?1:-1},c.sort(a),b)for(var d=0,e=c.length;e>d;d++)c[d].childList&&c[d].sortChildren(a,"$norender$");"$norender$"!==b&&this.render()}},_setStatusNode:function(a){var b=this.childList?this.childList[0]:null;if(a)b?(a.isStatusNode=!0,a.key="_statusNode",b.data=a,b.render()):(a.isStatusNode=!0,a.key="_statusNode",b=this.addChild(a));else if(b&&b.isStatusNode()){try{this.ul&&(this.ul.removeChild(b.li),b.li=null)}catch(c){}1===this.childList.length?this.childList=[]:this.childList.shift()}},setLazyNodeStatus:function(a,b){var c=b&&b.tooltip?b.tooltip:null,d=b&&b.info?" ("+b.info+")":"";switch(a){case DTNodeStatus_Ok:this._setStatusNode(null),$(this.span).removeClass(this.tree.options.classNames.nodeLoading),this._isLoading=!1,this.tree.options.autoFocus&&(this===this.tree.tnRoot&&this.childList&&this.childList.length>0?this.childList[0].focus():this.focus());break;case DTNodeStatus_Loading:this._isLoading=!0,$(this.span).addClass(this.tree.options.classNames.nodeLoading),this.parent||this._setStatusNode({title:this.tree.options.strings.loading+d,tooltip:c,addClass:this.tree.options.classNames.nodeWait});break;case DTNodeStatus_Error:this._isLoading=!1,this._setStatusNode({title:this.tree.options.strings.loadError+d,tooltip:c,addClass:this.tree.options.classNames.nodeError});break;default:throw"Bad LazyNodeStatus: '"+a+"'."}},_parentList:function(a,b){for(var c=[],d=b?this:this.parent;d;)(a||d.parent)&&c.unshift(d),d=d.parent;return c},getLevel:function(){for(var a=0,b=this.parent;b;)a++,b=b.parent;return a},_getTypeForOuterNodeEvent:function(a){var b=this.tree.options.classNames,c=a.target;if(c.className.indexOf(b.node)<0)return null;for(var d=a.pageX-c.offsetLeft,e=a.pageY-c.offsetTop,f=0,g=c.childNodes.length;g>f;f++){var h=c.childNodes[f],i=h.offsetLeft-c.offsetLeft,j=h.offsetTop-c.offsetTop,k=h.clientWidth,l=h.clientHeight;
if(d>=i&&i+k>=d&&e>=j&&j+l>=e){if(h.className==b.title)return"title";if(h.className==b.expander)return"expander";if(h.className==b.checkbox)return"checkbox";if(h.className==b.nodeIcon)return"icon"}}return"prefix"},getEventTargetType:function(a){var b=a&&a.target?a.target.className:"",c=this.tree.options.classNames;return b===c.title?"title":b===c.expander?"expander":b===c.checkbox?"checkbox":b===c.nodeIcon?"icon":b===c.empty||b===c.vline||b===c.connector?"prefix":b.indexOf(c.node)>=0?this._getTypeForOuterNodeEvent(a):null},isVisible:function(){for(var a=this._parentList(!0,!1),b=0,c=a.length;c>b;b++)if(!a[b].bExpanded)return!1;return!0},makeVisible:function(){for(var a=this._parentList(!0,!1),b=0,c=a.length;c>b;b++)a[b]._expand(!0)},focus:function(){this.makeVisible();try{$(this.span).find(">a").focus()}catch(a){}},isFocused:function(){return this.tree.tnFocused===this},_activate:function(a,b){this.tree.logDebug("dtnode._activate(%o, fireEvents=%o) - %o",a,b,this);var c=this.tree.options;if(!(this.data.isStatusNode||b&&c.onQueryActivate&&c.onQueryActivate.call(this.tree,a,this)===!1))if(a){if(this.tree.activeNode){if(this.tree.activeNode===this)return;this.tree.activeNode.deactivate()}c.activeVisible&&this.makeVisible(),this.tree.activeNode=this,c.persist&&$.cookie(c.cookieId+"-active",this.data.key,c.cookie),this.tree.persistence.activeKey=this.data.key,$(this.span).addClass(c.classNames.active),b&&c.onActivate&&c.onActivate.call(this.tree,this)}else if(this.tree.activeNode===this){if(c.onQueryActivate&&c.onQueryActivate.call(this.tree,!1,this)===!1)return;$(this.span).removeClass(c.classNames.active),c.persist&&$.cookie(c.cookieId+"-active","",c.cookie),this.tree.persistence.activeKey=null,this.tree.activeNode=null,b&&c.onDeactivate&&c.onDeactivate.call(this.tree,this)}},activate:function(){this._activate(!0,!0)},activateSilently:function(){this._activate(!0,!1)},deactivate:function(){this._activate(!1,!0)},isActive:function(){return this.tree.activeNode===this},_userActivate:function(){var a=!0,b=!1;if(this.data.isFolder)switch(this.tree.options.clickFolderMode){case 2:a=!1,b=!0;break;case 3:a=b=!0}null===this.parent&&(b=!1),b&&(this.toggleExpand(),this.focus()),a&&this.activate()},_setSubSel:function(a){a?(this.hasSubSel=!0,$(this.span).addClass(this.tree.options.classNames.partsel)):(this.hasSubSel=!1,$(this.span).removeClass(this.tree.options.classNames.partsel))},_updatePartSelectionState:function(){var a;if(!this.hasChildren())return a=this.bSelected&&!this.data.unselectable&&!this.data.isStatusNode,this._setSubSel(!1),a;var b,c,d=this.childList,e=!0,f=!0;for(b=0,c=d.length;c>b;b++){var g=d[b],h=g._updatePartSelectionState();h!==!1&&(f=!1),h!==!0&&(e=!1)}return a=e?!0:f?!1:void 0,this._setSubSel(void 0===a),this.bSelected=a===!0,a},_fixSelectionState:function(){var a,b,c;if(this.bSelected)for(this.visit(function(a){a.parent._setSubSel(!0),a.data.unselectable||a._select(!0,!1,!1)}),a=this.parent;a;){a._setSubSel(!0);var d=!0;for(b=0,c=a.childList.length;c>b;b++){var e=a.childList[b];if(!e.bSelected&&!e.data.isStatusNode&&!e.data.unselectable){d=!1;break}}d&&a._select(!0,!1,!1),a=a.parent}else for(this._setSubSel(!1),this.visit(function(a){a._setSubSel(!1),a._select(!1,!1,!1)}),a=this.parent;a;){a._select(!1,!1,!1);var f=!1;for(b=0,c=a.childList.length;c>b;b++)if(a.childList[b].bSelected||a.childList[b].hasSubSel){f=!0;break}a._setSubSel(f),a=a.parent}},_select:function(a,b,c){var d=this.tree.options;this.data.isStatusNode||this.bSelected!==a&&(b&&d.onQuerySelect&&d.onQuerySelect.call(this.tree,a,this)===!1||(1==d.selectMode&&a&&this.tree.visit(function(a){return a.bSelected?(a._select(!1,!1,!1),!1):void 0}),this.bSelected=a,a?(d.persist&&this.tree.persistence.addSelect(this.data.key),$(this.span).addClass(d.classNames.selected),c&&3===d.selectMode&&this._fixSelectionState(),b&&d.onSelect&&d.onSelect.call(this.tree,!0,this)):(d.persist&&this.tree.persistence.clearSelect(this.data.key),$(this.span).removeClass(d.classNames.selected),c&&3===d.selectMode&&this._fixSelectionState(),b&&d.onSelect&&d.onSelect.call(this.tree,!1,this))))},select:function(a){return this.data.unselectable?this.bSelected:this._select(a!==!1,!0,!0)},toggleSelect:function(){return this.select(!this.bSelected)},isSelected:function(){return this.bSelected},isLazy:function(){return!!this.data.isLazy},_loadContent:function(){try{var a=this.tree.options;this.tree.logDebug("_loadContent: start - %o",this),this.setLazyNodeStatus(DTNodeStatus_Loading),!0===a.onLazyRead.call(this.tree,this)&&(this.setLazyNodeStatus(DTNodeStatus_Ok),this.tree.logDebug("_loadContent: succeeded - %o",this))}catch(b){this.tree.logWarning("_loadContent: failed - %o",b),this.setLazyNodeStatus(DTNodeStatus_Error,{tooltip:""+b})}},_expand:function(a,b){if(this.bExpanded===a)return this.tree.logDebug("dtnode._expand(%o) IGNORED - %o",a,this),void 0;this.tree.logDebug("dtnode._expand(%o) - %o",a,this);var c=this.tree.options;if(!a&&this.getLevel()<c.minExpandLevel)return this.tree.logDebug("dtnode._expand(%o) prevented collapse - %o",a,this),void 0;if(!c.onQueryExpand||c.onQueryExpand.call(this.tree,a,this)!==!1){this.bExpanded=a,c.persist&&(a?this.tree.persistence.addExpand(this.data.key):this.tree.persistence.clearExpand(this.data.key));var d=!(this.data.isLazy&&null===this.childList||this._isLoading||b);if(this.render(d),this.bExpanded&&this.parent&&c.autoCollapse)for(var e=this._parentList(!1,!0),f=0,g=e.length;g>f;f++)e[f].collapseSiblings();return c.activeVisible&&this.tree.activeNode&&!this.tree.activeNode.isVisible()&&this.tree.activeNode.deactivate(),a&&this.data.isLazy&&null===this.childList&&!this._isLoading?(this._loadContent(),void 0):(c.onExpand&&c.onExpand.call(this.tree,a,this),void 0)}},isExpanded:function(){return this.bExpanded},expand:function(a){a=a!==!1,(this.childList||this.data.isLazy||!a)&&(null!==this.parent||a)&&this._expand(a)},scheduleAction:function(a,b){this.tree.timer&&(clearTimeout(this.tree.timer),this.tree.logDebug("clearTimeout(%o)",this.tree.timer));var c=this;switch(a){case"cancel":break;case"expand":this.tree.timer=setTimeout(function(){c.tree.logDebug("setTimeout: trigger expand"),c.expand(!0)},b);break;case"activate":this.tree.timer=setTimeout(function(){c.tree.logDebug("setTimeout: trigger activate"),c.activate()},b);break;default:throw"Invalid mode "+a}this.tree.logDebug("setTimeout(%s, %s): %s",a,b,this.tree.timer)},toggleExpand:function(){this.expand(!this.bExpanded)},collapseSiblings:function(){if(null!==this.parent)for(var a=this.parent.childList,b=0,c=a.length;c>b;b++)a[b]!==this&&a[b].bExpanded&&a[b]._expand(!1)},_onClick:function(a){var b=this.getEventTargetType(a);if("expander"===b)this.toggleExpand(),this.focus();else if("checkbox"===b)this.toggleSelect(),this.focus();else{this._userActivate();var c=this.span.getElementsByTagName("a");if(!c[0])return!0;BROWSER.msie&&parseInt(BROWSER.version,10)<9||c[0].focus()}a.preventDefault()},_onDblClick:function(){},_onKeydown:function(a){var b,c=!0;switch(a.which){case 107:case 187:this.bExpanded||this.toggleExpand();break;case 109:case 189:this.bExpanded&&this.toggleExpand();break;case 32:this._userActivate();break;case 8:this.parent&&this.parent.focus();break;case 37:this.bExpanded?(this.toggleExpand(),this.focus()):this.parent&&this.parent.parent&&this.parent.focus();break;case 39:this.bExpanded||!this.childList&&!this.data.isLazy?this.childList&&this.childList[0].focus():(this.toggleExpand(),this.focus());break;case 38:for(b=this.getPrevSibling();b&&b.bExpanded&&b.childList;)b=b.childList[b.childList.length-1];!b&&this.parent&&this.parent.parent&&(b=this.parent),b&&b.focus();break;case 40:if(this.bExpanded&&this.childList)b=this.childList[0];else for(var d=this._parentList(!1,!0),e=d.length-1;e>=0&&!(b=d[e].getNextSibling());e--);b&&b.focus();break;default:c=!1}c&&a.preventDefault()},_onKeypress:function(){},_onFocus:function(a){var b=this.tree.options;"blur"==a.type||"focusout"==a.type?(b.onBlur&&b.onBlur.call(this.tree,this),this.tree.tnFocused&&$(this.tree.tnFocused.span).removeClass(b.classNames.focused),this.tree.tnFocused=null,b.persist&&$.cookie(b.cookieId+"-focus","",b.cookie)):("focus"==a.type||"focusin"==a.type)&&(this.tree.tnFocused&&this.tree.tnFocused!==this&&(this.tree.logDebug("dtnode.onFocus: out of sync: curFocus: %o",this.tree.tnFocused),$(this.tree.tnFocused.span).removeClass(b.classNames.focused)),this.tree.tnFocused=this,b.onFocus&&b.onFocus.call(this.tree,this),$(this.tree.tnFocused.span).addClass(b.classNames.focused),b.persist&&$.cookie(b.cookieId+"-focus",this.data.key,b.cookie))},visit:function(a,b){var c=!0;if(b===!0&&(c=a(this),c===!1||"skip"==c))return c;if(this.childList)for(var d=0,e=this.childList.length;e>d&&(c=this.childList[d].visit(a,!0),c!==!1);d++);return c},visitParents:function(a,b){if(b&&a(this)===!1)return!1;for(var c=this.parent;c;){if(a(c)===!1)return!1;c=c.parent}return!0},remove:function(){if(this===this.tree.root)throw"Cannot remove system root";return this.parent.removeChild(this)},removeChild:function(a){var b=this.childList;if(1==b.length){if(a!==b[0])throw"removeChild: invalid child";return this.removeChildren()}a===this.tree.activeNode&&a.deactivate(),this.tree.options.persist&&(a.bSelected&&this.tree.persistence.clearSelect(a.data.key),a.bExpanded&&this.tree.persistence.clearExpand(a.data.key)),a.removeChildren(!0),this.ul&&this.ul.removeChild(a.li);for(var c=0,d=b.length;d>c;c++)if(b[c]===a){this.childList.splice(c,1);break}},removeChildren:function(a,b){this.tree.logDebug("%s.removeChildren(%o)",this,a);var c=this.tree,d=this.childList;if(d){for(var e=0,f=d.length;f>e;e++){var g=d[e];g!==c.activeNode||b||g.deactivate(),this.tree.options.persist&&!b&&(g.bSelected&&this.tree.persistence.clearSelect(g.data.key),g.bExpanded&&this.tree.persistence.clearExpand(g.data.key)),g.removeChildren(!0,b),this.ul&&$("li",$(this.ul)).remove()}this.childList=null}a||(this._isLoading=!1,this.render())},setTitle:function(a){this.fromDict({title:a})},reload:function(){throw"Use reloadChildren() instead"},reloadChildren:function(a){if(null===this.parent)throw"Use tree.reload() instead";if(!this.data.isLazy)throw"node.reloadChildren() requires lazy nodes.";if(a){var b=this,c="nodeLoaded.dynatree."+this.tree.$tree.attr("id")+"."+this.data.key;this.tree.$tree.bind(c,function(d,e,f){if(b.tree.$tree.unbind(c),b.tree.logDebug("loaded %o, %o, %o",d,e,f),e!==b)throw"got invalid load event";a.call(b.tree,e,f)})}this.removeChildren(),this._loadContent()},_loadKeyPath:function(a,b){var c=this.tree;if(c.logDebug("%s._loadKeyPath(%s)",this,a),""===a)throw"Key path must not be empty";var d=a.split(c.options.keyPathSeparator);if(""===d[0])throw"Key path must be relative (don't start with '/')";var e=d.shift();if(this.childList)for(var f=0,g=this.childList.length;g>f;f++){var h=this.childList[f];if(h.data.key===e){if(0===d.length)b.call(c,h,"ok");else if(!h.data.isLazy||null!==h.childList&&void 0!==h.childList)b.call(c,h,"loaded"),h._loadKeyPath(d.join(c.options.keyPathSeparator),b);else{c.logDebug("%s._loadKeyPath(%s) -> reloading %s...",this,a,h);var i=this;h.reloadChildren(function(e,f){f?(c.logDebug("%s._loadKeyPath(%s) -> reloaded %s.",e,a,e),b.call(c,h,"loaded"),e._loadKeyPath(d.join(c.options.keyPathSeparator),b)):(c.logWarning("%s._loadKeyPath(%s) -> reloadChildren() failed.",i,a),b.call(c,h,"error"))})}return}}b.call(c,void 0,"notfound",e,0===d.length),c.logWarning("Node not found: "+e)},resetLazy:function(){if(null===this.parent)throw"Use tree.reload() instead";if(!this.data.isLazy)throw"node.resetLazy() requires lazy nodes.";this.expand(!1),this.removeChildren()},_addChildNode:function(a,b){var c=this.tree,d=c.options,e=c.persistence;if(a.parent=this,null===this.childList?this.childList=[]:b||this.childList.length>0&&$(this.childList[this.childList.length-1].span).removeClass(d.classNames.lastsib),b){var f=$.inArray(b,this.childList);if(0>f)throw"<beforeNode> must be a child of <this>";this.childList.splice(f,0,a)}else this.childList.push(a);var g=c.isInitializing();if(d.persist&&e.cookiesFound&&g?(e.activeKey===a.data.key&&(c.activeNode=a),e.focusedKey===a.data.key&&(c.focusNode=a),a.bExpanded=$.inArray(a.data.key,e.expandedKeyList)>=0,a.bSelected=$.inArray(a.data.key,e.selectedKeyList)>=0):(a.data.activate&&(c.activeNode=a,d.persist&&(e.activeKey=a.data.key)),a.data.focus&&(c.focusNode=a,d.persist&&(e.focusedKey=a.data.key)),a.bExpanded=a.data.expand===!0,a.bExpanded&&d.persist&&e.addExpand(a.data.key),a.bSelected=a.data.select===!0,a.bSelected&&d.persist&&e.addSelect(a.data.key)),d.minExpandLevel>=a.getLevel()&&(this.bExpanded=!0),a.bSelected&&3==d.selectMode)for(var h=this;h;)h.hasSubSel||h._setSubSel(!0),h=h.parent;return c.bEnableUpdate&&this.render(),a},addChild:function(a,b){if("string"==typeof a)throw"Invalid data type for "+a;if(a&&0!==a.length){if(a instanceof DynaTreeNode)return this._addChildNode(a,b);a.length||(a=[a]);for(var c=this.tree.enableUpdate(!1),d=null,e=0,f=a.length;f>e;e++){var g=a[e],h=this._addChildNode(new DynaTreeNode(this,this.tree,g),b);d||(d=h),g.children&&h.addChild(g.children,null)}return this.tree.enableUpdate(c),d}},append:function(a){return this.tree.logWarning("node.append() is deprecated (use node.addChild() instead)."),this.addChild(a,null)},appendAjax:function(a){var b=this;if(this.removeChildren(!1,!0),this.setLazyNodeStatus(DTNodeStatus_Loading),a.debugLazyDelay){var c=a.debugLazyDelay;return a.debugLazyDelay=0,this.tree.logInfo("appendAjax: waiting for debugLazyDelay "+c),setTimeout(function(){b.appendAjax(a)},c),void 0}var d=a.success,e=a.error,f="nodeLoaded.dynatree."+this.tree.$tree.attr("id")+"."+this.data.key,g=$.extend({},this.tree.options.ajaxDefaults,a,{success:function(a,c){var e=b.tree.phase;b.tree.phase="init",g.postProcess?a=g.postProcess.call(this,a,this.dataType):a&&a.hasOwnProperty("d")&&(a="string"==typeof a.d?$.parseJSON(a.d):a.d),$.isArray(a)&&0===a.length||b.addChild(a,null),b.tree.phase="postInit",d&&d.call(g,b,a,c),b.tree.logDebug("trigger "+f),b.tree.$tree.trigger(f,[b,!0]),b.tree.phase=e,b.setLazyNodeStatus(DTNodeStatus_Ok),$.isArray(a)&&0===a.length&&(b.childList=[],b.render())},error:function(a,c,d){b.tree.logWarning("appendAjax failed:",c,":\n",a,"\n",d),e&&e.call(g,b,a,c,d),b.tree.$tree.trigger(f,[b,!1]),b.setLazyNodeStatus(DTNodeStatus_Error,{info:c,tooltip:""+d})}});$.ajax(g)},move:function(a,b){var c;if(this!==a){if(!this.parent)throw"Cannot move system root";(void 0===b||"over"==b)&&(b="child");var d=this.parent,e="child"===b?a:a.parent;if(e.isDescendantOf(this))throw"Cannot move a node to it's own descendant";if(1==this.parent.childList.length)this.parent.childList=this.parent.data.isLazy?[]:null,this.parent.bExpanded=!1;else{if(c=$.inArray(this,this.parent.childList),0>c)throw"Internal error";this.parent.childList.splice(c,1)}if(this.parent.ul&&this.parent.ul.removeChild(this.li),this.parent=e,e.hasChildren())switch(b){case"child":e.childList.push(this);break;case"before":if(c=$.inArray(a,e.childList),0>c)throw"Internal error";e.childList.splice(c,0,this);break;case"after":if(c=$.inArray(a,e.childList),0>c)throw"Internal error";e.childList.splice(c+1,0,this);break;default:throw"Invalid mode "+b}else e.childList=[this];if(e.ul||(e.ul=document.createElement("ul"),e.ul.style.display="none",e.li.appendChild(e.ul)),this.li&&e.ul.appendChild(this.li),this.tree!==a.tree)throw this.visit(function(b){b.tree=a.tree},null,!0),"Not yet implemented.";d.isDescendantOf(e)||d.render(),e.isDescendantOf(d)||e.render()}},lastentry:void 0};var DynaTreeStatus=Class.create();DynaTreeStatus._getTreePersistData=function(a,b){var c=new DynaTreeStatus(a,b);return c.read(),c.toDict()},getDynaTreePersistData=DynaTreeStatus._getTreePersistData,DynaTreeStatus.prototype={initialize:function(a,b){void 0===a&&(a=$.ui.dynatree.prototype.options.cookieId),b=$.extend({},$.ui.dynatree.prototype.options.cookie,b),this.cookieId=a,this.cookieOpts=b,this.cookiesFound=void 0,this.activeKey=null,this.focusedKey=null,this.expandedKeyList=null,this.selectedKeyList=null},_log:function(){Array.prototype.unshift.apply(arguments,["debug"]),_log.apply(this,arguments)},read:function(){this.cookiesFound=!1;var a=$.cookie(this.cookieId+"-active");this.activeKey=null===a?"":a,null!==a&&(this.cookiesFound=!0),a=$.cookie(this.cookieId+"-focus"),this.focusedKey=null===a?"":a,null!==a&&(this.cookiesFound=!0),a=$.cookie(this.cookieId+"-expand"),this.expandedKeyList=null===a?[]:a.split(","),null!==a&&(this.cookiesFound=!0),a=$.cookie(this.cookieId+"-select"),this.selectedKeyList=null===a?[]:a.split(","),null!==a&&(this.cookiesFound=!0)},write:function(){$.cookie(this.cookieId+"-active",null===this.activeKey?"":this.activeKey,this.cookieOpts),$.cookie(this.cookieId+"-focus",null===this.focusedKey?"":this.focusedKey,this.cookieOpts),$.cookie(this.cookieId+"-expand",null===this.expandedKeyList?"":this.expandedKeyList.join(","),this.cookieOpts),$.cookie(this.cookieId+"-select",null===this.selectedKeyList?"":this.selectedKeyList.join(","),this.cookieOpts)},addExpand:function(a){$.inArray(a,this.expandedKeyList)<0&&(this.expandedKeyList.push(a),$.cookie(this.cookieId+"-expand",this.expandedKeyList.join(","),this.cookieOpts))},clearExpand:function(a){var b=$.inArray(a,this.expandedKeyList);b>=0&&(this.expandedKeyList.splice(b,1),$.cookie(this.cookieId+"-expand",this.expandedKeyList.join(","),this.cookieOpts))},addSelect:function(a){$.inArray(a,this.selectedKeyList)<0&&(this.selectedKeyList.push(a),$.cookie(this.cookieId+"-select",this.selectedKeyList.join(","),this.cookieOpts))},clearSelect:function(a){var b=$.inArray(a,this.selectedKeyList);b>=0&&(this.selectedKeyList.splice(b,1),$.cookie(this.cookieId+"-select",this.selectedKeyList.join(","),this.cookieOpts))},isReloading:function(){return this.cookiesFound===!0},toDict:function(){return{cookiesFound:this.cookiesFound,activeKey:this.activeKey,focusedKey:this.activeKey,expandedKeyList:this.expandedKeyList,selectedKeyList:this.selectedKeyList}},lastentry:void 0};var DynaTree=Class.create();DynaTree.version="$Version:$",DynaTree.prototype={initialize:function(a){this.phase="init",this.$widget=a,this.options=a.options,this.$tree=a.element,this.timer=null,this.divTree=this.$tree.get(0),_initDragAndDrop(this)},_load:function(a){this.$widget;var b=this.options,c=this;this.bEnableUpdate=!0,this._nodeCount=1,this.activeNode=null,this.focusNode=null,void 0!==b.rootVisible&&this.logWarning("Option 'rootVisible' is no longer supported."),b.minExpandLevel<1&&(this.logWarning("Option 'minExpandLevel' must be >= 1."),b.minExpandLevel=1),b.classNames!==$.ui.dynatree.prototype.options.classNames&&(b.classNames=$.extend({},$.ui.dynatree.prototype.options.classNames,b.classNames)),b.ajaxDefaults!==$.ui.dynatree.prototype.options.ajaxDefaults&&(b.ajaxDefaults=$.extend({},$.ui.dynatree.prototype.options.ajaxDefaults,b.ajaxDefaults)),b.dnd!==$.ui.dynatree.prototype.options.dnd&&(b.dnd=$.extend({},$.ui.dynatree.prototype.options.dnd,b.dnd)),b.imagePath||$("script").each(function(){var a=/.*dynatree[^\/]*\.js$/i;return this.src.search(a)>=0?(b.imagePath=this.src.indexOf("/")>=0?this.src.slice(0,this.src.lastIndexOf("/"))+"/skin/":"skin/",c.logDebug("Guessing imagePath from '%s': '%s'",this.src,b.imagePath),!1):void 0}),this.persistence=new DynaTreeStatus(b.cookieId,b.cookie),b.persist&&($.cookie||_log("warn","Please include jquery.cookie.js to use persistence."),this.persistence.read()),this.logDebug("DynaTree.persistence: %o",this.persistence.toDict()),this.cache={tagEmpty:"<span class='"+b.classNames.empty+"'></span>",tagVline:"<span class='"+b.classNames.vline+"'></span>",tagExpander:"<span class='"+b.classNames.expander+"'></span>",tagConnector:"<span class='"+b.classNames.connector+"'></span>",tagNodeIcon:"<span class='"+b.classNames.nodeIcon+"'></span>",tagCheckbox:"<span class='"+b.classNames.checkbox+"'></span>",lastentry:void 0},(b.children||b.initAjax&&b.initAjax.url||b.initId)&&$(this.divTree).empty();var d=this.$tree.find(">ul:first").hide();this.tnRoot=new DynaTreeNode(null,this,{}),this.tnRoot.bExpanded=!0,this.tnRoot.render(),this.divTree.appendChild(this.tnRoot.ul);var e=this.tnRoot,f=b.persist&&this.persistence.isReloading(),g=!1,h=this.enableUpdate(!1);this.logDebug("Dynatree._load(): read tree structure..."),b.children?e.addChild(b.children):b.initAjax&&b.initAjax.url?(g=!0,e.data.isLazy=!0,this._reloadAjax(a)):b.initId?this._createFromTag(e,$("#"+b.initId)):(this._createFromTag(e,d),d.remove()),this._checkConsistency(),g||3!=b.selectMode||e._updatePartSelectionState(),this.logDebug("Dynatree._load(): render nodes..."),this.enableUpdate(h),this.logDebug("Dynatree._load(): bind events..."),this.$widget.bind(),this.logDebug("Dynatree._load(): postInit..."),this.phase="postInit",b.persist&&this.persistence.write(),this.focusNode&&this.focusNode.isVisible()&&(this.logDebug("Focus on init: %o",this.focusNode),this.focusNode.focus()),g||(b.onPostInit&&b.onPostInit.call(this,f,!1),a&&a.call(this,"ok")),this.phase="idle"},_reloadAjax:function(a){var b=this.options;if(!b.initAjax||!b.initAjax.url)throw"tree.reload() requires 'initAjax' mode.";var c=this.persistence,d=$.extend({},b.initAjax);d.addActiveKey&&(d.data.activeKey=c.activeKey),d.addFocusedKey&&(d.data.focusedKey=c.focusedKey),d.addExpandedKeyList&&(d.data.expandedKeyList=c.expandedKeyList.join(",")),d.addSelectedKeyList&&(d.data.selectedKeyList=c.selectedKeyList.join(",")),d.success&&this.logWarning("initAjax: success callback is ignored; use onPostInit instead."),d.error&&this.logWarning("initAjax: error callback is ignored; use onPostInit instead.");var e=c.isReloading();d.success=function(c){3==b.selectMode&&c.tree.tnRoot._updatePartSelectionState(),b.onPostInit&&b.onPostInit.call(c.tree,e,!1),a&&a.call(c.tree,"ok")},d.error=function(c,d,f,g){b.onPostInit&&b.onPostInit.call(c.tree,e,!0,d,f,g),a&&a.call(c.tree,"error",d,f,g)},this.logDebug("Dynatree._init(): send Ajax request..."),this.tnRoot.appendAjax(d)},toString:function(){return"Dynatree '"+this.$tree.attr("id")+"'"},toDict:function(){return this.tnRoot.toDict(!0)},serializeArray:function(a){for(var b=this.getSelectedNodes(a),c=this.$tree.attr("name")||this.$tree.attr("id"),d=[],e=0,f=b.length;f>e;e++)d.push({name:c,value:b[e].data.key});return d},getPersistData:function(){return this.persistence.toDict()},logDebug:function(){this.options.debugLevel>=2&&(Array.prototype.unshift.apply(arguments,["debug"]),_log.apply(this,arguments))},logInfo:function(){this.options.debugLevel>=1&&(Array.prototype.unshift.apply(arguments,["info"]),_log.apply(this,arguments))},logWarning:function(){Array.prototype.unshift.apply(arguments,["warn"]),_log.apply(this,arguments)},isInitializing:function(){return"init"==this.phase||"postInit"==this.phase},isReloading:function(){return("init"==this.phase||"postInit"==this.phase)&&this.options.persist&&this.persistence.cookiesFound},isUserEvent:function(){return"userEvent"==this.phase},redraw:function(){this.tnRoot.render(!1,!1)},renderInvisibleNodes:function(){this.tnRoot.render(!1,!0)},reload:function(a){this._load(a)},getRoot:function(){return this.tnRoot},enable:function(){this.$widget.enable()},disable:function(){this.$widget.disable()},getNodeByKey:function(a){var b=document.getElementById(this.options.idPrefix+a);if(b)return b.dtnode?b.dtnode:null;var c=null;return this.visit(function(b){return b.data.key===a?(c=b,!1):void 0},!0),c},getActiveNode:function(){return this.activeNode},reactivate:function(a){var b=this.activeNode;b&&(this.activeNode=null,b.activate(),a&&b.focus())},getSelectedNodes:function(a){var b=[];return this.tnRoot.visit(function(c){return c.bSelected&&(b.push(c),a===!0)?"skip":void 0}),b},activateKey:function(a){var b=null===a?null:this.getNodeByKey(a);return b?(b.focus(),b.activate(),b):(this.activeNode&&this.activeNode.deactivate(),this.activeNode=null,null)},loadKeyPath:function(a,b){var c=a.split(this.options.keyPathSeparator);return""===c[0]&&c.shift(),c[0]==this.tnRoot.data.key&&(this.logDebug("Removed leading root key."),c.shift()),a=c.join(this.options.keyPathSeparator),this.tnRoot._loadKeyPath(a,b)},selectKey:function(a,b){var c=this.getNodeByKey(a);return c?(c.select(b),c):null},enableUpdate:function(a){return this.bEnableUpdate==a?a:(this.bEnableUpdate=a,a&&this.redraw(),!a)},count:function(){return this.tnRoot.countChildren()},visit:function(a,b){return this.tnRoot.visit(a,b)},_createFromTag:function(parentTreeNode,$ulParent){var self=this;$ulParent.find(">li").each(function(){var $li=$(this),$liSpan=$li.find(">span:first"),$liA=$li.find(">a:first"),title,href=null,target=null,tooltip;if($liSpan.length)title=$liSpan.html();else if($liA.length)title=$liA.html(),href=$liA.attr("href"),target=$liA.attr("target"),tooltip=$liA.attr("title");else{title=$li.html();var iPos=title.search(/<ul/i);title=iPos>=0?$.trim(title.substring(0,iPos)):$.trim(title)}var data={title:title,tooltip:tooltip,isFolder:$li.hasClass("folder"),isLazy:$li.hasClass("lazy"),expand:$li.hasClass("expanded"),select:$li.hasClass("selected"),activate:$li.hasClass("active"),focus:$li.hasClass("focused"),noLink:$li.hasClass("noLink")};if(href&&(data.href=href,data.target=target),$li.attr("title")&&(data.tooltip=$li.attr("title")),$li.attr("id")&&(data.key=""+$li.attr("id")),$li.attr("data")){var dataAttr=$.trim($li.attr("data"));if(dataAttr){"{"!=dataAttr.charAt(0)&&(dataAttr="{"+dataAttr+"}");try{$.extend(data,eval("("+dataAttr+")"))}catch(e){throw"Error parsing node data: "+e+"\ndata:\n'"+dataAttr+"'"}}}var childNode=parentTreeNode.addChild(data),$ul=$li.find(">ul:first");$ul.length&&self._createFromTag(childNode,$ul)})},_checkConsistency:function(){},_setDndStatus:function(a,b,c,d,e){var f=a?$(a.span):null,g=$(b.span);if(this.$dndMarker||(this.$dndMarker=$("<div id='dynatree-drop-marker'></div>").hide().css({"z-index":1e3}).prependTo($(this.divTree).parent())),"after"===d||"before"===d||"over"===d){var h="0 0";switch(d){case"before":this.$dndMarker.removeClass("dynatree-drop-after dynatree-drop-over"),this.$dndMarker.addClass("dynatree-drop-before"),h="0 -8";break;case"after":this.$dndMarker.removeClass("dynatree-drop-before dynatree-drop-over"),this.$dndMarker.addClass("dynatree-drop-after"),h="0 8";break;default:this.$dndMarker.removeClass("dynatree-drop-after dynatree-drop-before"),this.$dndMarker.addClass("dynatree-drop-over"),g.addClass("dynatree-drop-target"),h="8 0"}this.$dndMarker.show().position({my:"left top",at:"left top",of:g,offset:h})}else g.removeClass("dynatree-drop-target"),this.$dndMarker.hide();"after"===d?g.addClass("dynatree-drop-after"):g.removeClass("dynatree-drop-after"),"before"===d?g.addClass("dynatree-drop-before"):g.removeClass("dynatree-drop-before"),e===!0?(f&&f.addClass("dynatree-drop-accept"),g.addClass("dynatree-drop-accept"),c.addClass("dynatree-drop-accept")):(f&&f.removeClass("dynatree-drop-accept"),g.removeClass("dynatree-drop-accept"),c.removeClass("dynatree-drop-accept")),e===!1?(f&&f.addClass("dynatree-drop-reject"),g.addClass("dynatree-drop-reject"),c.addClass("dynatree-drop-reject")):(f&&f.removeClass("dynatree-drop-reject"),g.removeClass("dynatree-drop-reject"),c.removeClass("dynatree-drop-reject"))},_onDragEvent:function(a,b,c,d,e,f){var g,h,i=(this.options,this.options.dnd),j=null,k=$(b.span);switch(a){case"helper":var l=$("<div class='dynatree-drag-helper'><span class='dynatree-drag-helper-img' /></div>").append($(d.target).closest(".dynatree-title").clone());$("ul.dynatree-container",b.tree.divTree).append(l),l.data("dtSourceNode",b),j=l;break;case"start":b.isStatusNode()?j=!1:i.onDragStart&&(j=i.onDragStart(b)),j===!1?(this.logDebug("tree.onDragStart() cancelled"),e.helper.trigger("mouseup"),e.helper.hide()):k.addClass("dynatree-drag-source");break;case"enter":j=i.onDragEnter?i.onDragEnter(b,c):null,j=j?{over:j===!0||"over"===j||$.inArray("over",j)>=0,before:j===!0||"before"===j||$.inArray("before",j)>=0,after:j===!0||"after"===j||$.inArray("after",j)>=0}:!1,e.helper.data("enterResponse",j);break;case"over":if(h=e.helper.data("enterResponse"),g=null,h===!1);else if("string"==typeof h)g=h;else{var m=k.offset(),n={x:d.pageX-m.left,y:d.pageY-m.top},o={x:n.x/k.width(),y:n.y/k.height()};h.after&&o.y>.75?g="after":!h.over&&h.after&&o.y>.5?g="after":h.before&&o.y<=.25?g="before":!h.over&&h.before&&o.y<=.5?g="before":h.over&&(g="over"),i.preventVoidMoves&&(b===c?g=null:"before"===g&&c&&b===c.getNextSibling()?g=null:"after"===g&&c&&b===c.getPrevSibling()?g=null:"over"===g&&c&&c.parent===b&&c.isLastSibling()&&(g=null)),e.helper.data("hitMode",g)}"over"===g&&i.autoExpandMS&&b.hasChildren()!==!1&&!b.bExpanded&&b.scheduleAction("expand",i.autoExpandMS),g&&i.onDragOver&&(j=i.onDragOver(b,c,g),("over"===j||"before"===j||"after"===j)&&(g=j)),this._setDndStatus(c,b,e.helper,g,j!==!1&&null!==g);break;case"drop":var p=e.helper.hasClass("dynatree-drop-reject");g=e.helper.data("hitMode"),g&&i.onDrop&&!p&&i.onDrop(b,c,g,e,f);break;case"leave":b.scheduleAction("cancel"),e.helper.data("enterResponse",null),e.helper.data("hitMode",null),this._setDndStatus(c,b,e.helper,"out",void 0),i.onDragLeave&&i.onDragLeave(b,c);break;case"stop":k.removeClass("dynatree-drag-source"),i.onDragStop&&i.onDragStop(b);break;default:throw"Unsupported drag event: "+a}return j},cancelDrag:function(){var a=$.ui.ddmanager.current;a&&a.cancel()},lastentry:void 0},$.widget("ui.dynatree",{_init:function(){return versionCompare($.ui.version,"1.8")<0?(this.options.debugLevel>=0&&_log("warn","ui.dynatree._init() was called; you should upgrade to jquery.ui.core.js v1.8 or higher."),this._create()):(this.options.debugLevel>=2&&_log("debug","ui.dynatree._init() was called; no current default functionality."),void 0)},_create:function(){var a=this.options;a.debugLevel>=1&&logMsg("Dynatree._create(): version='%s', debugLevel=%o.",$.ui.dynatree.version,this.options.debugLevel),this.options.event+=".dynatree",this.element.get(0),this.tree=new DynaTree(this),this.tree._load(),this.tree.logDebug("Dynatree._init(): done.")},bind:function(){function a(a){a=$.event.fix(a||window.event);var b=$.ui.dynatree.getNode(a.target);return b?b._onFocus(a):!1}this.unbind();var b="click.dynatree dblclick.dynatree";this.options.keyboard&&(b+=" keypress.dynatree keydown.dynatree"),this.element.bind(b,function(a){var b=$.ui.dynatree.getNode(a.target);if(!b)return!0;var c=b.tree,d=c.options;c.logDebug("event(%s): dtnode: %s",a.type,b);var e=c.phase;c.phase="userEvent";try{switch(a.type){case"click":return d.onClick&&d.onClick.call(c,b,a)===!1?!1:b._onClick(a);case"dblclick":return d.onDblClick&&d.onDblClick.call(c,b,a)===!1?!1:b._onDblClick(a);case"keydown":return d.onKeydown&&d.onKeydown.call(c,b,a)===!1?!1:b._onKeydown(a);case"keypress":return d.onKeypress&&d.onKeypress.call(c,b,a)===!1?!1:b._onKeypress(a)}}catch(f){c.logWarning("bind(%o): dtnode: %o, error: %o",a,b,f)}finally{c.phase=e}});var c=this.tree.divTree;c.addEventListener?(c.addEventListener("focus",a,!0),c.addEventListener("blur",a,!0)):c.onfocusin=c.onfocusout=a},unbind:function(){this.element.unbind(".dynatree")},enable:function(){this.bind(),$.Widget.prototype.enable.apply(this,arguments)},disable:function(){this.unbind(),$.Widget.prototype.disable.apply(this,arguments)},getTree:function(){return this.tree},getRoot:function(){return this.tree.getRoot()},getActiveNode:function(){return this.tree.getActiveNode()},getSelectedNodes:function(){return this.tree.getSelectedNodes()},lastentry:void 0}),versionCompare($.ui.version,"1.8")<0&&($.ui.dynatree.getter="getTree getRoot getActiveNode getSelectedNodes"),$.ui.dynatree.version="$Version:$",$.ui.dynatree.getNode=function(a){if(a instanceof DynaTreeNode)return a;for(void 0!==a.selector&&(a=a[0]);a;){if(a.dtnode)return a.dtnode;a=a.parentNode}return null},$.ui.dynatree.getPersistData=DynaTreeStatus._getTreePersistData,$.ui.dynatree.prototype.options={title:"Dynatree",minExpandLevel:1,imagePath:null,children:null,initId:null,initAjax:null,autoFocus:!0,keyboard:!0,persist:!1,autoCollapse:!1,clickFolderMode:3,activeVisible:!0,checkbox:!1,selectMode:2,fx:null,noLink:!1,onClick:null,onDblClick:null,onKeydown:null,onKeypress:null,onFocus:null,onBlur:null,onQueryActivate:null,onQuerySelect:null,onQueryExpand:null,onPostInit:null,onActivate:null,onDeactivate:null,onSelect:null,onExpand:null,onLazyRead:null,onCustomRender:null,onCreate:null,onRender:null,postProcess:null,dnd:{onDragStart:null,onDragStop:null,autoExpandMS:1e3,preventVoidMoves:!0,onDragEnter:null,onDragOver:null,onDrop:null,onDragLeave:null},ajaxDefaults:{cache:!1,timeout:0,dataType:"json"},strings:{loading:"Loading&#8230;",loadError:"Load error!"},generateIds:!1,idPrefix:"dynatree-id-",keyPathSeparator:"/",cookieId:"dynatree",cookie:{expires:null},classNames:{container:"dynatree-container",node:"dynatree-node",folder:"dynatree-folder",empty:"dynatree-empty",vline:"dynatree-vline",expander:"dynatree-expander",connector:"dynatree-connector",checkbox:"dynatree-checkbox",nodeIcon:"dynatree-icon",title:"dynatree-title",noConnector:"dynatree-no-connector",nodeError:"dynatree-statusnode-error",nodeWait:"dynatree-statusnode-wait",hidden:"dynatree-hidden",combinedExpanderPrefix:"dynatree-exp-",combinedIconPrefix:"dynatree-ico-",nodeLoading:"dynatree-loading",hasChildren:"dynatree-has-children",active:"dynatree-active",selected:"dynatree-selected",expanded:"dynatree-expanded",lazy:"dynatree-lazy",focused:"dynatree-focused",partsel:"dynatree-partsel",lastsib:"dynatree-lastsib"},debugLevel:2,lastentry:void 0},versionCompare($.ui.version,"1.8")<0&&($.ui.dynatree.defaults=$.ui.dynatree.prototype.options),$.ui.dynatree.nodedatadefaults={title:null,key:null,isFolder:!1,isLazy:!1,tooltip:null,href:null,icon:null,addClass:null,noLink:!1,activate:!1,focus:!1,expand:!1,select:!1,hideCheckbox:!1,unselectable:!1,children:null,lastentry:void 0};
var didRegisterDnd=!1,_registerDnd=function(){didRegisterDnd||($.ui.plugin.add("draggable","connectToDynatree",{start:function(a,b){var c=$(this).data("ui-draggable")||$(this).data("draggable"),d=b.helper.data("dtSourceNode")||null;return d?(c.offset.click.top=-2,c.offset.click.left=16,d.tree._onDragEvent("start",d,null,a,b,c)):void 0},drag:function(a,b){var c=$(this).data("ui-draggable")||$(this).data("draggable"),d=b.helper.data("dtSourceNode")||null,e=b.helper.data("dtTargetNode")||null,f=$.ui.dynatree.getNode(a.target);if(a.target&&!f){var g=$(a.target).closest("div.dynatree-drag-helper,#dynatree-drop-marker").length>0;if(g)return}b.helper.data("dtTargetNode",f),e&&e!==f&&e.tree._onDragEvent("leave",e,d,a,b,c),f&&f.tree.options.dnd.onDrop&&(f===e?f.tree._onDragEvent("over",f,d,a,b,c):f.tree._onDragEvent("enter",f,d,a,b,c))},stop:function(a,b){var c=$(this).data("ui-draggable")||$(this).data("draggable"),d=b.helper.data("dtSourceNode")||null,e=b.helper.data("dtTargetNode")||null,f=(c._mouseDownEvent,a.type),g="mouseup"==f&&1==a.which;logMsg("draggable-connectToDynatree.stop: targetNode(from event): %s, dtTargetNode: %s",e,b.helper.data("dtTargetNode")),g||logMsg("Drag was cancelled"),e&&(g&&e.tree._onDragEvent("drop",e,d,a,b,c),e.tree._onDragEvent("leave",e,d,a,b,c)),d&&d.tree._onDragEvent("stop",d,null,a,b,c)}}),didRegisterDnd=!0)}}(jQuery),function(a,b,c){function d(a){var b={},d=/^jQuery\d+$/;return c.each(a.attributes,function(a,c){c.specified&&!d.test(c.name)&&(b[c.name]=c.value)}),b}function e(a,d){var e=this,f=c(e);if(e.value==f.attr("placeholder")&&f.hasClass("placeholder"))if(f.data("placeholder-password")){if(f=f.hide().next().show().attr("id",f.removeAttr("id").data("placeholder-id")),a===!0)return f[0].value=d;f.focus()}else e.value="",f.removeClass("placeholder"),e==b.activeElement&&e.select()}function f(){var a,b=this,f=c(b),g=this.id;if(""==b.value){if("password"==b.type){if(!f.data("placeholder-textinput")){try{a=f.clone().attr({type:"text"})}catch(h){a=c("<input>").attr(c.extend(d(this),{type:"text"}))}a.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":g}).bind("focus.placeholder",e),f.data({"placeholder-textinput":a,"placeholder-id":g}).before(a)}f=f.removeAttr("id").hide().prev().attr("id",g).show()}f.addClass("placeholder"),f[0].value=f.attr("placeholder")}else f.removeClass("placeholder")}var g,h,i="placeholder"in b.createElement("input"),j="placeholder"in b.createElement("textarea"),k=c.fn,l=c.valHooks;i&&j?(h=k.placeholder=function(){return this},h.input=h.textarea=!0):(h=k.placeholder=function(){var a=this;return a.filter((i?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":e,"blur.placeholder":f}).data("placeholder-enabled",!0).trigger("blur.placeholder"),a},h.input=i,h.textarea=j,g={get:function(a){var b=c(a);return b.data("placeholder-enabled")&&b.hasClass("placeholder")?"":a.value},set:function(a,d){var g=c(a);return g.data("placeholder-enabled")?(""==d?(a.value=d,a!=b.activeElement&&f.call(a)):g.hasClass("placeholder")?e.call(a,!0,d)||(a.value=d):a.value=d,g):a.value=d}},i||(l.input=g),j||(l.textarea=g),c(function(){c(b).delegate("form","submit.placeholder",function(){var a=c(".placeholder",this).each(e);setTimeout(function(){a.each(f)},10)})}),c(a).bind("beforeunload.placeholder",function(){c(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery)}(function(a){"use strict";var b=0;a.ajaxTransport("iframe",function(c){if(c.async&&("POST"===c.type||"GET"===c.type)){var d,e;return{send:function(f,g){d=a('<form style="display:none;"></form>'),d.attr("accept-charset",c.formAcceptCharset),e=a('<iframe src="javascript:false;" name="iframe-transport-'+(b+=1)+'"></iframe>').bind("load",function(){var b,f=a.isArray(c.paramName)?c.paramName:[c.paramName];e.unbind("load").bind("load",function(){var b;try{if(b=e.contents(),!b.length||!b[0].firstChild)throw new Error}catch(c){b=void 0}g(200,"success",{iframe:b}),a('<iframe src="javascript:false;"></iframe>').appendTo(d),d.remove()}),d.prop("target",e.prop("name")).prop("action",c.url).prop("method",c.type),c.formData&&a.each(c.formData,function(b,c){a('<input type="hidden"/>').prop("name",c.name).val(c.value).appendTo(d)}),c.fileInput&&c.fileInput.length&&"POST"===c.type&&(b=c.fileInput.clone(),c.fileInput.after(function(a){return b[a]}),c.paramName&&c.fileInput.each(function(b){a(this).prop("name",f[b]||c.paramName)}),d.append(c.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),d.submit(),b&&b.length&&c.fileInput.each(function(c,d){var e=a(b[c]);a(d).prop("name",e.prop("name")),e.replaceWith(d)})}),d.append(e).appendTo(document.body)},abort:function(){e&&e.unbind("load").prop("src","javascript".concat(":false;")),d&&d.remove()}}}}),a.ajaxSetup({converters:{"iframe text":function(b){return a(b[0].body).text()},"iframe json":function(b){return a.parseJSON(a(b[0].body).text())},"iframe html":function(b){return a(b[0].body).html()},"iframe script":function(b){return a.globalEval(a(b[0].body).text())}}})}),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],a):a(window.jQuery)}(function(a){"use strict";a.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),a.support.xhrFormDataFileUpload=!!window.FormData,a.widget("blueimp.fileupload",{options:{namespace:void 0,dropZone:a(document),pasteZone:a(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(a){return a.serializeArray()},add:function(a,b){b.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["namespace","fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date,this.loaded=0,this.bitrate=0,this.getBitrate=function(a,b,c){var d=a-this.timestamp;return(!this.bitrate||!c||d>c)&&(this.bitrate=8*(b-this.loaded)*(1e3/d),this.loaded=b,this.timestamp=a),this.bitrate}},_isXHRUpload:function(b){return!b.forceIframeTransport&&(!b.multipart&&a.support.xhrFileUpload||a.support.xhrFormDataFileUpload)},_getFormData:function(b){var c;return"function"==typeof b.formData?b.formData(b.form):a.isArray(b.formData)?b.formData:b.formData?(c=[],a.each(b.formData,function(a,b){c.push({name:a,value:b})}),c):[]},_getTotal:function(b){var c=0;return a.each(b,function(a,b){c+=b.size||1}),c},_onProgress:function(a,b){if(a.lengthComputable){var c,d,e=+new Date;if(b._time&&b.progressInterval&&e-b._time<b.progressInterval&&a.loaded!==a.total)return;b._time=e,c=b.total||this._getTotal(b.files),d=parseInt(a.loaded/a.total*(b.chunkSize||c),10)+(b.uploadedBytes||0),this._loaded+=d-(b.loaded||b.uploadedBytes||0),b.lengthComputable=!0,b.loaded=d,b.total=c,b.bitrate=b._bitrateTimer.getBitrate(e,d,b.bitrateInterval),this._trigger("progress",a,b),this._trigger("progressall",a,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(e,this._loaded,b.bitrateInterval)})}},_initProgressListener:function(b){var c=this,d=b.xhr?b.xhr():a.ajaxSettings.xhr();d.upload&&(a(d.upload).bind("progress",function(a){var d=a.originalEvent;a.lengthComputable=d.lengthComputable,a.loaded=d.loaded,a.total=d.total,c._onProgress(a,b)}),b.xhr=function(){return d})},_initXHRData:function(b){var c,d=b.files[0],e=b.multipart||!a.support.xhrFileUpload,f=b.paramName[0];(!e||b.blob)&&(b.headers=a.extend(b.headers,{"X-File-Name":d.name,"X-File-Type":d.type,"X-File-Size":d.size}),b.blob?e||(b.contentType="application/octet-stream",b.data=b.blob):(b.contentType=d.type,b.data=d)),e&&a.support.xhrFormDataFileUpload&&(b.postMessage?(c=this._getFormData(b),b.blob?c.push({name:f,value:b.blob}):a.each(b.files,function(a,d){c.push({name:b.paramName[a]||f,value:d})})):(b.formData instanceof FormData?c=b.formData:(c=new FormData,a.each(this._getFormData(b),function(a,b){c.append(b.name,b.value)})),b.blob?c.append(f,b.blob,d.name):a.each(b.files,function(a,d){d instanceof Blob&&c.append(b.paramName[a]||f,d,d.name)})),b.data=c),b.blob=null},_initIframeSettings:function(b){b.dataType="iframe "+(b.dataType||""),b.formData=this._getFormData(b),b.redirect&&a("<a></a>").prop("href",b.url).prop("host")!==location.host&&b.formData.push({name:b.redirectParamName||"redirect",value:b.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a,"iframe")},_getParamName:function(b){var c=a(b.fileInput),d=b.paramName;return d?a.isArray(d)||(d=[d]):(d=[],c.each(function(){for(var b=a(this),c=b.prop("name")||"files[]",e=(b.prop("files")||[1]).length;e;)d.push(c),e-=1}),d.length||(d=[c.prop("name")||"files[]"])),d},_initFormSettings:function(b){b.form&&b.form.length||(b.form=a(b.fileInput.prop("form")),b.form.length||(b.form=a(this.options.fileInput.prop("form")))),b.paramName=this._getParamName(b),b.url||(b.url=b.form.prop("action")||location.href),b.type=(b.type||b.form.prop("method")||"").toUpperCase(),"POST"!==b.type&&"PUT"!==b.type&&(b.type="POST"),b.formAcceptCharset||(b.formAcceptCharset=b.form.attr("accept-charset"))},_getAJAXSettings:function(b){var c=a.extend({},this.options,b);return this._initFormSettings(c),this._initDataSettings(c),c},_enhancePromise:function(a){return a.success=a.done,a.error=a.fail,a.complete=a.always,a},_getXHRPromise:function(b,c,d){var e=a.Deferred(),f=e.promise();return c=c||this.options.context||f,b===!0?e.resolveWith(c,d):b===!1&&e.rejectWith(c,d),f.abort=e.promise,this._enhancePromise(f)},_chunkedUpload:function(b,c){var d,e,f,g,h=this,i=b.files[0],j=i.size,k=b.uploadedBytes=b.uploadedBytes||0,l=b.maxChunkSize||j,m=i.webkitSlice||i.mozSlice||i.slice;return this._isXHRUpload(b)&&m&&(k||j>l)&&!b.data?c?!0:k>=j?(i.error="uploadedBytes",this._getXHRPromise(!1,b.context,[null,"error",i.error])):(e=Math.ceil((j-k)/l),d=function(c){return c?d(c-=1).pipe(function(){var d=a.extend({},b);return d.blob=m.call(i,k+c*l,k+(c+1)*l),d.chunkIndex=c,d.chunksNumber=e,d.chunkSize=d.blob.size,h._initXHRData(d),h._initProgressListener(d),f=(a.ajax(d)||h._getXHRPromise(!1,d.context)).done(function(){d.loaded||h._onProgress(a.Event("progress",{lengthComputable:!0,loaded:d.chunkSize,total:d.chunkSize}),d),b.uploadedBytes=d.uploadedBytes+=d.chunkSize})}):h._getXHRPromise(!0,b.context)},g=d(e),g.abort=function(){return f.abort()},this._enhancePromise(g)):!1},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer),this._active+=1,this._loaded+=b.uploadedBytes||0,this._total+=this._getTotal(b.files)},_onDone:function(b,c,d,e){this._isXHRUpload(e)||this._onProgress(a.Event("progress",{lengthComputable:!0,loaded:1,total:1}),e),e.result=b,e.textStatus=c,e.jqXHR=d,this._trigger("done",null,e)},_onFail:function(a,b,c,d){d.jqXHR=a,d.textStatus=b,d.errorThrown=c,this._trigger("fail",null,d),d.recalculateProgress&&(this._loaded-=d.loaded||d.uploadedBytes||0,this._total-=d.total||this._getTotal(d.files))},_onAlways:function(a,b,c,d){this._active-=1,d.textStatus=b,c&&c.always?(d.jqXHR=c,d.result=a):(d.jqXHR=a,d.errorThrown=c),this._trigger("always",null,d),0===this._active&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(b,c){var d,e,f,g=this,h=g._getAJAXSettings(c),i=function(c,e){return g._sending+=1,h._bitrateTimer=new g._BitrateTimer,d=d||(c!==!1&&g._trigger("send",b,h)!==!1&&(g._chunkedUpload(h)||a.ajax(h))||g._getXHRPromise(!1,h.context,e)).done(function(a,b,c){g._onDone(a,b,c,h)}).fail(function(a,b,c){g._onFail(a,b,c,h)}).always(function(a,b,c){if(g._sending-=1,g._onAlways(a,b,c,h),h.limitConcurrentUploads&&h.limitConcurrentUploads>g._sending)for(var d,e=g._slots.shift();e;){if(d=e.state?"pending"===e.state():!e.isRejected()){e.resolve();break}e=g._slots.shift()}})};return this._beforeSend(b,h),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(e=a.Deferred(),this._slots.push(e),f=e.pipe(i)):f=this._sequence=this._sequence.pipe(i,i),f.abort=function(){var a=[void 0,"abort","abort"];return d?d.abort():(e&&e.rejectWith(f,a),i(!1,a))},this._enhancePromise(f)):i()},_onAdd:function(b,c){var d,e,f,g,h=this,i=!0,j=a.extend({},this.options,c),k=j.limitMultiFileUploads,l=this._getParamName(j);if((j.singleFileUploads||k)&&this._isXHRUpload(j))if(!j.singleFileUploads&&k)for(f=[],d=[],g=0;g<c.files.length;g+=k)f.push(c.files.slice(g,g+k)),e=l.slice(g,g+k),e.length||(e=l),d.push(e);else d=l;else f=[c.files],d=[l];return c.originalFiles=c.files,a.each(f||c.files,function(e,g){var j=a.extend({},c);return j.files=f?g:[g],j.paramName=d[e],j.submit=function(){return j.jqXHR=this.jqXHR=h._trigger("submit",b,this)!==!1&&h._onSend(b,this),this.jqXHR},i=h._trigger("add",b,j)}),i},_replaceFileInput:function(b){var c=b.clone(!0);a("<form></form>").append(c)[0].reset(),b.after(c).detach(),a.cleanData(b.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(a,d){return d===b[0]?c[0]:d}),b[0]===this.element[0]&&(this.element=c)},_handleFileTreeEntry:function(b,c){var d,e=this,f=a.Deferred(),g=function(a){a&&!a.entry&&(a.entry=b),f.resolve([a])};return c=c||"",b.isFile?b.file(function(a){a.relativePath=c,f.resolve(a)},g):b.isDirectory?(d=b.createReader(),d.readEntries(function(a){e._handleFileTreeEntries(a,c+b.name+"/").done(function(a){f.resolve(a)}).fail(g)},g)):f.resolve([]),f.promise()},_handleFileTreeEntries:function(b,c){var d=this;return a.when.apply(a,a.map(b,function(a){return d._handleFileTreeEntry(a,c)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(b){b=b||{};var c=b.items;return c&&c.length&&(c[0].webkitGetAsEntry||c[0].getAsEntry)?this._handleFileTreeEntries(a.map(c,function(a){return a.webkitGetAsEntry?a.webkitGetAsEntry():a.getAsEntry()})):a.Deferred().resolve(a.makeArray(b.files)).promise()},_getSingleFileInputFiles:function(b){b=a(b);var c,d,e=b.prop("webkitEntries")||b.prop("entries");if(e&&e.length)return this._handleFileTreeEntries(e);if(c=a.makeArray(b.prop("files")),!c.length){if(d=b.prop("value"),!d)return a.Deferred().resolve([]).promise();c=[{name:d.replace(/^.*\\/,"")}]}return a.Deferred().resolve(c).promise()},_getFileInputFiles:function(b){return b instanceof a&&1!==b.length?a.when.apply(a,a.map(b,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(b)},_onChange:function(b){var c=b.data.fileupload,d={fileInput:a(b.target),form:a(b.target.form)};c._getFileInputFiles(d.fileInput).always(function(a){d.files=a,c.options.replaceFileInput&&c._replaceFileInput(d.fileInput),c._trigger("change",b,d)!==!1&&c._onAdd(b,d)})},_onPaste:function(b){var c=b.data.fileupload,d=b.originalEvent.clipboardData,e=d&&d.items||[],f={files:[]};return a.each(e,function(a,b){var c=b.getAsFile&&b.getAsFile();c&&f.files.push(c)}),c._trigger("paste",b,f)===!1||c._onAdd(b,f)===!1?!1:void 0},_onDrop:function(a){a.preventDefault();var b=a.data.fileupload,c=a.dataTransfer=a.originalEvent.dataTransfer,d={};b._getDroppedFiles(c).always(function(c){d.files=c,b._trigger("drop",a,d)!==!1&&b._onAdd(a,d)})},_onDragOver:function(a){var b=a.data.fileupload,c=a.dataTransfer=a.originalEvent.dataTransfer;return b._trigger("dragover",a)===!1?!1:(c&&(c.dropEffect="copy"),a.preventDefault(),void 0)},_initEventHandlers:function(){var a=this.options.namespace;this._isXHRUpload(this.options)&&(this.options.dropZone.bind("dragover."+a,{fileupload:this},this._onDragOver).bind("drop."+a,{fileupload:this},this._onDrop),this.options.pasteZone.bind("paste."+a,{fileupload:this},this._onPaste)),this.options.fileInput.bind("change."+a,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var a=this.options.namespace;this.options.dropZone.unbind("dragover."+a,this._onDragOver).unbind("drop."+a,this._onDrop),this.options.pasteZone.unbind("paste."+a,this._onPaste),this.options.fileInput.unbind("change."+a,this._onChange)},_setOption:function(b,c){var d=-1!==a.inArray(b,this._refreshOptionsList);d&&this._destroyEventHandlers(),a.Widget.prototype._setOption.call(this,b,c),d&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var b=this.options;void 0===b.fileInput?b.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):b.fileInput instanceof a||(b.fileInput=a(b.fileInput)),b.dropZone instanceof a||(b.dropZone=a(b.dropZone)),b.pasteZone instanceof a||(b.pasteZone=a(b.pasteZone))},_create:function(){var b=this.options;a.extend(b,a(this.element[0].cloneNode(!1)).data()),b.namespace=b.namespace||this.widgetName,this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=this._loaded=this._total=0,this._initEventHandlers()},destroy:function(){this._destroyEventHandlers(),a.Widget.prototype.destroy.call(this)},enable:function(){var b=!1;this.options.disabled&&(b=!0),a.Widget.prototype.enable.call(this),b&&this._initEventHandlers()},disable:function(){this.options.disabled||this._destroyEventHandlers(),a.Widget.prototype.disable.call(this)},add:function(b){var c=this;b&&!this.options.disabled&&(b.fileInput&&!b.files?this._getFileInputFiles(b.fileInput).always(function(a){b.files=a,c._onAdd(null,b)}):(b.files=a.makeArray(b.files),this._onAdd(null,b)))},send:function(b){if(b&&!this.options.disabled){if(b.fileInput&&!b.files){var c,d,e=this,f=a.Deferred(),g=f.promise();return g.abort=function(){return d=!0,c?c.abort():(f.reject(null,"abort","abort"),g)},this._getFileInputFiles(b.fileInput).always(function(a){d||(b.files=a,c=e._onSend(null,b).then(function(a,b,c){f.resolve(a,b,c)},function(a,b,c){f.reject(a,b,c)}))}),this._enhancePromise(g)}if(b.files=a.makeArray(b.files),b.files.length)return this._onSend(null,b)}return this._getXHRPromise(!1,b&&b.context)}})}),window.SM2_DEFER=!0,function(a){function b(b,c){function d(a){return jb.preferFlash&&eb&&!jb.ignoreFlash&&"undefined"!=typeof jb.flash[a]&&jb.flash[a]}function e(a){return function(b){var c,d=this._t;return d&&d._a?c=a.call(this,b):(d&&d.id?jb._wD(nb+"ignoring "+b.type+": "+d.id):jb._wD(nb+"ignoring "+b.type),c=null),c}}this.setupOptions={url:b||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!0,noSWFCache:!1},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=c||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20120624",this.version=null,this.movieURL=null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null},this.hasHTML5=function(){try{return"undefined"!=typeof Audio&&"undefined"!=typeof(new Audio).canPlayType}catch(a){return!1}}(),this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb=this,kb=null,lb="soundManager",mb=lb+"::",nb="HTML5::",ob=navigator.userAgent,pb=a,qb=pb.location.href.toString(),rb=document,sb=[],tb=!0,ub=!1,vb=!1,wb=!1,xb=!1,yb=!1,zb=0,Ab=["log","info","warn","error"],Bb=8,Cb=null,Db=null,Eb=!1,Fb=!1,Gb=0,Hb=null,Ib=null,Jb=Array.prototype.slice,Kb=!1,Lb=ob.match(/(ipad|iphone|ipod)/i),Mb=ob.match(/msie/i),Nb=ob.match(/webkit/i),Ob=ob.match(/safari/i)&&!ob.match(/chrome/i),Pb=ob.match(/opera/i),Qb=ob.match(/(mobile|pre\/|xoom)/i)||Lb,Rb=!qb.match(/usehtml5audio/i)&&!qb.match(/sm2\-ignorebadua/i)&&Ob&&!ob.match(/silk/i)&&ob.match(/OS X 10_6_([3-7])/i),Sb="undefined"!=typeof console&&"undefined"!=typeof console.log,Tb="undefined"!=typeof rb.hasFocus?rb.hasFocus():null,Ub=Ob&&("undefined"==typeof rb.hasFocus||!rb.hasFocus()),Vb=!Ub,Wb=/(mp3|mp4|mpa|m4a)/i,Xb="about:blank",Yb=rb.location?rb.location.protocol.match(/http/i):null,Zb=Yb?"":"http://",$b=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|mp4v|3gp|3g2)\s*(?:$|;)/i,_b=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","mp4v","3gp","3g2"],ac=new RegExp("\\.("+_b.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!Yb,this._global_a=null,O={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},Qb&&(jb.useHTML5Audio=!0,jb.preferFlash=!1,Lb&&(jb.ignoreFlash=!0,Kb=!0)),this.setup=function(a){return"undefined"!=typeof a&&wb&&Ib&&jb.ok()&&("undefined"!=typeof a.flashVersion||"undefined"!=typeof a.url)&&S(L("setupLate")),p(a),jb},this.ok=function(){return Ib?wb&&!xb:jb.useHTML5Audio&&jb.hasHTML5},this.supported=this.ok,this.getMovie=function(a){return g(a)||rb[a]||pb[a]},this.createSound=function(a,b){function c(){return g=Q(g),jb.sounds[i.id]=new f(i),jb.soundIDs.push(i.id),jb.sounds[i.id]}var d,e,g=null,h=null,i=null;return d=lb+".createSound(): ",e=d+L(wb?"notOK":"notReady"),wb&&jb.ok()?("undefined"!=typeof b&&(a={id:a,url:b}),g=o(a),g.url=X(g.url),i=g,i.id.toString().charAt(0).match(/^[0-9]$/)&&jb._wD(d+L("badID",i.id),2),jb._wD(d+i.id+" ("+i.url+")",1),T(i.id,!0)?(jb._wD(d+i.id+" exists",1),jb.sounds[i.id]):(Z(i)?(h=c(),jb._wD("Creating sound "+i.id+", using HTML5"),h._setup_html5(i)):(k>8&&(null===i.isMovieStar&&(i.isMovieStar=!(!i.serverURL&&(i.type?!i.type.match($b):1)&&!i.url.match(ac))),i.isMovieStar&&(jb._wD(d+"using MovieStar handling"),i.loops>1&&m("noNSLoop"))),i=R(i,d),h=c(),8===k?kb._createSound(i.id,i.loops||1,i.usePolicyFile):(kb._createSound(i.id,i.url,i.usePeakData,i.useWaveformData,i.useEQData,i.isMovieStar,i.isMovieStar?i.bufferTime:!1,i.loops||1,i.serverURL,i.duration||null,i.autoPlay,!0,i.autoLoad,i.usePolicyFile),i.serverURL||(h.connected=!0,i.onconnect&&i.onconnect.apply(h))),i.serverURL||!i.autoLoad&&!i.autoPlay||h.load(i)),!i.serverURL&&i.autoPlay&&h.play(),h)):(S(e),!1)},this.destroySound=function(a,b){if(!T(a))return!1;var c,d=jb.sounds[a];for(d._iO={},d.stop(),d.unload(),c=0;c<jb.soundIDs.length;c++)if(jb.soundIDs[c]===a){jb.soundIDs.splice(c,1);break}return b||d.destruct(!0),d=null,delete jb.sounds[a],!0},this.load=function(a,b){return T(a)?jb.sounds[a].load(b):!1},this.unload=function(a){return T(a)?jb.sounds[a].unload():!1},this.onPosition=function(a,b,c,d){return T(a)?jb.sounds[a].onposition(b,c,d):!1},this.onposition=this.onPosition,this.clearOnPosition=function(a,b,c){return T(a)?jb.sounds[a].clearOnPosition(b,c):!1},this.play=function(a,b){var c=!1;return wb&&jb.ok()?T(a)?jb.sounds[a].play(b):(b instanceof Object||(b={url:b}),b&&b.url&&(jb._wD(lb+'.play(): attempting to create "'+a+'"',1),b.id=a,c=jb.createSound(b).play()),c):(S(lb+".play(): "+L(wb?"notOK":"notReady")),c)},this.start=this.play,this.setPosition=function(a,b){return T(a)?jb.sounds[a].setPosition(b):!1},this.stop=function(a){return T(a)?(jb._wD(lb+".stop("+a+")",1),jb.sounds[a].stop()):!1},this.stopAll=function(){var a;jb._wD(lb+".stopAll()",1);for(a in jb.sounds)jb.sounds.hasOwnProperty(a)&&jb.sounds[a].stop()},this.pause=function(a){return T(a)?jb.sounds[a].pause():!1},this.pauseAll=function(){var a;for(a=jb.soundIDs.length-1;a>=0;a--)jb.sounds[jb.soundIDs[a]].pause()},this.resume=function(a){return T(a)?jb.sounds[a].resume():!1},this.resumeAll=function(){var a;for(a=jb.soundIDs.length-1;a>=0;a--)jb.sounds[jb.soundIDs[a]].resume()},this.togglePause=function(a){return T(a)?jb.sounds[a].togglePause():!1},this.setPan=function(a,b){return T(a)?jb.sounds[a].setPan(b):!1},this.setVolume=function(a,b){return T(a)?jb.sounds[a].setVolume(b):!1},this.mute=function(a){var b=0;if("string"!=typeof a&&(a=null),a)return T(a)?(jb._wD(lb+'.mute(): Muting "'+a+'"'),jb.sounds[a].mute()):!1;for(jb._wD(lb+".mute(): Muting all sounds"),b=jb.soundIDs.length-1;b>=0;b--)jb.sounds[jb.soundIDs[b]].mute();return jb.muted=!0,!0},this.muteAll=function(){jb.mute()},this.unmute=function(a){var b;if("string"!=typeof a&&(a=null),a)return T(a)?(jb._wD(lb+'.unmute(): Unmuting "'+a+'"'),jb.sounds[a].unmute()):!1;for(jb._wD(lb+".unmute(): Unmuting all sounds"),b=jb.soundIDs.length-1;b>=0;b--)jb.sounds[jb.soundIDs[b]].unmute();return jb.muted=!1,!0},this.unmuteAll=function(){jb.unmute()},this.toggleMute=function(a){return T(a)?jb.sounds[a].toggleMute():!1},this.getMemoryUse=function(){var a=0;return kb&&8!==k&&(a=parseInt(kb._getMemoryUse(),10)),a},this.disable=function(a){var b;if("undefined"==typeof a&&(a=!1),xb)return!1;for(xb=!0,m("shutdown",1),b=jb.soundIDs.length-1;b>=0;b--)I(jb.sounds[jb.soundIDs[b]]);return n(a),db.remove(pb,"load",t),!0},this.canPlayMIME=function(a){var b;return jb.hasHTML5&&(b=$({type:a})),!b&&Ib&&(b=a&&jb.ok()?!!((k>8?a.match($b):null)||a.match(jb.mimePattern)):null),b},this.canPlayURL=function(a){var b;return jb.hasHTML5&&(b=$({url:a})),!b&&Ib&&(b=a&&jb.ok()?!!a.match(jb.filePattern):null),b},this.canPlayLink=function(a){return"undefined"!=typeof a.type&&a.type&&jb.canPlayMIME(a.type)?!0:jb.canPlayURL(a.href)},this.getSoundById=function(a,b){if(!a)throw new Error(lb+".getSoundById(): sID is null/undefined");var c=jb.sounds[a];return c||b||jb._wD('"'+a+'" is an invalid sound ID.',2),c},this.onready=function(a,b){var c="onready",d=!1;if("function"!=typeof a)throw L("needFunction",c);return wb&&jb._wD(L("queue",c)),b||(b=pb),r(c,a,b),s(),d=!0,d},this.ontimeout=function(a,b){var c="ontimeout",d=!1;if("function"!=typeof a)throw L("needFunction",c);return wb&&jb._wD(L("queue",c)),b||(b=pb),r(c,a,b),s({type:c}),d=!0,d},this._writeDebug=function(a,b,c){var d,e,f,h="soundmanager-debug";if(!jb.debugMode)return!1;if("undefined"!=typeof c&&c&&(a=a+" | "+(new Date).getTime()),Sb&&jb.useConsole&&(f=Ab[b],"undefined"!=typeof console[f]?console[f](a):console.log(a),jb.consoleOnly))return!0;try{if(d=g(h),!d)return!1;e=rb.createElement("div"),0===++zb%2&&(e.className="sm2-alt"),b="undefined"==typeof b?0:parseInt(b,10),e.appendChild(rb.createTextNode(a)),b&&(b>=2&&(e.style.fontWeight="bold"),3===b&&(e.style.color="#ff3333")),d.insertBefore(e,d.firstChild)}catch(i){}return d=null,!0},this._wD=this._writeDebug,this._debug=function(){var a,b;for(m("currentObj",1),a=0,b=jb.soundIDs.length;b>a;a++)jb.sounds[jb.soundIDs[a]]._debug()},this.reboot=function(){jb._wD(lb+".reboot()"),jb.soundIDs.length&&jb._wD("Destroying "+jb.soundIDs.length+" SMSound objects...");var a,b;for(a=jb.soundIDs.length-1;a>=0;a--)jb.sounds[jb.soundIDs[a]].destruct();if(kb)try{Mb&&(Db=kb.innerHTML),Cb=kb.parentNode.removeChild(kb),jb._wD("Flash movie removed.")}catch(c){m("badRemove",2)}Db=Cb=Ib=null,jb.enabled=C=wb=Eb=Fb=ub=vb=xb=jb.swfLoaded=!1,jb.soundIDs=[],jb.sounds={},kb=null;for(a in sb)if(sb.hasOwnProperty(a))for(b=sb[a].length-1;b>=0;b--)sb[a][b].fired=!1;jb._wD(lb+": Rebooting..."),pb.setTimeout(jb.beginDelayedInit,20)},this.getMoviePercent=function(){return kb&&"undefined"!=typeof kb.PercentLoaded?kb.PercentLoaded():null},this.beginDelayedInit=function(){yb=!0,A(),setTimeout(function(){return Fb?!1:(E(),z(),Fb=!0,!0)},20),u()},this.destruct=function(){jb._wD(lb+".destruct()"),jb.disable(!0)},f=function(a){var b,c,d,e,f,g,h,i,j,n=this,p=!1,q=[],r=0,s=null;j={duration:null,time:null},this.id=a.id,this.sID=this.id,this.url=a.url,this.options=o(a),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,this.id3={},this._debug=function(){if(jb.debugMode){var a,b,c=null,d=[],e=64;for(c in n.options)null!==n.options[c]&&("function"==typeof n.options[c]?(a=n.options[c].toString(),a=a.replace(/\s\s+/g," "),b=a.indexOf("{"),d.push(" "+c+": {"+a.substr(b+1,Math.min(Math.max(a.indexOf("\n")-1,e),e)).replace(/\n/g,"")+"... }")):d.push(" "+c+": "+n.options[c]));jb._wD("SMSound() merged options: {\n"+d.join(", \n")+"\n}")}},this._debug(),this.load=function(a){var b,c=null;if("undefined"!=typeof a?(n._iO=o(a,n.options),n.instanceOptions=n._iO):(a=n.options,n._iO=a,n.instanceOptions=n._iO,s&&s!==n.url&&(m("manURL"),n._iO.url=n.url,n.url=null)),n._iO.url||(n._iO.url=n.url),n._iO.url=X(n._iO.url),jb._wD("SMSound.load(): "+n._iO.url,1),n._iO.url===n.url&&0!==n.readyState&&2!==n.readyState)return m("onURL",1),3===n.readyState&&n._iO.onload&&n._iO.onload.apply(n,[!!n.duration]),n;if(b=n._iO,s=n.url,n.loaded=!1,n.readyState=1,n.playState=0,n.id3={},Z(b))c=n._setup_html5(b),c._called_load?jb._wD(nb+"ignoring request to load again: "+n.id):(jb._wD(nb+"load: "+n.id),n._html5_canplay=!1,n._a.src!==b.url&&(jb._wD(m("manURL")+": "+b.url),n._a.src=b.url,n.setPosition(0)),n._a.autobuffer="auto",n._a.preload="auto",c._called_load=!0,b.autoPlay&&n.play());else try{n.isHTML5=!1,n._iO=R(Q(b)),b=n._iO,8===k?kb._load(n.id,b.url,b.stream,b.autoPlay,b.whileloading?1:0,b.loops||1,b.usePolicyFile):kb._load(n.id,b.url,!!b.stream,!!b.autoPlay,b.loops||1,!!b.autoLoad,b.usePolicyFile)}catch(d){m("smError",2),l("onload",!1),F({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}return n},this.unload=function(){return 0!==n.readyState&&(jb._wD('SMSound.unload(): "'+n.id+'"'),n.isHTML5?(e(),n._a&&(n._a.pause(),ab(n._a,Xb),n.url=Xb)):8===k?kb._unload(n.id,Xb):kb._unload(n.id),b()),n},this.destruct=function(a){jb._wD('SMSound.destruct(): "'+n.id+'"'),n.isHTML5?(e(),n._a&&(n._a.pause(),ab(n._a),Kb||d(),n._a._t=null,n._a=null)):(n._iO.onfailure=null,kb._destroySound(n.id)),a||jb.destroySound(n.id,!0)},this.play=function(a,b){var c,d,e,h,j=!0,l=null;if(c="SMSound.play(): ",b="undefined"==typeof b?!0:b,a||(a={}),n._iO=o(a,n._iO),n._iO=o(n._iO,n.options),n._iO.url=X(n._iO.url),n.instanceOptions=n._iO,n._iO.serverURL&&!n.connected)return n.getAutoPlay()||(jb._wD(c+" Netstream not connected yet - setting autoPlay"),n.setAutoPlay(!0)),n;if(Z(n._iO)&&(n._setup_html5(n._iO),f()),1!==n.playState||n.paused||(d=n._iO.multiShot,d?jb._wD(c+'"'+n.id+'" already playing (multi-shot)',1):(jb._wD(c+'"'+n.id+'" already playing (one-shot)',1),l=n)),null!==l)return l;
if(n.loaded?jb._wD(c+'"'+n.id+'"'):0===n.readyState?(jb._wD(c+'Attempting to load "'+n.id+'"',1),n.isHTML5?n.load(n._iO):(n._iO.autoPlay=!0,n.load(n._iO))):2===n.readyState?(jb._wD(c+'Could not load "'+n.id+'" - exiting',2),l=n):jb._wD(c+'"'+n.id+'" is loading - attempting to play..',1),null!==l)return l;if(!n.isHTML5&&9===k&&n.position>0&&n.position===n.duration&&(jb._wD(c+'"'+n.id+'": Sound at end, resetting to position:0'),a.position=0),n.paused&&n.position&&n.position>0)jb._wD(c+'"'+n.id+'" is resuming from paused state',1),n.resume();else{if(n._iO=o(a,n._iO),null!==n._iO.from&&null!==n._iO.to&&0===n.instanceCount&&0===n.playState&&!n._iO.serverURL){if(h=function(){n._iO=o(a,n._iO),n.play(n._iO)},n.isHTML5&&!n._html5_canplay?(jb._wD(c+'Beginning load of "'+n.id+'" for from/to case'),n.load({_oncanplay:h}),l=!1):n.isHTML5||n.loaded||n.readyState&&2===n.readyState||(jb._wD(c+'Preloading "'+n.id+'" for from/to case'),n.load({onload:h}),l=!1),null!==l)return l;n._iO=i()}jb._wD(c+'"'+n.id+'" is starting to play'),(!n.instanceCount||n._iO.multiShotEvents||!n.isHTML5&&k>8&&!n.getAutoPlay())&&n.instanceCount++,n._iO.onposition&&0===n.playState&&g(n),n.playState=1,n.paused=!1,n.position="undefined"==typeof n._iO.position||isNaN(n._iO.position)?0:n._iO.position,n.isHTML5||(n._iO=R(Q(n._iO))),n._iO.onplay&&b&&(n._iO.onplay.apply(n),p=!0),n.setVolume(n._iO.volume,!0),n.setPan(n._iO.pan,!0),n.isHTML5?(f(),e=n._setup_html5(),n.setPosition(n._iO.position),e.play()):(j=kb._start(n.id,n._iO.loops||1,9===k?n._iO.position:n._iO.position/1e3,n._iO.multiShot),9!==k||j||(jb._wD(c+n.id+": No sound hardware, or 32-sound ceiling hit"),n._iO.onplayerror&&n._iO.onplayerror.apply(n)))}return n},this.start=this.play,this.stop=function(a){var b,c=n._iO;return 1===n.playState&&(n._onbufferchange(0),n._resetOnPosition(0),n.paused=!1,n.isHTML5||(n.playState=0),h(),c.to&&n.clearOnPosition(c.to),n.isHTML5?n._a&&(b=n.position,n.setPosition(0),n.position=b,n._a.pause(),n.playState=0,n._onTimer(),e()):(kb._stop(n.id,a),c.serverURL&&n.unload()),n.instanceCount=0,n._iO={},c.onstop&&c.onstop.apply(n)),n},this.setAutoPlay=function(a){jb._wD("sound "+n.id+" turned autoplay "+(a?"on":"off")),n._iO.autoPlay=a,n.isHTML5||(kb._setAutoPlay(n.id,a),a&&(n.instanceCount||1!==n.readyState||(n.instanceCount++,jb._wD("sound "+n.id+" incremented instance count to "+n.instanceCount))))},this.getAutoPlay=function(){return n._iO.autoPlay},this.setPosition=function(a){"undefined"==typeof a&&(a=0);var b,c,d,e=n.isHTML5?Math.max(a,0):Math.min(n.duration||n._iO.duration,Math.max(a,0));if(b=n.position,n.position=e,d=n.position/1e3,n._resetOnPosition(n.position),n._iO.position=e,n.isHTML5){if(n._a)if(n._html5_canplay){if(n._a.currentTime!==d){jb._wD("setPosition("+d+"): setting position");try{n._a.currentTime=d,(0===n.playState||n.paused)&&n._a.pause()}catch(f){jb._wD("setPosition("+d+"): setting position failed: "+f.message,2)}}}else jb._wD("setPosition("+d+"): delaying, sound not ready")}else c=9===k?n.position:d,n.readyState&&2!==n.readyState&&kb._setPosition(n.id,c,n.paused||!n.playState,n._iO.multiShot);return n.isHTML5&&n.paused&&n._onTimer(!0),n},this.pause=function(a){return n.paused||0===n.playState&&1!==n.readyState?n:(jb._wD("SMSound.pause()"),n.paused=!0,n.isHTML5?(n._setup_html5().pause(),e()):(a||"undefined"==typeof a)&&kb._pause(n.id,n._iO.multiShot),n._iO.onpause&&n._iO.onpause.apply(n),n)},this.resume=function(){var a=n._iO;return n.paused?(jb._wD("SMSound.resume()"),n.paused=!1,n.playState=1,n.isHTML5?(n._setup_html5().play(),f()):(a.isMovieStar&&!a.serverURL&&n.setPosition(n.position),kb._pause(n.id,a.multiShot)),!p&&a.onplay?(a.onplay.apply(n),p=!0):a.onresume&&a.onresume.apply(n),n):n},this.togglePause=function(){return jb._wD("SMSound.togglePause()"),0===n.playState?(n.play({position:9!==k||n.isHTML5?n.position/1e3:n.position}),n):(n.paused?n.resume():n.pause(),n)},this.setPan=function(a,b){return"undefined"==typeof a&&(a=0),"undefined"==typeof b&&(b=!1),n.isHTML5||kb._setPan(n.id,a),n._iO.pan=a,b||(n.pan=a,n.options.pan=a),n},this.setVolume=function(a,b){return"undefined"==typeof a&&(a=100),"undefined"==typeof b&&(b=!1),n.isHTML5?n._a&&(n._a.volume=Math.max(0,Math.min(1,a/100))):kb._setVolume(n.id,jb.muted&&!n.muted||n.muted?0:a),n._iO.volume=a,b||(n.volume=a,n.options.volume=a),n},this.mute=function(){return n.muted=!0,n.isHTML5?n._a&&(n._a.muted=!0):kb._setVolume(n.id,0),n},this.unmute=function(){n.muted=!1;var a="undefined"!=typeof n._iO.volume;return n.isHTML5?n._a&&(n._a.muted=!1):kb._setVolume(n.id,a?n._iO.volume:n.options.volume),n},this.toggleMute=function(){return n.muted?n.unmute():n.mute()},this.onPosition=function(a,b,c){return q.push({position:parseInt(a,10),method:b,scope:"undefined"!=typeof c?c:n,fired:!1}),n},this.onposition=this.onPosition,this.clearOnPosition=function(a,b){var c;if(a=parseInt(a,10),isNaN(a))return!1;for(c=0;c<q.length;c++)a===q[c].position&&(b&&b!==q[c].method||(q[c].fired&&r--,q.splice(c,1)))},this._processOnPosition=function(){var a,b,c=q.length;if(!c||!n.playState||r>=c)return!1;for(a=c-1;a>=0;a--)b=q[a],!b.fired&&n.position>=b.position&&(b.fired=!0,r++,b.method.apply(b.scope,[b.position]));return!0},this._resetOnPosition=function(a){var b,c,d=q.length;if(!d)return!1;for(b=d-1;b>=0;b--)c=q[b],c.fired&&a<=c.position&&(c.fired=!1,r--);return!0},i=function(){var a,b,c=n._iO,d=c.from,e=c.to;return b=function(){jb._wD(n.id+': "to" time of '+e+" reached."),n.clearOnPosition(e,b),n.stop()},a=function(){jb._wD(n.id+': playing "from" '+d),null===e||isNaN(e)||n.onPosition(e,b)},null===d||isNaN(d)||(c.position=d,c.multiShot=!1,a()),c},g=function(){var a,b=n._iO.onposition;if(b)for(a in b)b.hasOwnProperty(a)&&n.onPosition(parseInt(a,10),b[a])},h=function(){var a,b=n._iO.onposition;if(b)for(a in b)b.hasOwnProperty(a)&&n.clearOnPosition(parseInt(a,10))},f=function(){n.isHTML5&&U(n)},e=function(){n.isHTML5&&V(n)},b=function(a){a||(q=[],r=0),p=!1,n._hasTimer=null,n._a=null,n._html5_canplay=!1,n.bytesLoaded=null,n.bytesTotal=null,n.duration=n._iO&&n._iO.duration?n._iO.duration:null,n.durationEstimate=null,n.buffered=[],n.eqData=[],n.eqData.left=[],n.eqData.right=[],n.failures=0,n.isBuffering=!1,n.instanceOptions={},n.instanceCount=0,n.loaded=!1,n.metadata={},n.readyState=0,n.muted=!1,n.paused=!1,n.peakData={left:0,right:0},n.waveformData={left:[],right:[]},n.playState=0,n.position=null,n.id3={}},b(),this._onTimer=function(a){var b,c,d=!1,e={};return n._hasTimer||a?(n._a&&(a||(n.playState>0||1===n.readyState)&&!n.paused)&&(b=n._get_html5_duration(),b!==j.duration&&(j.duration=b,n.duration=b,d=!0),n.durationEstimate=n.duration,c=1e3*n._a.currentTime||0,c!==j.time&&(j.time=c,d=!0),(d||a)&&n._whileplaying(c,e,e,e,e)),d):void 0},this._get_html5_duration=function(){var a=n._iO,b=n._a?1e3*n._a.duration:a?a.duration:void 0,c=b&&!isNaN(b)&&1/0!==b?b:a?a.duration:null;return c},this._apply_loop=function(a,b){!a.loop&&b>1&&jb._wD("Note: Native HTML5 looping is infinite."),a.loop=b>1?"loop":""},this._setup_html5=function(a){var d,e=o(n._iO,a),f=decodeURI,g=Kb?jb._global_a:n._a,h=f(e.url),i=g&&g._t?g._t.instanceOptions:null;if(g){if(g._t&&(Kb||h!==f(s)?!Kb||i.url!==e.url||s&&s!==i.url||(d=g):d=g,d))return n._apply_loop(g,e.loops),d;jb._wD("setting URL on existing object: "+h+(s?", old URL: "+s:"")),Kb&&g._t&&g._t.playState&&e.url!==i.url&&g._t.stop(),b(i&&i.url?e.url===i.url:s?s===e.url:!1),g.src=e.url,n.url=e.url,s=e.url,g._called_load=!1}else m("h5a"),n._a=e.autoLoad||e.autoPlay?new Audio(e.url):Pb?new Audio(null):new Audio,g=n._a,g._called_load=!1,Kb&&(jb._global_a=g);return n.isHTML5=!0,n._a=g,g._t=n,c(),n._apply_loop(g,e.loops),e.autoLoad||e.autoPlay?n.load():(g.autobuffer=!1,g.preload="auto"),g},c=function(){function a(a,b,c){return n._a?n._a.addEventListener(a,b,c||!1):null}if(n._a._added_events)return!1;var b;n._a._added_events=!0;for(b in hb)hb.hasOwnProperty(b)&&a(b,hb[b]);return!0},d=function(){function a(a,b,c){return n._a?n._a.removeEventListener(a,b,c||!1):null}var b;jb._wD(nb+"removing event listeners: "+n.id),n._a._added_events=!1;for(b in hb)hb.hasOwnProperty(b)&&a(b,hb[b])},this._onload=function(a){var b,c=!!a||!n.isHTML5&&8===k&&n.duration;return b="SMSound._onload(): ",jb._wD(b+'"'+n.id+'"'+(c?" loaded.":" failed to load? - "+n.url),c?1:2),c||n.isHTML5||(jb.sandbox.noRemote===!0&&jb._wD(b+L("noNet"),1),jb.sandbox.noLocal===!0&&jb._wD(b+L("noLocal"),1)),n.loaded=c,n.readyState=c?3:2,n._onbufferchange(0),n._iO.onload&&n._iO.onload.apply(n,[c]),!0},this._onbufferchange=function(a){return 0===n.playState?!1:a&&n.isBuffering||!a&&!n.isBuffering?!1:(n.isBuffering=1===a,n._iO.onbufferchange&&(jb._wD("SMSound._onbufferchange(): "+a),n._iO.onbufferchange.apply(n)),!0)},this._onsuspend=function(){return n._iO.onsuspend&&(jb._wD("SMSound._onsuspend()"),n._iO.onsuspend.apply(n)),!0},this._onfailure=function(a,b,c){n.failures++,jb._wD('SMSound._onfailure(): "'+n.id+'" count '+n.failures),n._iO.onfailure&&1===n.failures?n._iO.onfailure(n,a,b,c):jb._wD("SMSound._onfailure(): ignoring")},this._onfinish=function(){var a=n._iO.onfinish;n._onbufferchange(0),n._resetOnPosition(0),n.instanceCount&&(n.instanceCount--,n.instanceCount||(h(),n.playState=0,n.paused=!1,n.instanceCount=0,n.instanceOptions={},n._iO={},e(),n.isHTML5&&(n.position=0)),(!n.instanceCount||n._iO.multiShotEvents)&&a&&(jb._wD('SMSound._onfinish(): "'+n.id+'"'),a.apply(n)))},this._whileloading=function(a,b,c,d){var e=n._iO;n.bytesLoaded=a,n.bytesTotal=b,n.duration=Math.floor(c),n.bufferLength=d,e.isMovieStar?n.durationEstimate=n.duration:(n.durationEstimate=e.duration?n.duration>e.duration?n.duration:e.duration:parseInt(n.bytesTotal/n.bytesLoaded*n.duration,10),"undefined"==typeof n.durationEstimate&&(n.durationEstimate=n.duration)),n.isHTML5||(n.buffered=[{start:0,end:n.duration}]),(3!==n.readyState||n.isHTML5)&&e.whileloading&&e.whileloading.apply(n)},this._whileplaying=function(a,b,c,d,e){var f,g=n._iO;return isNaN(a)||null===a?!1:(n.position=Math.max(0,a),n._processOnPosition(),!n.isHTML5&&k>8&&(g.usePeakData&&"undefined"!=typeof b&&b&&(n.peakData={left:b.leftPeak,right:b.rightPeak}),g.useWaveformData&&"undefined"!=typeof c&&c&&(n.waveformData={left:c.split(","),right:d.split(",")}),g.useEQData&&"undefined"!=typeof e&&e&&e.leftEQ&&(f=e.leftEQ.split(","),n.eqData=f,n.eqData.left=f,"undefined"!=typeof e.rightEQ&&e.rightEQ&&(n.eqData.right=e.rightEQ.split(",")))),1===n.playState&&(n.isHTML5||8!==k||n.position||!n.isBuffering||n._onbufferchange(0),g.whileplaying&&g.whileplaying.apply(n)),!0)},this._oncaptiondata=function(a){jb._wD('SMSound._oncaptiondata(): "'+this.id+'" caption data received.'),n.captiondata=a,n._iO.oncaptiondata&&n._iO.oncaptiondata.apply(n)},this._onmetadata=function(a,b){jb._wD('SMSound._onmetadata(): "'+this.id+'" metadata received.');var c,d,e={};for(c=0,d=a.length;d>c;c++)e[a[c]]=b[c];n.metadata=e,n._iO.onmetadata&&n._iO.onmetadata.apply(n)},this._onid3=function(a,b){jb._wD('SMSound._onid3(): "'+this.id+'" ID3 data received.');var c,d,e=[];for(c=0,d=a.length;d>c;c++)e[a[c]]=b[c];n.id3=o(n.id3,e),n._iO.onid3&&n._iO.onid3.apply(n)},this._onconnect=function(a){a=1===a,jb._wD('SMSound._onconnect(): "'+n.id+'"'+(a?" connected.":" failed to connect? - "+n.url),a?1:2),n.connected=a,a&&(n.failures=0,T(n.id)&&(n.getAutoPlay()?n.play(void 0,n.getAutoPlay()):n._iO.autoLoad&&n.load()),n._iO.onconnect&&n._iO.onconnect.apply(n,[a]))},this._ondataerror=function(a){n.playState>0&&(jb._wD("SMSound._ondataerror(): "+a),n._iO.ondataerror&&n._iO.ondataerror.apply(n))}},D=function(){return rb.body||rb._docElement||rb.getElementsByTagName("div")[0]},g=function(a){return rb.getElementById(a)},o=function(a,b){var c,d,e=a||{};c="undefined"==typeof b?jb.defaultOptions:b;for(d in c)c.hasOwnProperty(d)&&"undefined"==typeof e[d]&&(e[d]="object"!=typeof c[d]||null===c[d]?c[d]:o(e[d],c[d]));return e},q={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},p=function(a,b){var c,d=!0,e="undefined"!=typeof b,f=jb.setupOptions,g=q;if("undefined"==typeof a){d=[];for(c in f)f.hasOwnProperty(c)&&d.push(c);for(c in g)g.hasOwnProperty(c)&&("object"==typeof jb[c]?d.push(c+": {...}"):jb[c]instanceof Function?d.push(c+": function() {...}"):d.push(c));return jb._wD(L("setup",d.join(", "))),!1}for(c in a)if(a.hasOwnProperty(c))if("object"!=typeof a[c]||null===a[c]||a[c]instanceof Array)e&&"undefined"!=typeof g[b]?jb[b][c]=a[c]:"undefined"!=typeof f[c]?(jb.setupOptions[c]=a[c],jb[c]=a[c]):"undefined"==typeof g[c]?(S(L("undefined"==typeof jb[c]?"setupUndef":"setupError",c),2),d=!1):jb[c]instanceof Function?jb[c].apply(jb,a[c]instanceof Array?a[c]:[a[c]]):jb[c]=a[c];else{if("undefined"!=typeof g[c])return p(a[c],c);S(L("undefined"==typeof jb[c]?"setupUndef":"setupError",c),2),d=!1}return d},db=function(){function a(a){var b=Jb.call(a),c=b.length;return e?(b[1]="on"+b[1],c>3&&b.pop()):3===c&&b.push(!1),b}function b(a,b){var c=a.shift(),d=[f[b]];e?c[d](a[0],a[1]):c[d].apply(c,a)}function c(){b(a(arguments),"add")}function d(){b(a(arguments),"remove")}var e=pb.attachEvent,f={add:e?"attachEvent":"addEventListener",remove:e?"detachEvent":"removeEventListener"};return{add:c,remove:d}}(),hb={abort:e(function(){jb._wD(nb+"abort: "+this._t.id)}),canplay:e(function(){var a,b=this._t;if(b._html5_canplay)return!0;if(b._html5_canplay=!0,jb._wD(nb+"canplay: "+b.id+", "+b.url),b._onbufferchange(0),a="undefined"==typeof b._iO.position||isNaN(b._iO.position)?null:b._iO.position/1e3,b.position&&this.currentTime!==a){jb._wD(nb+"canplay: setting position to "+a);try{this.currentTime=a}catch(c){jb._wD(nb+"setting position of "+a+" failed: "+c.message,2)}}b._iO._oncanplay&&b._iO._oncanplay()}),canplaythrough:e(function(){var a=this._t;a.loaded||(a._onbufferchange(0),a._whileloading(a.bytesLoaded,a.bytesTotal,a._get_html5_duration()),a._onload(!0))}),ended:e(function(){var a=this._t;jb._wD(nb+"ended: "+a.id),a._onfinish()}),error:e(function(){jb._wD(nb+"error: "+this.error.code),this._t._onload(!1)}),loadeddata:e(function(){var a=this._t;jb._wD(nb+"loadeddata: "+this._t.id),a._loaded||Ob||(a.duration=a._get_html5_duration())}),loadedmetadata:e(function(){jb._wD(nb+"loadedmetadata: "+this._t.id)}),loadstart:e(function(){jb._wD(nb+"loadstart: "+this._t.id),this._t._onbufferchange(1)}),play:e(function(){jb._wD(nb+"play: "+this._t.id+", "+this._t.url),this._t._onbufferchange(0)}),playing:e(function(){jb._wD(nb+"playing: "+this._t.id),this._t._onbufferchange(0)}),progress:e(function(a){var b,c,d,e=this._t,f=0,g="progress"===a.type,h=a.target.buffered,i=a.loaded||0,j=a.total||1;if(e.buffered=[],h&&h.length){for(b=0,c=h.length;c>b;b++)e.buffered.push({start:h.start(b),end:h.end(b)});if(f=h.end(0)-h.start(0),i=f/a.target.duration,g&&h.length>1){for(d=[],c=h.length,b=0;c>b;b++)d.push(a.target.buffered.start(b)+"-"+a.target.buffered.end(b));jb._wD(nb+"progress: timeRanges: "+d.join(", "))}g&&!isNaN(i)&&jb._wD(nb+"progress: "+e.id+": "+Math.floor(100*i)+"% loaded")}isNaN(i)||(e._onbufferchange(0),e._whileloading(i,j,e._get_html5_duration()),i&&j&&i===j&&hb.canplaythrough.call(this,a))}),ratechange:e(function(){jb._wD(nb+"ratechange: "+this._t.id)}),suspend:e(function(a){var b=this._t;jb._wD(nb+"suspend: "+b.id),hb.progress.call(this,a),b._onsuspend()}),stalled:e(function(){jb._wD(nb+"stalled: "+this._t.id)}),timeupdate:e(function(){this._t._onTimer()}),waiting:e(function(){var a=this._t;jb._wD(nb+"waiting: "+a.id),a._onbufferchange(1)})},Z=function(a){var b;return b=a.serverURL||a.type&&d(a.type)?!1:a.type?$({type:a.type}):$({url:a.url})||jb.html5Only},ab=function(a,b){a&&(a.src=b)},$=function(a){if(!jb.useHTML5Audio||!jb.hasHTML5)return!1;var b,c,e,f,g=a.url||null,h=a.type||null,i=jb.audioFormats;if(h&&"undefined"!=typeof jb.html5[h])return jb.html5[h]&&!d(h);if(!_){_=[];for(f in i)i.hasOwnProperty(f)&&(_.push(f),i[f].related&&(_=_.concat(i[f].related)));_=new RegExp("\\.("+_.join("|")+")(\\?.*)?$","i")}return e=g?g.toLowerCase().match(_):null,e&&e.length?e=e[1]:h?(c=h.indexOf(";"),e=(-1!==c?h.substr(0,c):h).substr(6)):b=!1,e&&"undefined"!=typeof jb.html5[e]?b=jb.html5[e]&&!d(e):(h="audio/"+e,b=jb.html5.canPlayType({type:h}),jb.html5[e]=b,b=b&&jb.html5[h]&&!d(h)),b},cb=function(){function a(a){var b,c,d,e=!1,g=!1;if(!f||"function"!=typeof f.canPlayType)return e;if(a instanceof Array){for(c=0,d=a.length;d>c&&!g;c++)(jb.html5[a[c]]||f.canPlayType(a[c]).match(jb.html5Test))&&(g=!0,jb.html5[a[c]]=!0,jb.flash[a[c]]=!!a[c].match(Wb));e=g}else b=f&&"function"==typeof f.canPlayType?f.canPlayType(a):!1,e=!(!b||!b.match(jb.html5Test));return e}if(!jb.useHTML5Audio||"undefined"==typeof Audio)return!1;var b,c,d,e,f="undefined"!=typeof Audio?Pb?new Audio(null):new Audio:null,g={};d=jb.audioFormats;for(b in d)if(d.hasOwnProperty(b)&&(c="audio/"+b,g[b]=a(d[b].type),g[c]=g[b],b.match(Wb)?(jb.flash[b]=!0,jb.flash[c]=!0):(jb.flash[b]=!1,jb.flash[c]=!1),d[b]&&d[b].related))for(e=d[b].related.length-1;e>=0;e--)g["audio/"+d[b].related[e]]=g[b],jb.html5[d[b].related[e]]=g[b],jb.flash[d[b].related[e]]=g[b];return g.canPlayType=f?a:null,jb.html5=o(jb.html5,g),!0},y={notReady:"Not loaded yet - wait for soundManager.onready()",notOK:"Audio support is not available.",domError:mb+"createMovie(): appendChild/innerHTML call failed. DOM not ready or other error.",spcWmode:mb+"createMovie(): Removing wmode, preventing known SWF loading issue(s)",swf404:lb+": Verify that %s is a valid path.",tryDebug:"Try "+lb+".debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:lb+": Non-HTTP page ("+rb.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:lb+": Special case: Waiting for SWF to load with window focus...",waitImpatient:lb+": Getting impatient, still waiting for Flash%s...",waitForever:lb+": Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:lb+": Retrying, waiting for 100% SWF load...",needFunction:lb+": Function object expected for %s",badID:'Warning: Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:"--- "+lb+"._debug(): Current sound objects ---",waitEI:mb+"initMovie(): Waiting for ExternalInterface call from Flash...",waitOnload:lb+": Waiting for window.onload()",docLoaded:lb+": Document already loaded",onload:mb+"initComplete(): calling soundManager.onload()",onloadOK:lb+".onload() complete",init:mb+"init()",didInit:mb+"init(): Already called?",flashJS:lb+": Attempting JS to Flash call...",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:"Warning: Failed to remove flash movie.",shutdown:lb+".disable(): Shutting down",queue:lb+": Queueing %s handler",smFail:lb+": Failed to initialise.",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying ."+O.swfTimedout+" CSS...",fbLoaded:"Flash loaded",fbHandler:mb+"flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:lb+".load(): current URL already assigned.",badFV:lb+'.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",mfOn:"mobileFlash::enabling on-screen flash repositioning",policy:"Enabling usePolicyFile for data access",setup:lb+".setup(): allowed parameters: %s",setupError:lb+'.setup(): "%s" cannot be assigned with this method.',setupUndef:lb+'.setup(): Could not find option "%s"',setupLate:lb+".setup(): url + flashVersion changes will not take effect until reboot().",h5a:"creating HTML5 Audio() object"},L=function(){var a,b,c=Jb.call(arguments),d=c.shift(),e=y&&y[d]?y[d]:"";if(e&&c&&c.length)for(a=0,b=c.length;b>a;a++)e=e.replace("%s",c[a]);return e},Q=function(a){return 8===k&&a.loops>1&&a.stream&&(m("as2loop"),a.stream=!1),a},R=function(a,b){return a&&!a.usePolicyFile&&(a.onid3||a.usePeakData||a.useWaveformData||a.useEQData)&&(jb._wD((b||"")+L("policy")),a.usePolicyFile=!0),a},S=function(a){"undefined"!=typeof console&&"undefined"!=typeof console.warn?console.warn(a):jb._wD(a)},h=function(){return!1},I=function(a){var b;for(b in a)a.hasOwnProperty(b)&&"function"==typeof a[b]&&(a[b]=h);b=null},J=function(a){"undefined"==typeof a&&(a=!1),(xb||a)&&(m("smFail",2),jb.disable(a))},K=function(a){var b,c=null;if(a)if(a.match(/\.swf(\?.*)?$/i)){if(c=a.substr(a.toLowerCase().lastIndexOf(".swf?")+4))return a}else a.lastIndexOf("/")!==a.length-1&&(a+="/");return b=(a&&-1!==a.lastIndexOf("/")?a.substr(0,a.lastIndexOf("/")+1):"./")+jb.movieURL,jb.noSWFCache&&(b+="?ts="+(new Date).getTime()),b},w=function(){k=parseInt(jb.flashVersion,10),8!==k&&9!==k&&(jb._wD(L("badFV",k,Bb)),jb.flashVersion=k=Bb);var a=jb.debugMode||jb.debugFlash?"_debug.swf":".swf";jb.useHTML5Audio&&!jb.html5Only&&jb.audioFormats.mp4.required&&9>k&&(jb._wD(L("needfl9")),jb.flashVersion=k=9),jb.version=jb.versionNumber+(jb.html5Only?" (HTML5-only mode)":9===k?" (AS3/Flash 9)":" (AS2/Flash 8)"),k>8?(jb.defaultOptions=o(jb.defaultOptions,jb.flash9Options),jb.features.buffering=!0,jb.defaultOptions=o(jb.defaultOptions,jb.movieStarOptions),jb.filePatterns.flash9=new RegExp("\\.(mp3|"+_b.join("|")+")(\\?.*)?$","i"),jb.features.movieStar=!0):jb.features.movieStar=!1,jb.filePattern=jb.filePatterns[8!==k?"flash9":"flash8"],jb.movieURL=(8===k?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",a),jb.features.peakData=jb.features.waveformData=jb.features.eqData=k>8},G=function(a,b){return kb?(kb._setPolling(a,b),void 0):!1},H=function(){if(jb.debugURLParam.test(qb)&&(jb.debugMode=!0),g(jb.debugID))return!1;var a,b,c,d,e;if(!(!jb.debugMode||g(jb.debugID)||Sb&&jb.useConsole&&jb.consoleOnly)){a=rb.createElement("div"),a.id=jb.debugID+"-toggle",d={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001},a.appendChild(rb.createTextNode("-")),a.onclick=P,a.title="Toggle SM2 debug console",ob.match(/msie 6/i)&&(a.style.position="absolute",a.style.cursor="hand");for(e in d)d.hasOwnProperty(e)&&(a.style[e]=d[e]);if(b=rb.createElement("div"),b.id=jb.debugID,b.style.display=jb.debugMode?"block":"none",jb.debugMode&&!g(a.id)){try{c=D(),c.appendChild(a)}catch(f){throw new Error(L("domError")+" \n"+f.toString())}c.appendChild(b)}}c=null},T=this.getSoundById,m=function(a,b){return a?jb._wD(L(a),b):""},qb.indexOf("sm2-debug=alert")+1&&jb.debugMode&&(jb._wD=function(b){a.alert(b)}),P=function(){var a=g(jb.debugID),b=g(jb.debugID+"-toggle");return a?(tb?(b.innerHTML="+",a.style.display="none"):(b.innerHTML="-",a.style.display="block"),tb=!tb,void 0):!1},l=function(a,b,c){if("undefined"!=typeof sm2Debugger)try{sm2Debugger.handleEvent(a,b,c)}catch(d){}return!0},N=function(){var a=[];return jb.debugMode&&a.push(O.sm2Debug),jb.debugFlash&&a.push(O.flashDebug),jb.useHighPerformance&&a.push(O.highPerf),a.join(" ")},M=function(){var a=L("fbHandler"),b=jb.getMoviePercent(),c=O,d={type:"FLASHBLOCK"};return jb.html5Only?!1:(jb.ok()?(jb.didFlashBlock&&jb._wD(a+": Unblocked"),jb.oMC&&(jb.oMC.className=[N(),c.swfDefault,c.swfLoaded+(jb.didFlashBlock?" "+c.swfUnblocked:"")].join(" "))):(Ib&&(jb.oMC.className=N()+" "+c.swfDefault+" "+(null===b?c.swfTimedout:c.swfError),jb._wD(a+": "+L("fbTimeout")+(b?" ("+L("fbLoaded")+")":""))),jb.didFlashBlock=!0,s({type:"ontimeout",ignoreInit:!0,error:d}),F(d)),void 0)},r=function(a,b,c){"undefined"==typeof sb[a]&&(sb[a]=[]),sb[a].push({method:b,scope:c||null,fired:!1})},s=function(a){if(a||(a={type:jb.ok()?"onready":"ontimeout"}),!wb&&a&&!a.ignoreInit)return!1;if("ontimeout"===a.type&&(jb.ok()||xb&&!a.ignoreInit))return!1;var b,c,d={success:a&&a.ignoreInit?jb.ok():!xb},e=a&&a.type?sb[a.type]||[]:[],f=[],g=[d],h=Ib&&jb.useFlashBlock&&!jb.ok();for(a.error&&(g[0].error=a.error),b=0,c=e.length;c>b;b++)e[b].fired!==!0&&f.push(e[b]);if(f.length)for(jb._wD(lb+": Firing "+f.length+" "+a.type+"() item"+(1===f.length?"":"s")),b=0,c=f.length;c>b;b++)f[b].scope?f[b].method.apply(f[b].scope,g):f[b].method.apply(this,g),h||(f[b].fired=!0);return!0},t=function(){pb.setTimeout(function(){jb.useFlashBlock&&M(),s(),"function"==typeof jb.onload&&(m("onload",1),jb.onload.apply(pb),m("onloadOK",1)),jb.waitForWindowLoad&&db.add(pb,"load",t)},1)},fb=function(){if("undefined"!=typeof eb)return eb;var a,b,c,d=!1,e=navigator,f=e.plugins,g=pb.ActiveXObject;if(f&&f.length)b="application/x-shockwave-flash",c=e.mimeTypes,c&&c[b]&&c[b].enabledPlugin&&c[b].enabledPlugin.description&&(d=!0);else if("undefined"!=typeof g){try{a=new g("ShockwaveFlash.ShockwaveFlash")}catch(h){}d=!!a}return eb=d,d},Y=function(){var a,b,c=!0,d=jb.audioFormats,e=Lb&&!!ob.match(/os (1|2|3_0|3_1)/i);if(e?(jb.hasHTML5=!1,jb.html5Only=!0,jb.oMC&&(jb.oMC.style.display="none"),c=!1):jb.useHTML5Audio&&(jb.html5&&jb.html5.canPlayType?jb.hasHTML5=!0:(jb._wD("SoundManager: No HTML5 Audio() support detected."),jb.hasHTML5=!1),Rb&&jb._wD(mb+"Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+(eb?"will use flash fallback for MP3/MP4, if available":" would use flash fallback for MP3/MP4, but none detected."),1)),jb.useHTML5Audio&&jb.hasHTML5)for(b in d)d.hasOwnProperty(b)&&(d[b].required&&!jb.html5.canPlayType(d[b].type)||jb.preferFlash&&(jb.flash[b]||jb.flash[d[b].type]))&&(a=!0);return jb.ignoreFlash&&(a=!1),jb.html5Only=jb.hasHTML5&&jb.useHTML5Audio&&!a,!jb.html5Only},X=function(a){var b,c,d,e=0;if(a instanceof Array){for(b=0,c=a.length;c>b;b++)if(a[b]instanceof Object){if(jb.canPlayMIME(a[b].type)){e=b;break}}else if(jb.canPlayURL(a[b])){e=b;break}a[e].url&&(a[e]=a[e].url),d=a[e]}else d=a;return d},U=function(a){a._hasTimer||(a._hasTimer=!0,!Qb&&jb.html5PollingInterval&&(null===Hb&&0===Gb&&(Hb=pb.setInterval(W,jb.html5PollingInterval)),Gb++))},V=function(a){a._hasTimer&&(a._hasTimer=!1,!Qb&&jb.html5PollingInterval&&Gb--)},W=function(){var a;if(null!==Hb&&!Gb)return pb.clearInterval(Hb),Hb=null,!1;for(a=jb.soundIDs.length-1;a>=0;a--)jb.sounds[jb.soundIDs[a]].isHTML5&&jb.sounds[jb.soundIDs[a]]._hasTimer&&jb.sounds[jb.soundIDs[a]]._onTimer()},F=function(a){a="undefined"!=typeof a?a:{},"function"==typeof jb.onerror&&jb.onerror.apply(pb,[{type:"undefined"!=typeof a.type?a.type:null}]),"undefined"!=typeof a.fatal&&a.fatal&&jb.disable()},gb=function(){if(!Rb||!fb())return!1;var a,b,c=jb.audioFormats;for(b in c)if(c.hasOwnProperty(b)&&("mp3"===b||"mp4"===b)&&(jb._wD(lb+": Using flash fallback for "+b+" format"),jb.html5[b]=!1,c[b]&&c[b].related))for(a=c[b].related.length-1;a>=0;a--)jb.html5[c[b].related[a]]=!1},this._setSandboxType=function(a){var b=jb.sandbox;b.type=a,b.description=b.types["undefined"!=typeof b.types[a]?a:"unknown"],jb._wD("Flash security sandbox type: "+b.type),"localWithFile"===b.type?(b.noRemote=!0,b.noLocal=!1,m("secNote",2)):"localWithNetwork"===b.type?(b.noRemote=!1,b.noLocal=!0):"localTrusted"===b.type&&(b.noRemote=!1,b.noLocal=!1)},this._externalInterfaceOK=function(a,b){if(jb.swfLoaded)return!1;var c,d=(new Date).getTime();return jb._wD(mb+"externalInterfaceOK()"+(a?" (~"+(d-a)+" ms)":"")),l("swf",!0),l("flashtojs",!0),jb.swfLoaded=!0,Ub=!1,Rb&&gb(),b&&b.replace(/\+dev/i,"")===jb.versionNumber.replace(/\+dev/i,"")?(setTimeout(j,Mb?100:1),void 0):(c=lb+': Fatal: JavaScript file build "'+jb.versionNumber+'" does not match Flash SWF build "'+b+'" at '+jb.url+". Ensure both are up-to-date.",setTimeout(function(){throw new Error(c)},0),!1)},E=function(a,b){function c(){jb._wD("-- SoundManager 2 "+jb.version+(!jb.html5Only&&jb.useHTML5Audio?jb.hasHTML5?" + HTML5 audio":", no HTML5 audio support":"")+(jb.html5Only?"":(jb.useHighPerformance?", high performance mode, ":", ")+((jb.flashPollingInterval?"custom ("+jb.flashPollingInterval+"ms)":"normal")+" polling")+(jb.wmode?", wmode: "+jb.wmode:"")+(jb.debugFlash?", flash debug mode":"")+(jb.useFlashBlock?", flashBlock mode":""))+" --",1)}function d(a,b){return'<param name="'+a+'" value="'+b+'" />'}if(ub&&vb)return!1;if(jb.html5Only)return w(),c(),jb.oMC=g(jb.movieID),j(),ub=!0,vb=!0,!1;var e,f,h,i,k,l,n,o,p=b||jb.url,q=jb.altURL||p,r="JS/Flash audio component (SoundManager 2)",s=D(),t=N(),u=null,v=rb.getElementsByTagName("html")[0];if(u=v&&v.dir&&v.dir.match(/rtl/i),a="undefined"==typeof a?jb.id:a,w(),jb.url=K(Yb?p:q),b=jb.url,jb.wmode=!jb.wmode&&jb.useHighPerformance?"transparent":jb.wmode,null!==jb.wmode&&(ob.match(/msie 8/i)||!Mb&&!jb.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(m("spcWmode"),jb.wmode=null),e={name:a,id:a,src:b,quality:"high",allowScriptAccess:jb.allowScriptAccess,bgcolor:jb.bgColor,pluginspage:Zb+"www.macromedia.com/go/getflashplayer",title:r,type:"application/x-shockwave-flash",wmode:jb.wmode,hasPriority:"true"},jb.debugFlash&&(e.FlashVars="debug=1"),jb.wmode||delete e.wmode,Mb)f=rb.createElement("div"),i=['<object id="'+a+'" data="'+b+'" type="'+e.type+'" title="'+e.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+Zb+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',d("movie",b),d("AllowScriptAccess",jb.allowScriptAccess),d("quality",e.quality),jb.wmode?d("wmode",jb.wmode):"",d("bgcolor",jb.bgColor),d("hasPriority","true"),jb.debugFlash?d("FlashVars",e.FlashVars):"","</object>"].join("");else{f=rb.createElement("embed");for(h in e)e.hasOwnProperty(h)&&f.setAttribute(h,e[h])}if(H(),t=N(),s=D())if(jb.oMC=g(jb.movieID)||rb.createElement("div"),jb.oMC.id)o=jb.oMC.className,jb.oMC.className=(o?o+" ":O.swfDefault)+(t?" "+t:""),jb.oMC.appendChild(f),Mb&&(k=jb.oMC.appendChild(rb.createElement("div")),k.className=O.swfBox,k.innerHTML=i),vb=!0;else{if(jb.oMC.id=jb.movieID,jb.oMC.className=O.swfDefault+" "+t,l=null,k=null,jb.useFlashBlock||(jb.useHighPerformance?l={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(l={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},u&&(l.left=Math.abs(parseInt(l.left,10))+"px"))),Nb&&(jb.oMC.style.zIndex=1e4),!jb.debugFlash)for(n in l)l.hasOwnProperty(n)&&(jb.oMC.style[n]=l[n]);try{Mb||jb.oMC.appendChild(f),s.appendChild(jb.oMC),Mb&&(k=jb.oMC.appendChild(rb.createElement("div")),k.className=O.swfBox,k.innerHTML=i),vb=!0}catch(x){throw new Error(L("domError")+" \n"+x.toString())}}return ub=!0,c(),jb._wD(mb+"createMovie(): Trying to load "+b+(!Yb&&jb.altURL?" (alternate URL)":""),1),!0},z=function(){return jb.html5Only?(E(),!1):kb?!1:(kb=jb.getMovie(jb.id),kb||(Cb?(Mb?jb.oMC.innerHTML=Db:jb.oMC.appendChild(Cb),Cb=null,ub=!0):E(jb.id,jb.url),kb=jb.getMovie(jb.id)),kb&&m("waitEI"),"function"==typeof jb.oninitmovie&&setTimeout(jb.oninitmovie,1),!0)},u=function(){setTimeout(v,1e3)},v=function(){var a,b=!1;return Eb?!1:(Eb=!0,db.remove(pb,"load",u),Ub&&!Tb?(m("waitFocus"),!1):(wb||(a=jb.getMoviePercent(),jb._wD(L("waitImpatient",a>0?" (SWF "+a+"% loaded)":"")),a>0&&100>a&&(b=!0)),setTimeout(function(){return a=jb.getMoviePercent(),b?(Eb=!1,jb._wD(L("waitSWF")),pb.setTimeout(u,1),!1):(wb||(jb._wD(lb+": No Flash response within expected time.\nLikely causes: "+(0===a?"Loading "+jb.movieURL+" may have failed (and/or Flash "+k+"+ not present?), ":"")+"Flash blocked or JS-Flash security error."+(jb.debugFlash?" "+L("checkSWF"):""),2),!Yb&&a&&(m("localFail",2),jb.debugFlash||m("tryDebug",2)),0===a&&jb._wD(L("swf404",jb.url)),l("flashtojs",!1," (Check flash security or flash blockers)")),!wb&&Vb&&(null===a?jb.useFlashBlock||0===jb.flashLoadTimeout?(jb.useFlashBlock&&M(),m("waitForever")):J(!0):0===jb.flashLoadTimeout?m("waitForever"):J(!0)),void 0)
},jb.flashLoadTimeout),void 0))},x=function(){function a(){db.remove(pb,"focus",x)}return Tb||!Ub?(a(),!0):(Vb=!0,Tb=!0,jb._wD(lb+": Got window focus."),Eb=!1,u(),a(),!0)},ib=function(){var a,b=[];if(jb.useHTML5Audio&&jb.hasHTML5){for(a in jb.audioFormats)jb.audioFormats.hasOwnProperty(a)&&b.push(a+": "+jb.html5[a]+(!jb.html5[a]&&eb&&jb.flash[a]?" (using flash)":jb.preferFlash&&jb.flash[a]&&eb?" (preferring flash)":jb.html5[a]?"":" ("+(jb.audioFormats[a].required?"required, ":"")+"and no flash support)"));jb._wD("-- SoundManager 2: HTML5 support tests ("+jb.html5Test+"): "+b.join(", ")+" --",1)}},n=function(a){if(wb)return!1;if(jb.html5Only)return jb._wD("-- SoundManager 2: loaded --"),wb=!0,t(),l("onload",!0),!0;var b,c=jb.useFlashBlock&&jb.flashLoadTimeout&&!jb.getMoviePercent(),d=!0;return c||(wb=!0,xb&&(b={type:!eb&&Ib?"NO_FLASH":"INIT_TIMEOUT"})),jb._wD("-- SoundManager 2 "+(xb?"failed to load":"loaded")+" ("+(xb?"security/load error":"OK")+") --",1),xb||a?(jb.useFlashBlock&&jb.oMC&&(jb.oMC.className=N()+" "+(null===jb.getMoviePercent()?O.swfTimedout:O.swfError)),s({type:"ontimeout",error:b,ignoreInit:!0}),l("onload",!1),F(b),d=!1):l("onload",!0),xb||(jb.waitForWindowLoad&&!yb?(m("waitOnload"),db.add(pb,"load",t)):(jb.waitForWindowLoad&&yb&&m("docLoaded"),t())),d},i=function(){var a,b=jb.setupOptions;for(a in b)b.hasOwnProperty(a)&&("undefined"==typeof jb[a]?jb[a]=b[a]:jb[a]!==b[a]&&(jb.setupOptions[a]=jb[a]))},j=function(){function a(){db.remove(pb,"load",jb.beginDelayedInit)}if(m("init"),wb)return m("didInit"),!1;if(jb.html5Only)return wb||(a(),jb.enabled=!0,n()),!0;z();try{m("flashJS"),kb._externalInterfaceTest(!1),G(!0,jb.flashPollingInterval||(jb.useHighPerformance?10:50)),jb.debugMode||kb._disableDebug(),jb.enabled=!0,l("jstoflash",!0),jb.html5Only||db.add(pb,"unload",h)}catch(b){return jb._wD("js/flash exception: "+b.toString()),l("jstoflash",!1),F({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),J(!0),n(),!1}return n(),a(),!0},A=function(){return C?!1:(C=!0,i(),H(),function(){var a="sm2-usehtml5audio=",b="sm2-preferflash=",c=null,d=null,e="undefined"!=typeof console&&"function"==typeof console.log,f=qb.toLowerCase();-1!==f.indexOf(a)&&(c="1"===f.charAt(f.indexOf(a)+a.length),e&&console.log((c?"Enabling ":"Disabling ")+"useHTML5Audio via URL parameter"),jb.setup({useHTML5Audio:c})),-1!==f.indexOf(b)&&(d="1"===f.charAt(f.indexOf(b)+b.length),e&&console.log((d?"Enabling ":"Disabling ")+"preferFlash via URL parameter"),jb.setup({preferFlash:d}))}(),!eb&&jb.hasHTML5&&(jb._wD("SoundManager: No Flash detected"+(jb.useHTML5Audio?". Trying HTML5-only mode.":", enabling HTML5.")),jb.setup({useHTML5Audio:!0,preferFlash:!1})),cb(),jb.html5.usingFlash=Y(),Ib=jb.html5.usingFlash,ib(),!eb&&Ib&&(jb._wD("SoundManager: Fatal error: Flash is needed to play some required formats, but is not available."),jb.setup({flashLoadTimeout:1})),rb.removeEventListener&&rb.removeEventListener("DOMContentLoaded",A,!1),z(),!0)},bb=function(){return"complete"===rb.readyState&&(A(),rb.detachEvent("onreadystatechange",bb)),!0},B=function(){yb=!0,db.remove(pb,"load",B)},fb(),db.add(pb,"focus",x),db.add(pb,"load",u),db.add(pb,"load",B),rb.addEventListener?rb.addEventListener("DOMContentLoaded",A,!1):rb.attachEvent?rb.attachEvent("onreadystatechange",bb):(l("onload",!1),F({type:"NO_DOM2_EVENTS",fatal:!0})),"complete"===rb.readyState&&setTimeout(A,100)}var c=null;"undefined"!=typeof SM2_DEFER&&SM2_DEFER||(c=new b),a.SoundManager=b,a.soundManager=c}(window),function(){function a(a){var b=$($.trim(a));return b.appendTo("body")}function b(c,d){function g(){i>=f?h.reject("Unable to GET "+c+" after "+i+" attempts."):b(c,d)}var h=d.resolver,i=e[c]=c in e?e[c]+1:1,j={data:{attempt:i},cache:1===i};return $.ajax(c,j).then(a,g).then(h.resolve),h.promise()}function c(a,c){return function(){var e,f,h=d[a];return h||(c=$.extend({},g,c||{}),e=$.Deferred(),h=d[a]=e.promise().then(c.success),c.selector&&(f=$(c.selector)).length>0?e.resolve(f):(c.resolver=e,b(a,c))),h}}var d={},e={},f=15,g={success:function(a){return a}};$.lazy$element=function(a,b){return c(a,b)},$.fn.lazy$element=function(a,b){var d=$(this);return b=b||{},b.selector=d.selector,c(a,b)}}();var swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var c=N.length,d=0;c>d;d++)N[d]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,setTimeout(arguments.callee,10),void 0;a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;a>b;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?"ActiveX":"PlugIn",g="MMredirectURL="+J.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(c){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),e=c?/mac/.test(c):/mac/.test(b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,!i||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J.ActiveXObject!=C)try{var j=new ActiveXObject(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();return!function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&!function(){if(!R){try{K.documentElement.doScroll("left")}catch(b){return setTimeout(arguments.callee,0),void 0}a()}}()),U.wk&&!function(){return R?void 0:/loaded|complete/.test(K.readyState)?(a(),void 0):(setTimeout(arguments.callee,0),void 0)}(),c(a)))}(),!function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;a>b;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;c>d;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}(),{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return U.w3?g(a):void 0},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,i(b,q,c,n),void 0;u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}();!function(a){"use strict";var b=function(a,b){this.init("tooltip",a,b)};b.prototype={constructor:b,init:function(b,c,d){var e,f;this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,"click"==this.options.trigger?this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this)):"manual"!=this.options.trigger&&(e="hover"==this.options.trigger?"mouseenter":"focus",f="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(e+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(f+"."+this.type,this.options.selector,a.proxy(this.leave,this))),this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,b,this.$element.data()),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);return c.options.delay&&c.options.delay.show?(clearTimeout(this.timeout),c.hoverState="in",this.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show),void 0):c.show()},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),c.options.delay&&c.options.delay.hide?(c.hoverState="out",this.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide),void 0):c.hide()},show:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){switch(a=this.tip(),this.setContent(),this.options.animation&&a.addClass("fade"),f="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/in/.test(f),a.detach().css({top:0,left:0,display:"block"}).insertAfter(this.$element),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight,b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.offset(g).addClass(f).addClass("in")}},setContent:function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},hide:function(){function b(){var b=setTimeout(function(){c.off(a.support.transition.end).detach()},500);c.one(a.support.transition.end,function(){clearTimeout(b),c.detach()})}var c=this.tip();return c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?b():c.detach(),this},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(b){return a.extend({},b?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},tip:function(){return this.$tip=this.$tip||a(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);c[c.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var c=a.fn.tooltip;a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("tooltip"),f="object"==typeof c&&c;e||d.data("tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!1},a.fn.tooltip.noConflict=function(){return a.fn.tooltip=c,this}}(window.jQuery),function(a,b){if(a){var c=b.onerror,d={userAgent:b.navigator.userAgent,url:b.location.href,file:"",line:0,message:"",stack:{},more:{}},e=function(b){b=a.extend(!0,{},d,b),a.hasOwnProperty("publish")&&a.publish("glitchreport",b)},f=function(a,b,d){return e({file:b,line:d,message:a}),c?c(a,b,d):void 0},g=function(a,b,c){e({url:c.url,message:"Failed to grab url via ajax"})};b.onerror=f,a(document).ajaxError(g)}}(jQuery,window),_.mixin(_.str.exports()),_.mixin({includeString:_.str.include,reverseString:_.str.reverse}),_.mixin({hasValue:function(a){return!_.isEmpty(a)||_.isNumber(a)}}),Breakpoints.prototype.get=function(a){var b=a.match(/(<=|>)(.+)/),c=b[2],d=b[1],e=_(this._breakpoints).findWhere({name:c}),f=_(this._breakpoints).indexOf(e),g=this._published[f];return"<="==d&&(g=!g),g},Breakpoints.defaults=[{name:"mobile",value:400}],function(a){var b="ontouchstart"in window,c=10,d="click.fastclick",e="touchend.fastclick",f="touchstart.fastclick",g="touchmove.fastclick",h=d;b&&(h+=" "+e);var i=function(b){var c={x:b.originalEvent.touches[0].clientX,y:b.originalEvent.touches[0].clientY};a(this).data("touch_handled",!1).data("fastclick_start_coords",c).on(g,j).on(e,k)},j=function(b){var c={x:b.originalEvent.touches[0].clientX,y:b.originalEvent.touches[0].clientY};a(this).data("fastclick_end_coords",c)},k=function(){a(this).off(g,j).off(e,k)};a.fn.onFastClick=function(d){function e(b){var e,f,g,h,i="touchend"===b.type;return i&&(e=a(this).data("fastclick_start_coords"),f=a(this).data("fastclick_end_coords"),g=f&&(Math.abs(e.x-f.x)>c||Math.abs(e.y-f.y)>c)),g||a(this).data("touch_handled")||(b.target.blur(),h=d.call(this,b),a(this).data("touch_handled",i).removeData("fastclick_start_coords fastclick_end_coords")),"boolean"==typeof h?h:(a(this).data("touch_handled")&&"click"===b.type&&b.target==this&&b.preventDefault(),void 0)}var g=a(this),j=g.data("fastclick_handlers")||[];return j.push({handler:d,_handler:e}),g.data("fastclick_handlers",j),b&&g.on(f,i),g.on(h,e)},a.fn.offFastClick=function(c){var d=a(this),e=d.data("fastclick_handlers"),g=_(e).findWhere({handler:c}),j=_.indexOf(e,g);return e.splice(j,1),0===e.length?d.removeData("fastclick_handlers"):d.data("fastclick_handlers",e),g&&d.off(h,g._handler),b&&d.off(f,i),k.call(d),d}}($),function(){var a=$.Deferred();window.ds=window.ds||{},ds.initialize=function(){ds.templates=ds.util.precompileTemplates(),$("input, textarea").placeholder(),ds.util.initComponent(ds,["autocomplete","banner","broadcast","confirm","confirmNavigation","datagrab","eventcodeport","favicon","features","feedbackRemoval","gawatch","getStarted","headerNav","headersearch","i18n","images","inlineHelp","inputCounter","layout","linkhandler","pagination","persist","share","shortcuts","tables","toggleSection","tooltip","tracehandler","videoSection","youtubemodal"]),ds.util.initByUrls(ds,{rollover:["/release/edit","/submissions","/history"],rating:["release","wantlist","collection","contributions","ratings","stats","reviews"]}),ds.util.initByData(ds,{soundplayer:"initSoundPlayer",interactiveadmin:"interactiveAdmin"}),ds.util.initByUrls(ds,{collection:["artist","label","release","master","search","collection","purchase_feedback"],inlineEdit:["artist","label","release","master","search","wantlist","collection"],wantlist:["artist","label","release","master","search","purchase_feedback","wantlist"]}),ds.util.initComponent(ds,["slider","squish","tracklist"]),ds.util.initByUrls(ds,{addtolist:["/search","lists","artist","label","release","master"],admin:["d1m3n","env"],artist:"artist",blog:["blog"],dashboard:"my",discuss:["forums","groups","community"],explore:["explore","artist"],help:["help","support"],history:["history","update","submissions","subs"],label:"label",lists:["lists","artist","label","release","master"],marketplace:["sell","buy","marketplace","digital","mp3","shop","_feedback"],master:"master",messages:"messages",quicklist:"sell",recommendations:["release","master"],release:["artist","label","release","master"],releaselist:["wantlist","collection"],reportabuse:["/buy/","/sell/"],reviews:["/artist","/explore","/label","/release","/reviews","/user","/master"],shipping:"shipping",subform:["release/add","release/edit"],stickers:"stickers",support:["help","d1m3n","env","support"],supportNew:"support/new",supportTags:"support/view",update:["update","video_search","artist","label","lists","search"],user:["my","user","wantlist","contribut","list","manage_folders","settings"]}),window.location.pathname.length<2&&ds.util.initComponent(ds,"explore"),window.location.pathname.match("forum/thread")&&ds.util.initComponent(ds,"forum"),a.resolve(ds)},ds.initialized=a.promise()}(),$(ds.initialize),ds.features=function(){function a(){return{hasTouch:"ontouchstart"in window,isMobile:$("html").hasClass("is_mobile"),has3d:function(){var a,b=document.createElement("p"),c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(b,null);for(var d in c)void 0!==b.style[d]&&(b.style[d]="translate3d(1px,1px,1px)",a=window.getComputedStyle(b).getPropertyValue(c[d]));return document.body.removeChild(b),void 0!==a&&a.length>0&&"none"!==a}}}function b(){return{}}var c={init:function(){_.extend(this,a()),ds.bugs=b()}};return c}(),ds.content={defaultConfirm:"Are you sure?",confirmDeleteReview:"Are you certain you would like to delete this review?",reportListConfirm:'Press OK to report that this list contravenes the <a href="http://www.discogs.com/help/lists.html">Discogs List guidelines</a>.',pickedOldList:"Please select an existing list.",listTitleRequired:"Please enter a title.",formFieldErrorDefault:"Double check",formFieldAcceptDefault:"Looks good",pageDefine:{release:{title:"Release Page, Definition",definition:"The release page displays information about a release, an audio product that is made available for general public consumption."},masterRelease:{title:"Master Release Page, Definition",definition:"The master release page shows differing versions of a single conceptual release that may differ on format, label, publisher, or other information."},artist:{title:"Artist Page, Definition",definition:""},labelRelease:{title:"Label Page, Definition",definition:""},numForSale:{title:"Number for Sale Page, Definition",definition:"A page that shows a specific version of a release for sale available from various Discogs sellers."},itemDetails:{title:"Item for Sale Page, Definition",definition:"A page that lists information for an item for sale in the Discogs Marketplace. Contains limited release information from the Discogs database."},staff:{title:"Discogs Staff, Definition",definition:""}}},ds.util=ds.util||{},ds.util.initComponent=function(a,b){var c,d;if(!a||!b)return!1;if(_.isArray(b))for(c in b)b.hasOwnProperty(c)&&(d=a[b[c]],!_.isUndefined(d)&&$.isFunction(d.init)&&d.init()&&(d.initialized=!0));else void 0!==a[b]&&$.isFunction(a[b].init)&&a[b].init()&&(a[b].initialized=!0)},ds.util.stateInitd=function(){var a,b=[];for(a in ds)ds.hasOwnProperty(a)&&ds[a].initialized&&b.push(a);return b},ds.util.inUrl=function(a){return _(window.location.href).includeString(a)},ds.util.matchesSegments=function(a){var b,c;if("object"!=typeof a)return!1;for(b in a)if(a.hasOwnProperty(b)&&(!_.isString(b)||!_.isString(a[b])))return!1;if(a[0]&&!_(window.location.hostname).includeString(a[0]))return!1;c=window.location.pathname.substring(1).split("/"),c.unshift(window.location.hostname);for(b in a)if(a.hasOwnProperty(b)&&c[b]!==a[b])return!1;return!0},ds.util.initByData=function(a,b){var c,d;if("object"!=typeof b)return!1;for(c in b)if(b.hasOwnProperty(c)&&(_.isString(b[c])&&ds.datagrab.get(b[c])&&ds.util.initComponent(a,c),_.isArray(b[c].constructor)))for(d in b[c])if(b[c].hasOwnProperty(d)&&ds.datagrab.get(b[c][d])){ds.util.initComponent(a,c);break}},ds.util.initByUrls=function(a,b){var c,d;if("object"!=typeof b)return!1;for(c in b)if(b.hasOwnProperty(c)&&(_.isString(b[c])&&ds.util.inUrl(b[c])&&ds.util.initComponent(a,c),_.isArray(b[c])))for(d in b[c])if(b[c].hasOwnProperty(d)&&ds.util.inUrl(b[c][d])){ds.util.initComponent(a,c);break}},ds.util.redirect=function(a){return window.location.href=a,!1},ds.util.track=function(){var a,b=$.Deferred(),c=window._gaq||!1,d=Array.prototype.slice.call(arguments),e=["no_category","no_action","",0,!0];for(c||b.reject(),a=0;a<e.length;a++)d[a]||(d[a]=e[a]);return d.unshift("_trackEvent"),c.push(d),ga("send","event",d[1],d[2],d[3],d[4],{nonInteraction:d[5],hitCallback:b.resolve}),setTimeout(b.reject,500),b.promise()},ds.util.trackPageView=function(){window._gaq.push(["_trackPageview"]),window.ga("send","pageview")},ds.util.requireLogin=function(){var a="/login?nologin=1&return=",b=encodeURIComponent(location.pathname),c=encodeURIComponent(location.hash);ds.datagrab.get("loggedIn")||ds.util.redirect(a+b+c)},ds.util.getElementMetrics=function(a,b){if(!(a.length<1)){var c={},d=a.offset();return b&&(d=a.position()),c.height=a.outerHeight(!1),c.width=a.outerWidth(!1),c.area=c.height*c.width,d&&(c.top=d.top,c.left=d.left,c.bottom=c.top+c.height,c.right=c.left+c.width),c}},ds.util.switchMap=function(a,b){var c,d=!1;for(c in b)if(b.hasOwnProperty(c)&&a===c){b[c](),d=!0;break}!d&&b._default&&b._default()},ds.util.selectText=function(){var a,b;document.selection?(document.selection.empty(),a=document.body.createTextRange(),a.moveToElementText(this),a.select()):window.getSelection&&(b=window.getSelection(),a=document.createRange(),a.selectNode(this),b.removeAllRanges(),b.addRange(a))},ds.util.toString=function(a){return(" "+a).substring(1)},ds.util.scrollTo=function(a){var b,c,d;if(d=_.isString(a)?$("#"+a):a,!d.length&&(d=$("[name='"+a+"']"),!d.length))return!1;if(_.isNumber(d))c=d;else{if(b=d.offset(),!b)return!1;c=b.top}return _.isUndefined(c)?!1:($("html, body").animate({scrollTop:c},300),!0)},ds.util.disableFieldButSendData=function(){var a=$(this),b=a.clone(),c=a.next();b.attr({id:"",name:"",disabled:"disabled"}),c.length>0?c.before(b):a.parent().append(b),a.hide()},ds.util.precompileTemplates=function(){var a={},b=/_template$/;return $(".underscore_template").each(function(){var c=_.str.camelize(this.id.replace(b,"")),d=_.template($.trim($(this).html()));a[c]=d}),a},ds.util.errorMessageFromXHR=function(a){var b;return"application/json"===a.getResponseHeader("content-type")&&(b=$.parseJSON(a.responseText),b.message)?b.message:"An unknown error occurred (code "+a.status+")"},ds.util._alertInterior=function(a){var b="discogs_alert_message_eCTGqP16sn",c=$("#"+b);return c.length||($("body").append(['<div id="',b,'" />'].join("")),c=$("#"+b)),c.html(a),c},ds.util.alert=function(a){function b(){$(this).dialog("close")}var c=ds.util._alertInterior(a),d=[{text:"Close","class":"button",click:b}];c.discogsDialog({buttons:d,title:"Alert"})},ds.util.confirm=function(a,b,c){function d(a){return function(){g=a,e.dialog("close")}}var e,f,g=!1,h=$.Deferred(),i=h.promise();return e=ds.util._alertInterior(a||ds.content.defaultConfirm),f=[{text:"Cancel","class":"button",click:d(!1),id:"confirm_cancel_button"},{text:"Okay","class":"button button_green",click:d(!0),id:"confirm_ok_button"}],e.discogsDialog({buttons:f,title:"Confirm"}),e.on("dialogclose",function(){g?h.resolve():h.reject(),e.off("dialogclose")}),b&&i.done(b),c&&i.fail(c),i.always(function(){e.dialog("destroy").remove()}),i},ds.util.registerDelegate=function(a,b){var c,d;if(_.isString(a)&&(a=$(a)),!a.length)return!1;for(c in b)if(b.hasOwnProperty(c))for(d in b[c])b[c].hasOwnProperty(d)&&a.on(c,d,b[c][d]);return!0},ds.util.spinner=function(a){for(var b=[],c=1,d=9;d>c;c++)b.push('<div class="'+a+'_spinner_circle spinner_circle" id="spinner_circle_0'+c+'"></div>');var e=['<div id="',a,'_spinner" class="spinner">',b.join(""),"</div>"].join("");return e},ds.util.updateParams=function(a,b){var c,d,e,f,g;if(b&&(b.add||b.remove)){if(c=a.split("?"),d=c[1]?$.deparam(c[1]):{},b.add)for(e in b.add)_.has(b.add,e)&&(d[e]=b.add[e]);for(_.isArray(b.remove)||(b.remove=[b.remove]),f=0,g=b.remove.length;g>f;f++)delete d[b.remove[f]];a=(c[0]+"?"+$.param(d)).replace(/\?$/,"")}return a},ds.util.isFocused=function(){return $(document.activeElement).is("input, select, textarea")},ds.addtolist=ds.addtolist||{},ds.addtolist.init=function(){var a=$("body");return this.$modal=!1,a.on("click",".search-list-add, .lists-list-add",ds.addtolist.listAddHandler),a.on("click",".lists-list-add",function(){$.publish("addToCollWantList")}),!0},ds.addtolist.listAddHandler=function(){var a=$(this);ds.addtolist.add(a.data("list-add-what"),a.data("list-add-obid"),a.data("list-add-pos"))},ds.addtolist.toggleForm=function(){$(".listadd_new").toggle($("#listpick_new").get(0).checked),$("#listadd_old").toggle($("#listpick_old").get(0).checked)},ds.addtolist.dialogConfig={width:440,title:"Add to List"},ds.addtolist.add=function(a,b,c){return ds.util.requireLogin(),ds.addtolist.initialized||ds.util.initComponent(ds,"addtolist"),ds.addtolist.$modal||(ds.addtolist.$modal=ds.addtolist.makeModal()),ds.addtolist.$modal.dialog("close"),a&&b?($.get("/lists/add",{what:a,obid:b,styleVersion:!0},ds.addtolist.insertAndShowModal),c&&ds.util.track("artist","add_to_list_"+c),!0):!1},ds.addtolist.makeModal=function(){var a=$("<div />").hide().appendTo("body").discogsDialog(ds.addtolist.dialogConfig).on("change","#listpick_old, #listpick_new",ds.addtolist.toggleForm).on("click",".lists-list-add-save",ds.addtolist.addSave).on("click",".lists-list-add-cancel",ds.addtolist.addCancel).on("click",".close_add_to_list",ds.addtolist.close);return a},ds.addtolist.insertAndShowModal=function(a){var b=$("#act");b.hide(),ds.addtolist.$modal.html(a).show().dialog("open")},ds.addtolist.addSave=function(){var a,b,c,d,e=$("#list_comments"),f=$("#list_oldpick");if(b={what:$("#list_what").val(),obid:$("#list_obid").val()},e.val()&&(a=_.stripTags(e.val()),a=$.trim(a),a&&(b.comments=a)),$("#listpick_new:checked").length>0){if(c=$("#list_title").val(),!c)return ds.util.alert(ds.content.listTitleRequired),void 0;$("#list_description").val()&&(d=_.stripTags($("#list_description").val()),d=$.trim(d),d&&(b.description=d)),b.list="new",b.title=c}else{if(-1===f.val())return ds.util.alert(ds.content.pickedOldList),void 0;b.list=f.val()}ds.addtolist.$modal.dialog("close"),$.ajax({type:"POST",url:"/lists/addsave",data:b,success:function(a){var b=[];
_.has(a,"success")&&a.success&&_.has(a,"list_view_href")&&_.has(a,"my_lists_href")&&_.has(a,"close_button")?(b=["<p>","The item has been added.","</p>","<p>",'<a href="',a.list_view_href,'">',"View this list","</a>","<br />",'<a href="',a.my_lists_href,'">',"View my lists","</a>","</p>",'<button class="close_add_to_list" data-on-click="',a.close_button,'">',"Close","</button>"].join(""),ds.addtolist.$modal.html(b).show().dialog("open")):_.has(a,"message")&&ds.util.alert(a.message)}})},ds.addtolist.addCancel=function(){ds.addtolist.$modal.dialog("close")},ds.addtolist.close=function(){var a=$(this),b=a.data("on-click");"reload_page"===b?window.location.reload():"hide_list_panel"===b&&ds.addtolist.$modal.dialog("close")},ds.autocomplete=ds.autocomplete||{},ds.autocomplete.init=function(){return this.$fields=$(".autocomplete"),this.$fields.length<1?!1:(this.requests=[],this.keyCodes={slash:47,esc:27},this.$fields.each(function(a,b){$(b).data("valueCache",[])}),this.$fields.on("focus",ds.autocomplete.openAutocomplete),this.$form=this.$fields.parents("form").eq(0),this.makeSpinner(),$("body").on("keypress",_.bind(ds.autocomplete.focusOnField,this)).on("keydown",_.bind(ds.autocomplete.blurField,this)),!0)},ds.autocomplete.search=function(){var a=300,b=(new Date).getTime(),c=3e5;return function(){var d=(new Date).getTime(),e=this,f=e.id,g=e.value;if(_($(e).data("valueCache")).include(g))b=d;else{if(a>d-b)return setTimeout(function(){$("#"+f).autocomplete("search")},a),!1;$(e).data("valueCache").push(g),setTimeout(ds.autocomplete.makeExpireCache(e,g),c),b=d}}}(),ds.autocomplete.makeExpireCache=function(a,b){var c=a.id;return function(){var a=$("#"+c),d=a.data("valueCache");a.data("valueCache",_(d).without(b))}},ds.autocomplete.focusOnField=function(a){ds.util.isFocused()||this.keyCodes.slash!==a.keyCode||(this.$fields.focus(),a.preventDefault())},ds.autocomplete.blurField=function(a){this.$fields.is(":focus")&&this.keyCodes.esc===a.keyCode&&(this.$fields.blur(),a.preventDefault())},ds.autocomplete.openAutocomplete=function(){var a=$(this);a.data("uiAutocomplete")||(a.autocomplete({minLength:3,delay:0,search:ds.autocomplete.search,focus:ds.autocomplete.fieldFocus,select:ds.autocomplete.fieldSelect,source:ds.autocomplete.fieldSource}),a.data("uiAutocomplete")._renderItem=ds.autocomplete.fieldRenderItem),a.autocomplete("search")},ds.autocomplete.fieldFocus=function(){return!1},ds.autocomplete.fieldSelect=function(a,b){var c=$(this);return c.val(b.item.name),c.hasClass("ac_submit")&&window.open(b.item.uri,ds.subform.initialized?"_blank":"_self"),!1},ds.autocomplete.fieldSource=function(a,b){var c=$(this.element),d={url:"//"+window.location.host+"/search/ac",dataType:"json",data:{q:a.term},success:ds.autocomplete.formatData(b,c),error:function(){b([])}},e=c.attr("class").match(/ac_type_(\w+)/);e&&(d.data.type=e[1]);var f=$.ajax(d);ds.autocomplete.searching(f),ds.autocomplete.requests.push(f),f.done(ds.autocomplete.finishedSearching(f))},ds.autocomplete.formatData=function(a,b){return function(c){if(c){for(var d=0,e=c.length;e>d;d++)c[d].artist&&(c[d].artist=_.escape(c[d].artist)),c[d].title&&(c[d].title=_.escape(c[d].title));b.hasClass("ac_submit")&&c.push({type:"_just_search"}),a(c)}}},ds.autocomplete.fieldRenderItem=function(a,b){var c,d,e,f=$(this.element).val();if("_just_search"===b.type)return b.uri="/search?q="+f+"&type=all",c=$(["<li class='just_search'>","<a href='",b.uri,"'>","<i class='icon-search'></i>","Search for &ldquo;","<strong>",_.escape(f),"</strong>","&rdquo;</a></li>"].join("")),c.data("ui-autocomplete-item",{name:f}),c.appendTo(a),c;var g='<span class="format">(all versions)</span>',h='<span class="format">'+b.format+"</span>";d=['<span class="label with-sublabel">',b.title,"Master Release"==b.type?g:"Release"==b.type?h:"","</span>"].join(""),e=['<span class="sublabel">',b.type.match(/release/i)?b.artist:b.type,"</span>"].join("");var i="";b.marketplace&&(i=["<span class='release_marketplace'>","<span class='release_marketplace_quantity'>",b.marketplace.quantity,"</span>"," from ","<span class='release_marketplace_price'>",b.marketplace.currency,b.marketplace.min.toFixed(2),"</span>","</span>"].join(""));var j=ds.skittles.render(b),k=ds.images.make$thumbnail(b.thumb),l=$(['<a href="',b.uri,'">',j,d,e,i,"</a>"].join(""));return l.prepend(k),j&&l.addClass("has_skittles"),$("<li />").data("ui-autocomplete-item",b).append(l).appendTo(a)},ds.autocomplete.makeSpinner=function(){return this.$spinner=$(ds.util.spinner("autocomplete")),this.$form.append(this.$spinner),this.$spinner},ds.autocomplete.searching=function(a){this.$spinner||this.makeSpinner();var b=this.$form;a.delayedNotification=setTimeout(function(){b.addClass("searching")},200)},ds.autocomplete.finishedSearching=function(a){return _.bind(function(){clearTimeout(a.delayedNotification),_(this.requests).last()==a&&(this.$form.removeClass("searching"),this.requests.length=0)},ds.autocomplete)},ds.banner=ds.banner||{},ds.banner.init=function(){this.banners=["release","artist","master_release","label_release","num_for_sale","item_details","staff"];var a,b,c;for(a=0;a<this.banners.length;a++)if(b=$("."+this.banners[a]+"_banner"),b.length)return this.$banner=b,c=ds.content.pageDefine[_.camelize(this.banners[a])],this.definition=c.definition,this.title=c.title,this.$banner.click(this.showDefinition),!0},ds.banner.showDefinition=function(){var a=$(".banner_definition_modal");a.length||($("body").append('<div class="banner_definition_modal">'+ds.banner.definition+"</div>"),a=$(".banner_definition_modal")),a.discogsDialog({title:ds.banner.title})},ds.broadcast=ds.broadcast||{},ds.broadcast.init=function(){var a=$("body");return a.on("submit",".broadcast_widget form",this.clickShare),a.on("click",".broadcast_widget_undo",this.clickUndo),a.on("click",".broadcast_remove",this.clickRemove),!0},ds.broadcast.clickShare=function(a){var b=$(this).find(".broadcast_actions_share");b.html(ds.templates.broadcastWidgetShareSharing()),$.ajax({url:"/broadcast/new",type:"POST",data:$(this).serialize(),success:function(){b.html(ds.templates.broadcastWidgetShareComplete())},error:function(a){ds.util.alert(ds.util.errorMessageFromXHR(a)),b.html(ds.templates.broadcastWidgetShare())}}),a.preventDefault()},ds.broadcast.clickUndo=function(a){var b=$(this).parents("form"),c=b.find(".broadcast_actions_share");c.html(ds.templates.broadcastWidgetShareUnsharing()),$.ajax({url:"/broadcast/delete",type:"POST",data:b.serialize(),success:function(){c.html(ds.templates.broadcastWidgetShare())},error:function(a){ds.util.alert(ds.util.errorMessageFromXHR(a)),c.html(ds.templates.broadcastWidgetShareComplete())}}),a.preventDefault()},ds.broadcast.clickRemove=function(a){var b=this;"remove"===$(this).data("action")?ds.util.confirm("Are you sure you want to un-share this?",function(){ds.broadcast.remove.call(b)}):"unfollow"===$(this).data("action")&&ds.util.confirm("Remove <strong>"+$(this).data("username")+"</strong> from your friends list?",function(){ds.broadcast.unfollow.call(b)}),a.preventDefault()},ds.broadcast.remove=function(){var a=$(this).data("type"),b=$(this).data("object-id"),c=$(this).data("timestamp"),d=$(this).parents("tr");$.ajax({url:"/broadcast/delete",type:"POST",data:{type:a,object_id:b,timestamp:c},success:function(){d.addClass("broadcast_removed")},error:function(a){ds.util.alert(ds.util.errorMessageFromXHR(a))}})},ds.broadcast.unfollow=function(){var a=$(this).data("uid");$.ajax({url:"/broadcast/unfollow",type:"POST",data:{uid:a},success:function(){$(".broadcast_unfollowable.broadcast_from_u"+a).parents("tr").addClass("broadcast_removed")},error:function(a){ds.util.alert(ds.util.errorMessageFromXHR(a))}})},ds.confirm=function(){function a(a){function b(){c.data("confirmed",!0),setTimeout(function(){a.click()},25)}var c=$(a),d=c.data("confirm-message");return ds.util.confirm(d).then(b)}function b(){var b=!!$(this).data("confirmed");return b||a(this),b}var c={init:function(){return $("body").on("click",".confirm",b),!0}};return c}(),ds.confirmNavigation={init:function(){var a=$(".confirm_navigation");$(".confirm_navigation")&&(ds.confirmNavigation.changed=a.hasClass("confirm_navigation_dirty"),a.find(":input").change(function(){ds.confirmNavigation.changed=!0}),a.submit(function(){ds.confirmNavigation.changed=!1}),$(window).on("beforeunload",ds.confirmNavigation.checkChanged))},checkChanged:function(){return ds.confirmNavigation.changed?"WARNING: You have unsaved changes.":void 0}},$(function(){function a(){var a=$(".copy_shortcut_code",this).get(0);ds.util.selectText.call(a)}$(".copy_shortcut").on("click",a)}),ds.datagrab=ds.datagrab||{},ds.datagrab.init=function(){return this.data="undefined"!=typeof dsdata?$.extend(!0,{},dsdata()):{},$("#dsdata").remove(),!_.isEmpty(this.data)},ds.datagrab.get=function(a){return _.has(this.data,a)?this.data[a]:!1},function(){var a={modal:!0,draggable:!1,resizable:!1,width:400};$.fn.discogsDialog=function(b){function c(){$(".ui-dialog-titlebar-close",h.dialog("widget")).html("<i class='icon-remove'></i>").blur()}function d(){h.dialog("close")}function e(a){c(),b.modal&&$("body").on("click.discogs_dialog",".ui-widget-overlay",d),_.isFunction(a)&&a()}function f(a){b.modal&&$("body").off("click.discogs_dialog",".ui-widget-overlay",d),_.isFunction(a)&&a()}var g=_.clone(a);$("html").hasClass("is_mobile")&&(g.width=$(window).width()),b=_.extend(g,b||{});var h=$(this),i=h.data("title");return i&&!b.title&&(b.title=i),b.open=_.isFunction(b.open)?_.wrap(b.open,e):e,b.close=_.isFunction(b.close)?_.wrap(b.close,f):f,h.dialog(b),h},$.fn.saveDialog=function(a){var b=$(this),c=a.saveClickHandler;delete a.saveClickHandler;var d=function(){b.dialog("close")};return a.buttons=[{text:"Save","class":"button button_green",click:c},{text:"Cancel","class":"button",click:d}],b.discogsDialog(a),b}}(),ds.eventcodeport=ds.eventcodeport||{},ds.eventcodeport.init=function(){var a,b,c;return this.queryKeyValue=$.deparam.querystring(),_.has(this.queryKeyValue,"ev")?(a=this.queryKeyValue.ev,b=this.getLookupTable(),_.has(b,a)?(c=b[a],ds.util.track("Marketplace",c),!0):(ds.util.track("Unknown","event code: "+a),!1)):!1},ds.eventcodeport.getLookupTable=function(){return{mw:"Viewed /sell/mywants",we:"Clicked link in wantlist email",rp:"Clicked X for sale on Release page",ap:"Clicked X for sale on Artist page",ca:"Created account",va:"Verified account",sf:"Seller facet",se:"Search Marketplace",sc:"Clicked more from this seller on cart",sp:"Viewed /seller page",sr:"Clicked marketplace tab in search results",r2:"Clicked x for sale on Release page, position 2, below contributor",a2:"Clicked x for sale on Artist page, position 2, below profile",l2:"Clicked x for sale on Label page, position 2, below profile",rb:"Release - X for sale, button",ab:"Artist - X for sale, button",lb:"Label - X for sale, button",is:'Clicked "Items For Sale" on release page (when none of this version are for sale)',"item-vc":"View release details, from item page","item-mc":"More copies for sale, from item details page","fe-lf":"feedback reminder email - leave feedback","fe-mfs":"feedback reminder email - more for sale from seller",rr:"Clicked Recommended Release on Release Page",idrec:"Clicked Recommended Release on Item Details",crec:"Clicked Recommended Release on Cart",rr2:"Clicked More Recommendations from release page",idrec2:"Clicked More Recommendations from item details",bp_img:"Clicked release image on mp browse page",bp_titl:"Clicked release title on mp browse page",bp_det:"Clicked details link on mp browse page",atc_br:"Clicked Add to Cart on mp browse page",atc_det:"Clicked Add to Cart on mp item details page",atc_det2:"Clicked Add to Cart on mp item details page - bottom",mb:"clicked x for sale on MR page",n2m:"Clicked X For Sale on Master nav2",wh:"Clicked link in wantlist email - HTML format",vc_h:"Clicked View Cart Icon in site header",vc_b:"Clicked View Cart site body",mmhub:"Clicked create account on marketplace marketing hub",br3:"Viewed X For Sale Release New 2",hxiiw:"Clicked Has X Items I Want",atc_rel_br:"Clicked Add to Cart on mp browse release page",mphome:"Viewed Marketplace main page",bp_rel_det:"Clicked details on mp browse release page",mrb:"Mobile Release For Sale",mab:"Mobile Artist For Sale",mlb:"Mobile Label For Sale",wsim:"My Wantlist - Show items in marketplace",mrr:"Clicked Recommended Release on Master Page",wfs:"View other users wantlist for sale",rci:"Viewed product page from modified-cart items",rce:"Viewed cart from removed item email",ina_r:"Item Not Available Release",ina_m:"Item Not Available Master"}},ds.favicon=ds.favicon||{init:function(){var a=ds.datagrab.get("staticServer"),b=(a?a:"")+"/images/favicon@32.png";return window.devicePixelRatio>1&&_.defer(function(){$("head link[rel=icon]").attr("href",b)}),!0}},ds.feedbackRemoval={init:function(){var a=$("div.feedback_removal_request_form");return this.orderList=".orders_list",this.orderData=".order_data",this.orderFeedback=this.orderData+".order_feedback",this.orderFeedbackUser=this.orderData+".order_feedback_user",this.orderFeedbackReply=this.orderData+".order_feedback_reply",this.urlNew="/sell/feedback_removal_request/new",this.urlCreate="/sell/feedback_removal_request/create",this.OTHER_REASON_VALUE=33,a.length&&$.get(this.urlNew).done(_.bind(function(b){_.each(a,_.bind(this.initForm,this,b)),ds.inputCounter.init()},this)),!0},initForm:function(a,b){var c=$(b);c.data.orders=a.form.internal_data.orders,this.renderForm(c,a.form),this.registerOtherReasonToggle(c),this.registerOrdersAutocomplete(c),this.registerSubmit(c)},registerOtherReasonToggle:function(a){a.find("input[name=reason]").on("click",_.bind(function(a){$("#other_reason_label").toggle(a.target.value==this.OTHER_REASON_VALUE)},this))},registerOrdersAutocomplete:function(a){var b=this.getOrdersList(a.data.orders),c=a.find(this.orderList);if(c.length){var d={minLength:0,source:b,focus:_.bind(function(a,b){return c.val(b.item.value),!1},this),select:_.bind(function(b,d){return c.val(d.item.value),this.updateOrderData(a,d.item),!1},this)};c.data("uiAutocomplete")&&c.data("uiAutocomplete").destroy(),c.autocomplete(d),c.data("uiAutocomplete")._renderItem=this.renderOrders,c.data("uiAutocomplete")._renderMenu=this.renderOrderMenu,c.on("focus",function(){$(this).data("uiAutocomplete").search($(this).val()||"")}),c.on("blur",_.bind(this.updateOrderData,this,a,{}))}},registerSubmit:function(a){var b=a.find("button[type=submit]");b.on("click",_.bind(function(a,b){b.preventDefault();var c=this.serializeFeedbackForm(a);$.post(this.urlCreate,c).done(_.bind(this.registerFormSuccess,this,a)).fail(_.bind(this.registerFormFailure,this,a))},this,a))},renderForm:function(a,b){return b.url=this.urlCreate,a.html(_.template($("#feedback_removal_request_template").html(),b)),!0},renderFormErrors:function(a,b){b=b||{};var c=a.find(".form_error"),d=!1;c.html(""),$.isEmptyObject(b)||_.each(b,function(a,b){var c=$("#"+b+"_errors");a.length&&c.length&&(d=!0,c.html(a.join("; ")))}),c.toggle(d)},registerFormFailure:function(a,b){var c=JSON.parse(b.responseText).form.errors||{};a.find("#global_errors.form_error"),this.renderFormErrors(a,c)},registerFormSuccess:function(a){var b=a.find(this.orderList).val(),c=a.find("span#success_message");this.clearForm(a),c.show(),setTimeout(function(){c.fadeOut(1e3)},4e3),b.length&&(delete a.data.orders[b],this.registerOrdersAutocomplete(a))},clearForm:function(a){this.renderFormErrors(a),a.find("input[type=text]").val(""),a.find("input").filter(":checked").prop("checked",!1),this.updateOrderData(a)},serializeFeedbackForm:function(a){var b=a.find(this.orderList).val(),c=a.find("input[type=radio]").filter(":checked").val(),d=a.find("input#other_reason").val();return{order_id:b,reason:c,other_reason:d}},updateOrderData:function(a,b){if($.isEmptyObject(b)){var c=a.find(this.orderList).val();b=a.data.orders[c]}if(!$.isEmptyObject(b)){var d=b.reply?b.reply:"N/A";a.find(this.orderFeedback).html(["<b>Feedback</b>: ",_.escape(b.feedback)].join("")),a.find(this.orderFeedbackUser).html(b.html.feedback_user_link),a.find(this.orderFeedbackReply).html(["<small>","<b>Reply</b>: ",_.escape(d),"</small>"].join(""))}a.find(this.orderData).toggle($.isEmptyObject(b)?!1:!0)},renderOrderMenu:function(a,b){var c,d=this;a.attr("style","max-height: 400px; overflow-y: auto; overflow-x: hidden;"),$.each(b,function(b,e){e.category!==c&&(a.append(["<li class='ui-autocomplete-category'>",_.string.capitalize(e.category),"</li>"].join("")),c=e.category),d._renderItem(a,e)})},renderOrders:function(a,b){var c,d,e;return c=['<span class="label with-sublabel">',b.label,"</span>"].join(""),d=['<span class="sublabel">',b.sublabel,"</span>"].join(""),e=["<a>",c,d,"</a>"].join(""),$("<li />").data("ui-autocomplete-item",b).append(e).appendTo(a)},getOrdersList:function(a){return _.map(a,function(a,b){var c=["rating ",a.rating.toLowerCase()].join(""),d=[' <span class="',c,'">(',a.rating,")</span> "].join("");return a.id=b,a.value=b,a.label=[b," - ",_.escape(a.feedback_user),d].join(""),a.sublabel=_.escape(a.feedback),a})}},ds.gawatch=ds.gawatch||{},ds.gawatch.init=function(){var a,b,c,d=$(".alert_message");return d.length?(a=["accept","info","warning","error"],d.each(function(){var d=$(this);for(c="none",b=0;b<a.length;b++)d.hasClass(a[b])&&(c=a[b]);ds.util.track("view_alert_message",window.location.path,_.clean(c+": "+d.text().replace(/[^a-z0-9 ]/gi,"")))}),!0):!1},ds.headerNav=function(){function a(){return $("html").hasClass("is_mobile")&&$("html").hasClass("needs_reduced_ui")}function b(c){function d(a,b){b!=this.$group.attr("id")&&this.close()}this.$group=$(c),this.id=this.$group.data("id"),this.$link=this.$group.find("> a"),this.opened=!1,this.namespace=_(b.eventType.split(" ")).map(function(a){return a+"."+c.id}).join(" ");var e="#site_nav_tray_"+this.id+", #site_nav_submenu_"+this.id,f="/nav_tray/"+this.id;ds.datagrab.get("loggedIn")&&ds.datagrab.get("username")&&(f+="?username="+encodeURIComponent(ds.datagrab.get("username")));var g=this;this.lazy$submenu=$(e).lazy$element(f,{success:function(c){var d="";return c.parent().is("body")&&(g.$link.off(b.lazyloadEventType),d=a()&&"mobile"==ds.layout.mode()?"#section_nav_marketplace":"#site_header",c.appendTo(d)),g.$submenu=c}}),this.$link.on(b.lazyloadEventType,_.bind(this.lazy$submenu,this)).onFastClick(_.bind(this.toggle,this)),$("body").on("open.navgroup",_.bind(d,this))}function c(a){function b(b){var c="mouseenter"==b.type?"show":"hide";a.tooltip(c)}return 1===a.length&&a.find(".user_image_border").on("mouseenter",b).on("mouseleave",b),a}var d={},e={};return b.lazyloadEventType="mouseenter.navgroup_lazyload",b.eventType="click",ds.features.hasTouch&&(b.eventType+=" touchend",b.lazyloadEventType+=" touchstart.navgroup_lazyload"),b.prototype={open:function(){this.opened=!0,this.listenToOutside();var a=this.$group.attr("id"),b=this.render();return b.then(function(){$("body").trigger("open.navgroup",a)}),b},close:function(){return this.opened=!1,this.forgetOutside(),this.render()},render:function(){var a=this.opened;return $([this.$group,this.$link]).toggleClass("opened",a),this.lazy$submenu().then(function(b){return b.toggleClass("opened",a)})},toggle:function(a){return a.preventDefault(),this.opened?this.close():this.open()},listenToOutside:function(){function b(a){var b=!$(a.target).closest(this.$group).length,c=!$(a.target).closest(this.$submenu).length;b&&c&&this.close()}var c,d=this;a()||$("body").on(this.namespace,_.bind(b,this)),c=function(a){var b,c=$(a.target).closest("a")[0];c!=d.$link[0]&&(b=$(c).parent(".site_nav_group").data("id"),d.close().then(function(){e[b].open()}))},setTimeout(function(){$(".site_nav_group").on("mouseenter.browsing","> a",c)},10)},forgetOutside:function(){$("body").off(this.namespace),$(".site_nav_group").off("mouseenter.browsing","> a")}},d.init=function(){function d(){$("#activity_menu_placeholder").append(j,$("#site_nav_submenu_account")),j.find(".button").removeClass("button button_green"),$("#site_navigation_placeholder").append(i)}function f(){$("#site_search").after(i,j)}function g(a){this.blur();var b=h.hasClass("visible"),c=function(a){h.toggleClass("visible",a),setTimeout(function(){$("#site_header_wrap").toggleClass("mobile_nav_visible",a)},0)};_.defer(c,!b),document.activeElement!=document.body&&document.activeElement.blur(),a.preventDefault()}var h=$("#mobile_site_navigation"),i=$("#site_navigation"),j=$("#activity_menu");$(".site_nav_group").each(function(a,c){var d=new b(c);e[d.id]=d}),a()&&($(window).on("breakpoint<=mobile",d).on("breakpoint>mobile",f),$("body").on("open.navgroup",function(a,b){var c=$("#"+b),d=c.offset().top+c.height()<$(document).scrollTop();d&&_.defer(ds.util.scrollTo,c)})),$("html").hasClass("is_mobile")&&c($("#site_account_wrap")),$("#mobile_site_navigation_toggle").onFastClick(g)},d}(),ds.headersearch={init:function(){function a(a){a&&a.preventDefault(),window.open(h.attr("action")+"?"+h.serialize(),ds.subform.initialized?"_blank":"_self")}function b(a){var b=27===a.keyCode;b&&(g.val().length>0?g.val(""):g.blur())}function c(){return document.activeElement===g.get(0)}function d(){$("#site_header").toggleClass("search_focused",c())}function e(){d(),setTimeout(function(){g.autocomplete("search")},f+25),g.on("keydown",b)}var f=200,g=this.$search=$("#search_q"),h=g.closest("form");if(h.on("submit",a),g.removeClass("init"),c()&&e(),g.on("focus",e).on("blur",function(){d(),g.off("keydown",b)}),$("#do_site_search").on("mousedown touchstart",function(b){var c={x:b.clientX,y:b.clientY},d=10;$("body").on("mouseup touchend.tracking_movement",function(b){var e,f={x:b.clientX,y:b.clientY};$("body").off("mouseup touchend.tracking_movement"),Math.abs(c.x-f.x)<=d&&Math.abs(c.y-f.y)<=d&&(e=$(b.target).closest("#do_site_search").length>0,a(e?b:void 0))})}),$("html").hasClass("is_mobile needs_reduced_ui")){var i=g.attr("placeholder");$(window).on("breakpoint<=mobile",function(){var a="Search Discogs";g.attr("placeholder",a)}),$(window).on("breakpoint>mobile",function(){g.attr("placeholder",i)})}return g.length>0}},ds.i18n=ds.i18n||{init:function(){var a=$("#i18n_select");return a.on("change",this.updateLanguage),a.length>0},updateLanguage:function(){var a=$(".language:checked").val();$.cookie("language",a,{path:"/",expires:365}),window.location.reload()}},ds.images=function(){var a={},b={size:"small",orientation:"portrait"},c=function(a,c,e,f){var g=$(document.createElement(c?"a":"div"));e=e||b.size,f=f||b.orientation;var h=["thumbnail_link","thumbnail_size_"+e,"thumbnail_orientation_"+f];return c&&g.attr("href",c),g.addClass(h.join(" ")),g.html(["<span class='thumbnail_border'></span>","<span class='thumbnail_center'>","<img src='",a,"' />","</span>","</span>"].join("")),g.find("img").on("load.set_orientation",d(g)),g};a.make$thumbnail=c;var d=function(a){return function(){var b=$(this),c=b.width()>b.height();a.toggleClass("thumbnail_orientation_portrait",!c).toggleClass("thumbnail_orientation_landscape",c),b.off("load.set_orientation")}},e=function(){$(".thumbnail_orientation_auto").each(function(){$(this).find("img").on("load.set_orientation",d($(this)))})};return a.init=function(){return e(),!0},a}(),ds.inlineHelp=ds.inlineHelp||{},ds.inlineHelp.init=function(){this.containerSelector=".inline-help-container",this.dataContainerClass="inline-help-data",this.dataContainerSelector="."+this.dataContainerClass,this.animationSpeed=100,this.dataAttributeName="inline-help";var a=$(this.containerSelector);a.length>0&&_.each(a,_.bind(this.initializeContainer,this))},ds.inlineHelp.isHidden=function(a){return a.is(":hidden")},ds.inlineHelp.toggle=function(a,b){1==arguments.length&&(b=this.isHidden(a)),b?a.fadeIn(this.animationSpeed):a.fadeOut(this.animationSpeed)},ds.inlineHelp.initializeContainer=function(a){var b=$(a);b.data(this.dataAttributeName,{update:_.bind(this.update,this,b),toggle:_.bind(this.toggle,this,b),show:_.bind(this.toggle,this,b,!0),hide:_.bind(this.toggle,this,b,!1)}),0===b.find(this.dataContainerSelector).length&&b.html(this.renderDataContainer()),b.data(this.dataAttributeName).update()},ds.inlineHelp.update=function(a){this.search(a)},ds.inlineHelp.renderDataContainer=function(){return["<ul class='",this.dataContainerClass,"'></ul>"].join("")},ds.inlineHelp.elementType=function(a){return a?a.get(0).tagName.toLowerCase():void 0},ds.inlineHelp.renderItemList=function(a,b){var c="<"+b+">",d="</"+b+">";if(a.length){a=_.sortBy(a,"display_order");var e=_.map(a,function(a){return a.hasOwnProperty("rendered_as")?a.rendered_as:void 0});return _.map(e,function(a){return a&&a.hasOwnProperty("html")?[c,a.html,d].join(""):""}).join("")}return[c,"No help results available",d].join("")},ds.inlineHelp.renderItems=function(a,b){var c=a.find(this.dataContainerSelector),d=this.elementType(c),e="";a.data(this.dataAttributeName).numItems=b.length,"ul"==d?e="li":"div"==d&&(e="span");var f=this.renderItemList(b,e);c.fadeOut(this.animationSpeed,_.bind(function(){c.html(f),c.fadeIn(this.animationSpeed)},this)),this.toggle(a,!0)},ds.inlineHelp.searchURL=function(){return"/help/inline/search"},ds.inlineHelp.search=function(a,b){b=b||{};var c=b.searchOptions||this.getSearchOptions(a),d=this.searchURL();(b.force||c.tags||c.slug_id)&&$.get(d,this.getSearchOptions(a),_.bind(this.renderItems,this,a))},ds.inlineHelp.getSearchOptions=function(a){var b=a.attr("data-tags"),c=a.attr("data-item-type"),d=a.attr("data-action"),e=a.attr("data-slug-id"),f={renderers:"html"};return b&&(f.tags=b),c&&(f.item_type=c),d&&(f.action=d),e&&(f.slug_id=e),f},ds.inputCounter={init:function(){var a=$(".countable");_.each(a,this.initInput,this)},initInput:function(a,b){var c=$(a);if(c.data("input-counter"))return!1;var d=this.addCounterSpan(c,b);c.data("inputCounter",!0),c.on("keyup keydown",_.bind(this.renderCounter,this,c,d)),this.renderCounter(c,d)},addCounterSpan:function(a,b){var c="input_counter_"+(a.attr("id")||b),d=$('<span id="'+c+'" class="input_counter" style="margin: 5px 5px;" />');return a.after(d),d},getCounterText:function(a){var b=a.attr("maxlength"),c=b?"/"+b:"";return a.val().length+c},renderCounter:function(a,b){b.text(this.getCounterText(a))}},ds.interactiveadmin=ds.interactiveadmin||{},ds.interactiveadmin.init=function(){return $(document).keyup(this.dialog),$("body").on("click",".remove_review",this.removeReview),$("#dev").length>0},ds.interactiveadmin.dialog=function(a){65===a.which&&(a.altKey||a.shiftKey&&a.ctrlKey)&&($("#dialog").discogsDialog({width:872,height:458,title:"Discogs Admin"}),$("#userLookup").focus())},ds.interactiveadmin.removeReview=function(a){var b=$(this),c=b.closest(".review"),d=c.data("cid"),e=ds.datagrab.get("interactiveAdmin:deleteReviewPath");ds.util.confirm(ds.content.confirmDeleteReview,function(){$.ajax({type:"delete",url:e+d}),c.fadeOut().promise().then(function(){c.remove()})}),_.defer(function(){$(".ui-dialog-buttonset").find("button:last").focus()}),a.preventDefault()},ds.layout=function(){var a=[{name:"mobile",value:600},{name:"desktop",value:800}],b={init:function(){return this.breakpoints=new Breakpoints(a),ds.initialized.then(function(){$("html").hasClass("is_mobile")&&$(window).scrollTop()<=100&&scrollTo(0,0)}),ds.initialized.then(this.breakpoints.measure),$("#layout_buttons").on("click","a",this.changeLayout),$("#mobile_layout").on("click",this.changeMobileLayout),$("#footer_menu_link").onFastClick(this.toggleFooterMenu),!0},changeLayout:function(){function a(){b===this?$(this).attr("disabled","disabled"):$(this).removeAttr("disabled")}var b=this;return _.defer(function(){$("#layout_buttons a").each(a)}),!0},selectLayout:function(a){return this.changeLayout.call($("#layout_buttons a[data-size='"+a+"']").get(0))},changeMobileLayout:function(){var a=ds.persist.get("wants_reduced_ui")?!1:!0;ds.persist.updateAt("wants_reduced_ui",a),window.location.reload()},toggleFooterMenu:function(){return $(window).scrollTop($("#site_footer_list").toggle().offset().top),$(this).toggleClass("expanded"),!1},mode:function(){return this.breakpoints.get("<=mobile")?"mobile":"desktop"}};return b}(),ds.linkhandler=ds.linkhandler||{},ds.linkhandler.init=function(){var a=$("body");return a.on("click","a.new_window, a.new-window",this.clickNewWindow),a.on("click","a.helptitle",this.clickHelpTitle),a.on("click",'a[href^="#"]',this.clickHashLink),a.on("click","a.close_window",this.clickCloseWindow),!0},ds.linkhandler.clickNewWindow=function(){$(this).attr("target","_blank")},ds.linkhandler.clickCloseWindow=function(){window.close()},ds.linkhandler.clickHelpTitle=function(){var a=$(this).data("helptitle-page"),b="/help/"+a+".html?f=popup&notitle=1",c=_.humanize(a),d=$('<iframe height="486" width="772" frameborder="0" />');d.attr("src",b),$("<div />").append(d).appendTo("body").discogsDialog({minHeight:500,minWidth:800,resizable:!0,draggable:!0,title:"Help - "+c})},ds.linkhandler.clickHashLink=function(a){var b,c,d=this.href;b=d.split("#"),c=b[1],c&&(ds.util.scrollTo(c)&&a.preventDefault(),_.delay(function(){window.location.hash=c},350))},ds.lookup=function(){function a(a){this.query=$.trim(a.query),this.type=a.type,this.$field=a.$field,a.name&&(this.name=a.name),this.directSearchTemplate=_.template("/search?q=<%= encodeURIComponent(query) %>&type=<%= type %>"),this.resultItemTemplate=ds.templates.resultItem,this.dialogTemplate=_.template(["<p>",'<input type="text" id="lookup_search_field" value="<%= query %>" placeholder="Search for <%= _(type).capitalize() %>" />','<a href="/search?q=<%= encodeURIComponent(query) %>&type=<%= type %>" target="_blank" data-placement="left" id="lookup_direct_search" rel="tooltip" title="Search In New Window">',"Search","</a>","</p>",'<div id="lookup_results" class="result_item_size_small"></div>'].join("")),this.dialogOptions={title:_(this.type+" Lookup").capitalize(),position:{my:"left top",at:"right top",of:this.$field},maxHeight:500,close:a.close,beforeClose:_.bind(this.beforeCloseHandler,this)};var b="lookup_dialog";return a.name&&(b=this.name+"_"+b),this.$element=$("<div class='searching' />").attr("id",b),this.render(),this.$element.tooltip({selector:"a[rel='tooltip']"}),this.setQuery(a.query),this.bind(),this}function b(a){var b,d,e=this;return b={dataType:"jsonp",cache:!0},a?a=ds.util.updateParams(a,{remove:"callback"}):(a=ds.datagrab.get("apiServer")+"/database/search",b.data={q:this.query,per_page:25,type:this.type}),d=$.ajax(a,b).then(c(["title","description"])),d.then(function(a){return e.lastResponse=a,a.data.results}).then(function(a){e.renderResults(a)}),d}function c(a){return function(b){return _(b.data.results).each(function(b){_(a).each(function(a){return _.has(b,a)&&(b[a]=_.escape(b[a])),b[a]})}),b}}function d(a){function b(){var b=a.scrollTop(),c=10,d=a[0].scrollHeight-b<a.outerHeight()+c,e=0===b;a.data("atBottom",d),a.data("atTop",e)}function c(){b(),a.data("atBottom")&&a.trigger("scrollbottom"),a.data("atTop")&&a.trigger("scrolltop")}return a.data("trapped",!1),b(),a.on("mouseenter.trapped",function(){a.data("trapped")||($(window).on("DOMMouseScroll.trapped mousewheel.trapped",function(c){var d;c.originalEvent&&(c.originalEvent.wheelDelta&&(d=c.originalEvent.wheelDelta/-40),c.originalEvent.deltaY&&(d=c.originalEvent.deltaY),c.originalEvent.detail&&(d=c.originalEvent.detail));var e=0>d?"up":"down";return"down"==e&&a.data("atBottom")||"up"==e&&a.data("atTop")?(b(),!1):void 0}),a.on("mouseleave.trapped",function(){$(window).off("DOMMouseScroll.trapped mousewheel.trapped"),a.off("mouseleave.trapped").data("trapped",!1)}),a.data("trapped",!0))}),a.on("scroll.trapped",c)}function e(a){return $(window).off("DOMMouseScroll.trapped mousewheel.trapped"),a.off("scroll.trapped mouseenter.trapped mouseleave.trapped").removeData("trapped atBottom atTop")}function f(b){var c=$(b),d=$("#"+c.data("for"));return h.dialog=new a({$field:d,query:d.val(),type:c.data("type"),name:c.data("name"),close:function(){delete h.dialog}})}function g(){return f(this),!1}var h={init:function(){return $("body").on("click",".lookup_button",g),!0
}};return h.LookupDialog=a,_.extend(a.prototype,{valid:function(a){return a.length>2},setQuery:function(a){return this.query=$.trim(a),this.searchedQuery!==this.query&&this.valid(this.query)?this.search():!1},search:function(){return this.renderDirectSearch(),this.searchedQuery=this.query,this.$element.addClass("searching"),this.request()},request:_.throttle(b,1e3),loadNextPage:function(){var a=this.lastResponse.data.pagination.urls.next;return a?(this.$element.addClass("searching"),this.request(a)):this},render:function(){this.$element.html(this.dialogTemplate(this)),this.$results=$("#lookup_results",this.$element),this.renderDirectSearch(),this.$element.discogsDialog(this.dialogOptions);var a=$(ds.util.spinner("lookup"));return this.$element.append(a),this},renderDirectSearch:function(){var a=$("#lookup_direct_search",this.$element);return a.attr("href",this.directSearchTemplate(this)),0===a.parents(".ui-dialog-titlebar").length&&this.$element.find(".ui-dialog-titlebar").append(a),this},renderResults:function(a){return 1===this.lastResponse.data.pagination.page&&this.$results.html(""),0===a.length?this.$results.html("No results found."):this.$results.append(_(a).map(this.resultItemTemplate)),1===this.lastResponse.data.pagination.page&&this.$results.stop().scrollTop(0),this.$element.removeClass("searching"),this},choose:function(a){return this.$field.val(a),this.close(),this},close:function(){return this.unbind(),this.$element.dialog("close"),this},beforeCloseHandler:function(){var a=this.$field;setTimeout(function(){a.focus()},10),this.$element.dialog("destroy"),this.$element.remove()},makeClickHandler:function(){function a(a){return 0===$(a.target).closest("a[target='_blank']").length?(b.choose($(this).data("value")),!1):void 0}var b=this;return a},inputHandler:function(a){this.setQuery(a.target.value)},keypressHandler:function(a){if(a.keyCode===$.ui.keyCode.DOWN)this.move("down");else if(a.keyCode===$.ui.keyCode.UP)this.move("up");else if(a.keyCode===$.ui.keyCode.ENTER){var b=this.getActiveResult();b.length>0&&this.choose(b.data("value"))}},getActiveResult:function(){return this.$results.find(".result_item_active")},move:function(a){var b,c,d,e,f="down"==a?"next":"prev",g="down"==a?"first":"last",h=this.getActiveResult();return h.length>0?(h.removeClass("result_item_active"),b=h[f]()):b=this.$results.find(".result_item")[g](),b.length>0&&(b.addClass("result_item_active"),d=b.height()+1,c=b.position().top,c+d>this.$results.height()?e=this.$results.scrollTop()+c:0>c&&(e=Math.max(this.$results.scrollTop()+Math.min(c,0-this.$results.height()+d),0)),_.isUndefined(e)||this.$results.stop().animate({scrollTop:e},{duration:100})),this},bind:function(){return this.$element.on("click.lookup_dialog",".result_item",this.makeClickHandler()),$("#lookup_search_field").on("change.lookup_dialog keyup.lookup_dialog",_.bind(this.inputHandler,this)),d(this.$results),this.$results.on("scrollbottom.lookup_dialog",_.bind(this.loadNextPage,this)),$("#lookup_search_field").on("keydown.lookup_dialog",_.bind(this.keypressHandler,this)),this},unbind:function(){return this.$element.off("click.lookup_dialog"),this.$element.find("#lookup_search_field").off("change.lookup_dialog keyup.lookup_dialog"),this.$results.off("scrollbottom.lookup_dialog"),e(this.$results),$("#lookup_search_field").off("keydown.lookup_dialog"),this}}),h}(),ds.pagination={init:function(){return $("#pjax_container").length>0&&($(document).on("pjax:end",ds.util.trackPageView),$(document).pjax(".pagination a","#pjax_container",{timeout:4e3})),$(".pagination select").each(this.restoreValue).on("change",this.submitOnChange),!0},restoreValue:function(a,b){var c=$("option[selected]",b).val();c&&c!==b.value&&(b.value=c)},submitOnChange:function(){$(this).closest("form").submit()}},ds.persist=ds.persist||{},ds.persist.cookieName="dsjspersist",ds.persist.storage={},ds.persist.rawCookie="",ds.persist.init=function(){return ds.persist.setStorageFromCookie(),!0},ds.persist.get=function(a){var b=ds.persist;return b.initialized||ds.util.initComponent(ds,"persist"),_.has(b.storage,a)?b.storage[a]:!1},ds.persist.update=function(a){var b=ds.persist;return b.initialized||ds.util.initComponent(ds,"persist"),b.storage=$.extend(!0,{},b.storage,a),b.setCookieFromStorage(),b.storage},ds.persist.updateAt=function(a,b){var c=ds.persist,d={};return c.initialized||ds.util.initComponent(ds,"persist"),d[a]=b,c.storage=$.extend(!0,{},c.storage,d),c.setCookieFromStorage(),c.storage},ds.persist.removeAt=function(a){var b=ds.persist;return b.initialized||ds.util.initComponent(ds,"persist"),_.has(b.storage,a)&&(b.storage[a]=null,delete b.storage[a]),b.setCookieFromStorage(),b.storage},ds.persist.setStorageFromCookie=function(){var a,b=ds.persist;if(b.rawCookie=$.cookie(b.cookieName),b.rawCookie)try{a=JSON.parse(b.rawCookie)}catch(c){throw new Error("Unable to correctly parse storage cookie: "+b.rawCookie)}else a={};return b.storage=a,a},ds.persist.setCookieFromStorage=function(){var a,b=ds.persist;try{a=JSON.stringify(b.storage)}catch(c){throw new Error("Unable to correctly write storage cookie: "+b.storage)}return $.cookie(b.cookieName,a,{expires:3650,path:"/"}),b.rawCookie=a,a},ds.priceSuggester=ds.priceSuggester||{},ds.priceSuggester.create=function(a,b,c,d){function e(){var a=c.val();return _.has(d,a)?d[a].toFixed(2):""}function f(){var b=e(),c=a.find(".value");a.toggle(!!b.length),c.html(b)}function g(a){b.val(e()),a.preventDefault()}c.on("change",f),a.on("click",g)},ds.rating={init:function(){return this.DEFAULTS={min:1,max:5,resettable:!0,readOnly:!1,preset:0},this.rangeClass="rating_range",this.iconsClass="rating_icons",this.resetHtml='<i class="reset icon-remove" data-value="0"></i>',this.touchToMouseMoveEvents=["touchmove","touchstart"],$(".rating").each(_.bind(this.initRating,this)),!0},initRating:function(a,b){if(b=$(b),!b.data("initialized")){var c=this.getOptions(b);b.data("options",c),b.data("initialized",!0),this.addIcons(b,c.max,c.resettable),c.readOnly||this.bindMouse(b,c),this.setValue(b,c.value,!0)}},getOptions:function(a){var b=_.extend(_.clone(this.DEFAULTS),a.data());return b},addIcons:function(a,b,c){a.append('<span class="'+this.iconsClass+'"></span>');var d=a.find("."+this.iconsClass);d.append(['<span class="',this.rangeClass,'"></span>'].join(""));var e=function(a){var b=a+1;this.append(['<i class="star star',b,' icon-star-empty" data-value="',b,'"></i>'].join("")),this.append(['<i class="star star',b,' icon-star" data-value="',b,'"></i>'].join(""))};_.times(b,e,d.find("."+this.rangeClass)),c&&d.append(this.resetHtml)},setValue:function(a,b,c){b?a.data("value",b):(a.removeAttr("data-value"),a.removeData("value")),c&&this.fillValue(a),this.toggleReset(a)},toggleReset:function(a){var b=!a.data("value");a.find("i.reset").toggleClass("hide",b)},fill:function(a,b){if(b=_.string.toNumber(b,2),"number"==typeof b){var c=Math.round(b),d=a.find("."+this.rangeClass),e=_.times(a.data("options").max+1,function(a){return"fill"+a.toString()}).join(" ");d.removeClass(e),d.addClass("fill"+c.toString())}},fillValue:function(a){var b=a.data("value")||a.data("options").preset||"0";this.fill(a,b)},fillHover:function(a,b){var c=$(b.target),d=c.data("value");this.fill(a,d)},selectRating:function(a,b){ds.util.requireLogin();var c=$(b.target),d=c.data("value"),e=a.data("value");this.setValue(a,d,!0);var f=a.data("options").postUrl;f&&$.post(f,{value:d}).done(_.bind(this.updateStats,this,a)).fail(_.bind(this.setValue,this,a,e,!0))},updateStats:function(a,b){b&&b.value&&b.count&&a.find(".rating_stats")&&(a.find(".rating_value").html(b.value),a.find(".rating_count").html(b.count))},bindMouse:function(a){var b=a.find("i.star");b&&b.on("mousemove",_.bind(this.fillHover,this,a)).on("mouseup",_.bind(this.selectRating,this,a));var c=a.find("."+this.rangeClass);c.on("touchstart touchmove touchend",_.bind(this.rangeTouchHandler,this,c)).on("mouseleave",_.bind(this.fillValue,this,a));var d=a.find("i.reset");d&&d.on("touchend",_.bind(this.resetTouchHandler,this,a)).on("click",_.bind(this.selectRating,this,a))},resetTouchHandler:function(a,b){b.preventDefault(),b.stopPropagation(),this.selectRating(a,b)},rangeTouchHandler:function(a,b){b.preventDefault(),b.stopPropagation();var c=$("body"),d={},e=0,f=0,g=a.offset();d.min=g.left-(c.scrollLeft()||0),d.max=d.min+(a.width()-2),f=d.min,e=g.top-(c.scrollTop()||0);var h=b.originalEvent.changedTouches,i=h[0],j="";if(_.contains(this.touchToMouseMoveEvents,b.type))j="mousemove";else{if("touchend"!=b.type)return;j="mouseup"}f=i.clientX<d.min?d.min:i.clientX>d.max?d.max:i.clientX,f=f||i.clientX,e=e||i.clientY;var k=document.elementFromPoint(f,e);$(k).trigger(j)}},ds.rollover=ds.rollover||{},ds.rollover.init=function(){return this.inHover=!1,this.inDiv=!1,this.current="",this.showTimer=0,this.hideTimer=0,this.last=0,$(".rollover_link").on({mouseover:this.startHover,mouseout:this.endHover}),this.$rolloverContainer=$("#ro_div"),this.$rolloverContainer.on({mouseover:this.onDiv,mouseout:this.offDiv}),this.$leftContainer=$("#ro_left_arr"),this.$rightContainer=$("#ro_right_arr"),!0},ds.rollover.onDiv=function(){ds.rollover.inDiv=!0},ds.rollover.offDiv=function(){ds.rollover.inDiv=!1,ds.rollover.hideTimer=setTimeout(ds.rollover.checkOutHover,750)},ds.rollover.startHover=function(a){var b=0;for(ds.rollover.current=a.target||a.srcElement;"A"!==ds.rollover.current.tagName&&5>b;)ds.rollover.current=ds.rollover.current.parentNode,b++;ds.rollover.inHover=!0,ds.rollover.showTimer=setTimeout(ds.rollover.checkInHover,750)},ds.rollover.endHover=function(){ds.rollover.inHover=!1,clearTimeout(ds.rollover.showTimer),ds.rollover.hideTimer=setTimeout(ds.rollover.checkOutHover,750)},ds.rollover.checkInHover=function(){ds.rollover.inHover&&ds.rollover.show()},ds.rollover.checkOutHover=function(){ds.rollover.inHover||ds.rollover.inDiv||(ds.rollover.hide(),clearTimeout(ds.rollover.hideTimer))},ds.rollover.show=function(){var a,b,c,d,e,f,g,h,i,j=ds.rollover,k=!0;if(j.$rolloverContainer.show(),a=ds.util.getElementMetrics($("body")),b=ds.util.getElementMetrics(ds.rollover.$rolloverContainer,!0),c=ds.util.getElementMetrics($(ds.rollover.current)),d=c.right+6,d+b.width>a.width&&(d=c.left-b.width-10,k=!1),e=c.top-10,ds.rollover.$rolloverContainer.css({left:d,top:e}),k?j.$rightContainer.css({display:"block",top:c.top+1,left:d-5}):j.$leftContainer.css({display:"block",top:c.top+1,left:c.left-10}),f=ds.rollover.current.href,f.indexOf("/artist/")>-1)g="artist",h=f.substring(f.indexOf("/artist/")+8,f.length),i=f.replace("/artist/","/artist_rollover/");else{if(!(f.indexOf("/label/")>-1))return;g="label",h=f.substring(f.indexOf("/label/")+7,f.length),i=f.replace("/label/","/label_rollover/")}_(h).includeString("?anv")&&(h=h.substring(0,h.indexOf("?anv"))),$("#ro_title").text(decodeURIComponent(h).replace(/\+/g," ")),$("#ro_content").html("Loading..."),$.get(i,ds.rollover.reply)},ds.rollover.reply=function(a){var b=$("#ro_content");b.html(a)},ds.rollover.hide=function(){var a=ds.rollover;a.$rolloverContainer.hide(),a.$leftContainer.hide(),a.$rightContainer.hide()},ds.share=function(){function a(){!function(a,b,c){var d,e=a.getElementsByTagName(b)[0],f=/^http:/.test(a.location)?"http":"https";a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src=f+"://platform.twitter.com/widgets.js",e.parentNode.insertBefore(d,e))}(document,"script","twitter-wjs")}function b(){!function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/all.js#xfbml=1",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk")}var c={};return c.init=function(){return $(".share_link").on("click",this.showShareDialog),c.$shareDialog=$(".share_dialog"),!0},c.showShareDialog=function(d){c.embedded||(a(),b(),c.$shareDialog.discogsDialog({autoOpen:!1,height:120,width:150,modal:!1,position:{my:"left top+25",at:"left top",of:d.target},dialogClass:"ui-dialog-arrow ui-dialog-arrow-top-left",open:function(){$("body").on("click.share_modal_close",function(a){$(a.target).closest(".ui-dialog").length||$(a.target).hasClass("share_link")||c.$shareDialog.dialog("close")})},close:function(){$("body").off("click.share_modal_close")}}),c.embedded=!0),c.$shareDialog.dialog("open"),d.preventDefault()},c}(),ds.shortcuts={init:function(){function a(a){var b={};return _.each(a,function(a,c){b[c.slice(0,1)]=a}),b}function b(){return $(document).off("keypress.shortcut")}function c(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}function d(a){var b;a&&(m.test(a)?window.location=a:(b=$(a),b.length>0&&b.get(0).click()))}function e(a){return function(e){var f;ds.util.isFocused()||c(e)||(f=a[String.fromCharCode(e.which||e.keyCode)],b(),d(f))}}function f(a){var d=l[String.fromCharCode(a.which||a.keyCode)];ds.util.isFocused()||!d||c(a)||(b().on("keypress.shortcut",e(d)),setTimeout(b,k))}function g(a){var b=a.which||a.keyCode;ds.util.isFocused()||"?".charCodeAt(0)!==b||h()}function h(){var a=$("#keyboard_shortcuts_modal").lazy$element("/_keyboard_shortcuts_modal")();a.then(function(a){var b=a.hasClass("ui-dialog-content"),c=b&&a.dialog("isOpen")?"close":"open";b?(a.dialog(c),ds.util.track("keyboard shortcuts",c+" modal")):(a.discogsDialog({width:500}),ds.util.track("keyboard shortcuts","open modal"))})}var i={dashboard:"/my",collection:"/mycollection",wantlist:"/mywantlist",submissions:"/submissions",profile:"#user_profile_link",inventory:"/sell/manage",orders:"/sell/orders",forum:"/forum/",groups:"/groups/",messages:"/messages/",history:"#history_link",edit:"#history_link"},j={collection:"button.coll_add_button",wantlist:"button.want_add_button",inventory:".inv_add_button"},k=500,l={g:a(i),a:a(j)},m=/^http|\//;return $(".show_keyboard_shortcuts").on("click",function(){return h(),!1}),$(document).on("keypress",f).on("keypress",g),!0}},ds.skittles=ds.skittles||{},ds.skittles.init=function(){return!0},ds.skittles.types=["collection","inventory","wantlist"],ds.skittles._makeData=function(a,b){var c=a,d=c+" in "+_.str.capitalize(b);return{name:b,title:d,count:c}},ds.skittles.makeData=function(a){return _(ds.skittles.types).map(function(b){var c=a&&a[b]||0;return ds.skittles._makeData(c,b)})},ds.skittles.updateStatus=function(a,b){function c(a,b){a.find(".count").text(b.count),a.data("title",b.title),a.toggle(!!b.count)}_(b).chain().pick(ds.skittles.types).each(function(b,d){var e=a.find(".skittle_"+d);c(e,ds.skittles._makeData(b,d))})},ds.skittles.render=function(a){var b="";return b+=_(ds.skittles.makeData(a)).map(ds.skittles.skittleTemplate).join(""),b?"<span class='skittles'>"+b+"</span>":b},ds.skittles.skittleTemplate=function(a){var b="";a=a||{};var c=a.name,d=a.count;return c&&"number"==typeof d&&(b+=['<span class="skittle skittle_',c,'"',0===d?' style="display: none;"':"",' rel="tooltip" data-title="',a.title,'">','<span class="count">',d,"</span>","</span>"].join("")),b},ds.soundplayer=ds.soundplayer||{},ds.soundplayer.sm=ds.soundplayer.sm||{},ds.soundplayer.init=function(){var a,b,c=$("body"),d=ds.datagrab.get("staticServer")||"",e=window.SoundManager||!1;return this.$playlists=$("ol.playlist, table.playlist, span.playlist"),this.$playlists.length<1?!1:e?(this.$playlists.on({togglePlayPause:this.togglePlayPause,playNext:this.playNext,playPrev:this.playPrev}),c.on("click",".play_pause",this.triggerPlayPause),a="ol.playlist li a, table.playlist td a.track_title, a.dl_previewb",c.on("click",a,this.triggerIndivTrack),c.on("click",".play_next",this.triggerPlayNext),c.on("click",".play_prev",this.triggerPlayPrev),b=window.soundManager=new e,b.url=d+"/embed/soundmanager-v297a-20120624-xdomain/",this.prevSound=!1,b.debugMode=!1,b.defaultOptions.volume=33,b.preferFlash=!!navigator.userAgent.match(/firefox/i),b.onready(this.smInit),b.beginDelayedInit(),!0):!1},ds.soundplayer.triggerPlayPause=function(a){var b=$(this);$("ol#"+this.id+", table#"+this.id).trigger("togglePlayPause"),$(".play_pause").removeClass("playing"),b.toggleClass("playing"),a.preventDefault()},ds.soundplayer.triggerIndivTrack=function(a){$(this).trigger("togglePlayPauseTrack",[this.id]),a.preventDefault()},ds.soundplayer.triggerPlayNext=function(a){var b=this.id.split("-")[2];$("ol#playlist-"+b+", table#playlist-"+b).trigger("playNext"),a.preventDefault()},ds.soundplayer.triggerPlayPrev=function(a){var b=this.id.split("-")[2];$("ol#playlist-"+b+", table#playlist-"+b).trigger("playPrev"),a.preventDefault()},ds.soundplayer.togglePlayPause=function(){var a,b,c=this.id,d=c+"-0",e=ds.soundplayer,f=!1,g=window.soundManager;if(!_.has(g.sounds,d))throw new Error("The following track ID is not valid: "+d);f=g.sounds[d],e.prevSound?(a=e.prevSound,a===f?a.paused?a.play():a.pause():a.id.split("-")[1]===c.split("-")[1]?a.paused?a.play():a.pause():(b=$("ol#playlist-"+a.id.split("-")[1]),a.stop(),f.play())):f.play()},ds.soundplayer.playNext=function(){var a,b=this.id,c=ds.soundplayer,d=window.soundManager;return c.prevSound?(a=d.sounds[b+"-"+c.nextID()])?(c.prevSound.pause(),a.play(),void 0):!1:!1},ds.soundplayer.playPrev=function(){var a,b=this.id,c=ds.soundplayer,d=window.soundManager;return c.prevSound?(a=d.sounds[b+"-"+c.prevID()])?(c.prevSound.pause(),a.play(),void 0):!1:!1},ds.soundplayer.togglePlayPauseTrack=function(a,b){var c=ds.soundplayer,d=window.soundManager,e=d.sounds[b];c.prevSound?b===c.prevSound.id?e.paused||0===c.prevSound.playState?e.play():e.pause():(c.prevSound.pause(),e.play()):e.play()},ds.soundplayer.pauseTrack=function(a,b){var c=ds.soundplayer,d=window.soundManager,e=d.sounds[b];c.prevSound&&b===c.prevSound.id&&e.pause()},ds.soundplayer.calculateTime=function(a,b){var c=parseInt(a/1e3,10),d=9>=c%60?"0"+c%60:c%60,e=Math.floor(c/60)+":"+d,f=parseInt(b/1e3,10),g=9>=f%60?"0"+f%60:f%60,h=Math.floor(f/60)+":"+g;return{pos:e,dur:h}},ds.soundplayer.nextID=function(){var a=ds.soundplayer;return a.prevSound?parseInt(a.prevSound.id.split("-")[2],10)+1:0},ds.soundplayer.prevID=function(){var a=ds.soundplayer;return a.prevSound?parseInt(a.prevSound.id.split("-")[2],10)-1:0},ds.soundplayer.smInit=function(){var a=ds.soundplayer;a.smInitialized=!0,a.$playlists.each(a.childTracksToSM)},ds.soundplayer.childTracksToSM=function(){$(this).find("li a, td.track a, a.dl_previewb").each(ds.soundplayer.bindTrackToSM)},ds.soundplayer.bindTrackToSM=function(a){var b=ds.soundplayer,c=window.soundManager,d=$(this).parents(".playlist").attr("id"),e=d+"-"+a;this.id=e,this.playlistID=d,c.createSound({id:e,url:this.href,onplay:b.sm.onplay,onpause:b.sm.onpause,onresume:b.sm.onresume,onstop:b.sm.onstop,onfinish:b.sm.onfinish,whileplaying:b.sm.whileplaying}),$(this).bind("togglePlayPauseTrack",b.togglePlayPauseTrack),$(this).bind("pauseTrack",b.pauseTrack)},ds.soundplayer.sm.onplay=function(){var a=$("#"+this.id),b=ds.datagrab.get("staticServer")||"",c=ds.soundplayer;c.prevSound=this,a.append('<img src="'+b+'/images/throbber.gif" class="loadingTrack" />'),c.sm.visuallyPlay(a,!0)},ds.soundplayer.sm.onpause=function(){var a=$("#"+this.id),b=ds.soundplayer;b.prevSound=this,b.sm.visuallyPlay(a,!1)},ds.soundplayer.sm.onresume=function(){var a=$("#"+this.id),b=ds.soundplayer;b.prevSound=this,b.sm.visuallyPlay(a,!0)},ds.soundplayer.sm.onstop=function(){var a=$("#"+this.id);ds.soundplayer.prevSound=!1,ds.soundplayer.sm.visuallyPlay(a,!1)},ds.soundplayer.sm.onfinish=function(){var a,b=$("#"+this.id),c=window.soundManager,d=ds.soundplayer;return d.sm.visuallyPlay(b,!1),(a=c.sounds[this.playlistID+"-"+d.nextID()])?(a.play(),void 0):!1},ds.soundplayer.sm.visuallyPlay=function(a,b){var c=a.next().is("span")?a.next():a,d="soundplayer_is_current_track_text";c.toggleClass(d,b),a.hasClass("dl_previewb")||(a=a.parent().parents("li").find(".dl_previewb")),b?a.addClass("playing"):setTimeout(function(){a.removeClass("playing")},1)},ds.soundplayer.sm.whileplaying=function(){var a=ds.soundplayer,b=a.calculateTime(this.position,this.durationEstimate),c=$("#"+a.prevSound.id);c.parent().find(".duration").html("("+b.pos+" / "+b.dur+")"),$(".loadingTrack").remove()},ds.squish=function(){function a(){return $(".squishable").each(function(a,d){var e=$(d);b(e)?c(e):e.removeClass("cropped")}),!0}function b(a){var b=a.data("maxLines")||6,c=16,d=c*b;return a.height()>=d}function c(a){var b,c='<a class="squishable_toggler cropped"><span class="more">More <i class="icon-caret-down"></i></span><span class="less">Less <i class="icon-caret-up"></i></span></a>';return b=$(c),a.append(b),b.on("click",function(b){return a.toggleClass("cropped"),$(b.target).blur(),!1}),b.toggleClass("touch",ds.features.hasTouch),a.addClass("initialized")}return{init:a}}(),ds.tables=ds.tables||{},ds.tables.init=function(){function a(){var a=c.filter(":checked").length===c.length;b.prop("checked",a)}var b=$("input.check_all").on("click",this.checkAll),c=$(b.data("checkAllSelector"));return this.$checkboxes=c,c.on("change",a),a(),this.setupReactiveControls(),!0},ds.tables.checkAll=function(){ds.tables.$checkboxes.prop("checked",$(this).prop("checked")).trigger("change")},ds.tables.setupReactiveControls=function(){var a,b,c=$(".reactive_control");c.length>0&&(a=function(){return 0===ds.tables.$checkboxes.filter(":checked").length},b=function(){c.attr("disabled",a())},b(),this.$checkboxes.on("change",b))},ds.toggleSection=function(){function a(a){var c=$(a.target);if(!c.hasClass(e.control)&&!c.is("i"))return!0;var d=$($(this).data("for")),f=d.hasClass(e.collapsed);b(d,!f)}function b(a,b){var c="toggle_section_"+a.data("toggle-section-id"),f=d[1*b];a.toggleClass(e.collapsed),ds.persist.updateAt(c,b),$(window).trigger(c+":"+f)}var c={},d=["expanded","collapsed"],e={control:"toggle_section_control",collapsed:"toggle_section_collapsed"};return c.init=function(){return $("."+e.control).onFastClick(a),!0},c}(),ds.tooltip=ds.tooltip||{},ds.tooltip.init=function(){if(!ds.features.isMobile){var a=ds.initialized.then(function(){return $("[rel=tooltip]").tooltip()});a.then(function(a){function b(){var a=c.parents("td.status");c.css({width:a.width(),height:a.height()})}var c=a.filter(function(){return $(this).parents("td.status").length});c.length&&(b(),$(window).on("resize",_.throttle(b,500)))})}return!0},ds.tracehandler=ds.tracehandler||{},ds.tracehandler.init=function(){$.subscribe("glitchreport",ds.tracehandler.log)},ds.tracehandler.log=function(a,b){_(b).has("file")&&b.file.match(/ds.js|discogs.js|javascripts/i)&&$.post("/_js_error",b)},ds.tracklist=ds.tracklist||{},ds.tracklist.init=function(){return this.$tracklistCredits=$(".toggleTracklistCredits"),this.$trackBlockquote=$(".track blockquote"),this.$tracklistCredits.length>0&&this.$tracklistCredits.click(this.toggleTracklistCredits),this.$tracklistCredits.length>0},ds.tracklist.toggleTracklistCredits=function(){var a=$(this),b=ds.tracklist,c=parseInt(ds.persist.get("hide_tracklist_credits"),10)?0:1;b.$trackBlockquote.slideToggle("fast"),ds.persist.updateAt("hide_tracklist_credits",c),ds.util.track("release",c?"hide_credits":"show_credits"),a.html((c?"Show":"Hide")+" Credits")},ds.videoSection=function(){var a={};return a.init=function(){var a,b=$(".video.toggle_section"),c=b.find("iframe").length>0;return c||(a=function(){var a=$.trim(b.find("#video_template").html());$(window).off("toggle_section_video:expanded.video_section"),b.find(".toggle_section_content").html(a),c=!0},b.hasClass("toggle_section_collapsed")?$(window).on("toggle_section_video:expanded.video_section",a):setTimeout(a,0)),b.length>0},a}(),ds.youtubemodal=ds.youtubemodal||{},ds.youtubemodal.init=function(){var a=$("body");a.on("click",".youtube_modal_trigger",this.show),this.contentClass="youtube_modal_content",this.template=['<div class="',this.contentClass,'">',"<iframe ",'type="text/html" ','src="http://www.youtube.com/embed/{{ youtubeID }}" ','frameborder="0" ','width="853" ','height="505">',"</iframe>","</div>"].join("")},ds.youtubemodal.show=function(a){var b,c=$("body"),d=$(this),e=d.data("youtube-id"),f=ds.youtubemodal.template;f=f.replace("{{ youtubeID }}",e),c.append(f),b=$("."+ds.youtubemodal.contentClass),b.discogsDialog({width:880,height:560,title:d.data("title"),close:function(){b.remove()}}),ds.util.track(d.data("ga"),"quicklist_manual"),a.preventDefault()},ds.collection=ds.collection||{},ds.collection.notes=ds.collection.notes||{},ds.collection.addremove=ds.collection.addremove||{},ds.collection.init=function(){return this.lockRemove=!1,ds.collection.addremove.init(),ds.collection.notes.init(),!0},ds.collection.notes.init=function(){this.$fields=$(".collection_field"),this.$fields.length>0&&this.$fields.each(this.initNote)},ds.collection.notes.initNote=function(){var a,b,c=$(this),d=ds.util.toString(c.attr("class")),e=c.find(".cw_note_text").html().replace(/<br[ ]?[\/]?>/g,"\n");return a=d.match(/collection_r(\d+)_i(\d+)_f(\d+)/),_.isArray(a)?(b=["collection_r",a[1],"_i",a[2],"_f",a[3]].join(""),c.data("ile-handled")||(ds.inlineEdit.initClass(b,e,{lock:{coll_remove:!0}},ds.collection.notes.saveNote,{lock:{coll_remove:!1}},a[3]),c.data("ile-handled",!0)),void 0):(a=c.attr("id").match(/coll_block_r(\d+)_(\d+)/),ds.inlineEdit.initObj(this,e,{lock:{coll_remove:!0}},ds.collection.notes.saveNote,{lock:{coll_remove:!1}},a[2]),void 0)},ds.collection.notes.saveNote=function(a,b){a=a||$(this);var c=a.attr("class");c=c.match(/collection_r(\d+)_i(\d+)_f(\d+)/),$.ajax({type:"POST",url:"/list/coll_update",dataType:"json",data:{release_id:c[1],inst:c[2],field_id:c[3],val:b||" "},success:ds.collection.notes.saveNoteReply})},ds.collection.notes.saveNoteReply=function(a){var b=[".collection_r",a.release_id,"_i",a.inst,"_f",a.field_id].join("");ds.collection.notes.saveNoteReplyData=a,$(b).each(ds.collection.notes.saveNoteReplyField)},ds.collection.notes.saveNoteReplyField=function(){var a=this.id,b=ds.collection.notes.saveNoteReplyData;a||(a="jq"+Math.floor(Math.random()*Math.pow(2,32)),this.id=a),ds.inlineEdit.saveReturn(a,b.content,_.template($("#collFieldValueTemplate").html(),b))},ds.collection.addremove.init=function(){var a=$("body");a.on("click",".coll_add_button",this.clickAdd),a.on("click",".collection .cw_block .remove",this.clickRemove),a.on("click",".coll_add_link",this.clickAddLink),a.on("click",".coll_remove_link",this.clickRemoveLink)},ds.collection.addremove.clickAdd=function(a){ds.util.requireLogin();var b=parseInt($(this).data("release-id"),10),c=$("#collection_r"+b),d=$("#coll_num_r"+b);$.ajax({type:"POST",url:"/list/coll_add",dataType:"json",data:{release_id:b,styleVersion:ds.datagrab.get("styleVersion")},success:function(a){a.release_id=b;var e=_.template($("#newCollBlockTemplate").html(),a);c.append(e),d.html(a.num_have),$(".collection_field").each(ds.collection.notes.initNote),ds.util.track("release","collection_add"),$.publish("addToCollWantList"),a.broadcast&&$(".broadcast_dropzone").html(ds.templates.broadcastWidget(a.broadcast))}}),a.preventDefault()},ds.collection.addremove.clickRemove=function(a){ds.util.requireLogin();var b=$(this).parent().attr("id").match(/coll_block_r(\d+)_(\d+)/),c=parseInt(b[1],10),d=parseInt(b[2],10);ds.collection.lockRemove||($("#coll_num_r"+c).load("/list/coll_remove",{release_id:c,inst:d,styleVersion:ds.datagrab.get("styleVersion")}),$(["#coll_block_r",c,"_",d].join("")).remove(),ds.util.track("release","collection_remove")),a.preventDefault()},ds.collection.addremove.clickAddLink=function(a){ds.util.requireLogin();var b=parseInt($(this).parent().data("release-id"),10);$("#coll_add_r"+b).load("/list/coll_add",{release_id:b,styleVersion:ds.datagrab.get("styleVersion"),context:1}),ds.util.track("release","collection_add"),a.preventDefault()},ds.collection.addremove.clickRemoveLink=function(a){ds.util.requireLogin();var b=$(this),c=parseInt(b.parent().data("release-id"),10);ds.collection.lockRemove||($("#coll_add_r"+c).load("/list/coll_remove",{release_id:c,context:1,styleVersion:ds.datagrab.get("styleVersion")}),ds.util.track("release","collection_remove")),a.preventDefault()},ds.inlineEdit=ds.inlineEdit||{},ds.inlineEdit.init=function(){return!0},ds.inlineEdit.editors={},ds.inlineEdit.initObj=function(a,b,c,d,e,f){var g=$("body"),h=$(a),i="ile_"+Math.floor(Math.random()*Math.pow(2,32)),j={content:b,html:a.innerHTML,edit:c,save:d,done:e,optsId:f};h.data("hasInlineEditClickHandler")||(g.hasClass("ile_off")||g.addClass("ile_on"),a.id=i,ds.inlineEdit.editors[i]=j,h.on("click",ds.inlineEdit.edit),h.data("hasInlineEditClickHandler",!0))},ds.inlineEdit.initClass=function(a,b,c,d,e,f){var g=$("div."+a);g.each(function(){ds.inlineEdit.initObj(this,b,c,d,e,f)})},ds.inlineEdit.edit=function(a){var b,c=$("body"),d=$(this),e=this.id,f=null,g=ds.inlineEdit.editors[e],h=[],i=[],j=0,k="";if(a.stopPropagation(),!c.hasClass("ile_off")&&g){if(c.removeClass("ile_on").addClass("ile_off"),d.hasClass("ile_list")){f=parseInt(d.attr("class").match(/_i(\d+)_f(\d+)\b/)[2],10),h=ds.release.inlineEditFields[f],i=['<select id="ile_select" size="',h.length+1,'">',"<option></option>"];for(j in h)h.hasOwnProperty(j)&&(k=h[j],i.push("<option"),i.push(k===g.content?' selected="true"':""),i.push(' value="'),i.push(k),i.push('">'),i.push(k),i.push("</option>"));i.push("</select>"),i=i.join(""),c.on("click."+e,function(a){ds.inlineEdit.listCancel(a,e)})}else i=['<textarea id="ile_ta" maxlength="255" rows="',h-1||3,'">',g.content,"</textarea>","<a onclick=\"ds.inlineEdit.save('"+e+"');\">Save</a> ","<a onclick=\"ds.inlineEdit.done('"+e+"');\">Cancel</a>"].join("");d.html(i),d.hasClass("ile_list")&&$("select#ile_select").on("change."+e,function(){ds.inlineEdit.save(e)}),_.isFunction(g.edit)?(b=g.edit(d),b&&ds.inlineEdit.addObj(b)):g.edit&&ds.inlineEdit.addObj(g.edit),$("#ile_ta").focus()}},ds.inlineEdit.save=function(a){var b,c,d=$("#"+a),e=ds.inlineEdit.editors[a];e&&e.save&&(b=d.hasClass("ile_list")?$("#ile_select").val():$("#ile_ta").val(),_.isFunction(e.save)?(c=e.save(d,b),c&&ds.inlineEdit.addObj(c)):ds.inlineEdit.addObj(e.save))},ds.inlineEdit.saveReturn=function(a,b,c){var d=ds.inlineEdit.editors[a];d.content=b,d.html=c,ds.inlineEdit.done(a)},ds.inlineEdit.done=function(a){var b,c=$("#"+a),d=ds.inlineEdit.editors[a],e=$("body");d&&(d.done&&(_.isFunction(d.done)?(b=d.done(c),b&&ds.inlineEdit.addObj(b)):ds.inlineEdit.addObj(d.done)),setTimeout(function(){e.removeClass("ile_off").addClass("ile_on")},0),c.html(d.html),e.off("click."+a),$("select#ile_select").off("change."+a))},ds.inlineEdit.listCancel=function(a,b){$(a.target).is("select#ile_select")||ds.inlineEdit.done(b)},ds.inlineEdit.addObj=function(a){ds.inlineEdit=$.extend(!0,{},a,ds.inlineEdit)},ds.wantlist=ds.wantlist||{},ds.wantlist.notes=ds.wantlist.notes||{},ds.wantlist.addremove=ds.wantlist.addremove||{},ds.wantlist.init=function(){return ds.wantlist.addremove.init(),ds.wantlist.notes.init(),!0},ds.wantlist.notes.init=function(){this.$fields=$(".wantlist_field"),this.$fields.length>0&&this.$fields.each(this.initNote)},ds.wantlist.notes.initNote=function(){var a=$(this),b=parseInt(a.attr("class").match(/wantlist_r(\d+)_notes/)[1],10),c=a.find(".cw_note_text").html().replace(/<br[ ]?[\/]?>/g,"\n"),d="wantlist_r"+b+"_notes";a.data("ile-handled")||(ds.inlineEdit.initClass(d,c,function(a){var b=$(a),c=['<span class="nowrap">','<input id="want_notes_public" type="checkbox"',$(a).is(".public")?' checked="true"':"",'" /><label for="want_notes_public">Public</label></span>'].join("");return b.append(c),{lock:{want_remove:!0}}},ds.wantlist.notes.saveNote,{lock:{want_remove:!1}}),a.data("ile-handled",!0))},ds.wantlist.notes.saveNote=function(a,b){ds.util.requireLogin();var c=a.attr("class").match(/wantlist_r(\d+)_notes/)[1],d=$("#want_notes_public:checked").length>0?1:0;$.ajax({type:"POST",url:"/list/want_update",dataType:"json",data:{release_id:c,notes:b||" ","public":d},success:ds.wantlist.notes.saveNoteReply})},ds.wantlist.notes.saveNoteReply=function(a){var b=[".wantlist_r",a.release_id,"_notes"].join("");ds.wantlist.notes.saveNoteReplyData=a,$(b).each(ds.wantlist.notes.saveNoteReplyField)},ds.wantlist.notes.saveNoteReplyField=function(){var a=$(this),b=this.id,c=ds.wantlist.notes.saveNoteReplyData,d=$.extend(!0,{},c);
"Y"===c.pub?a.addClass("public"):a.removeClass("public"),b||(b="jq"+Math.floor(Math.random()*Math.pow(2,32)),a.attr("id",b)),d.pub="Y"===d.pub?!0:!1,ds.inlineEdit.saveReturn(b,d.content,_.template($("#cwNotesHTMLTemplate").html(),d))},ds.wantlist.addremove.init=function(){var a=$("body");a.on("click",".want_add_button",this.clickAdd),a.on("click",".want_rem_button",this.clickRemove),a.on("click",".wantlist .cw_block .remove",this.clickRemove2),a.on("click",".want_add_link",this.clickAddLink),a.on("click",".want_remove_link",this.clickRemoveLink)},ds.wantlist.addremove.clickAdd=function(a){ds.util.requireLogin();var b=$(this),c=b.data("id"),d=$(this).data("wantlist-type");"r"===d?$.ajax({type:"POST",url:"/list/want_add",data:{release_id:c,styleVersion:ds.datagrab.get("styleVersion")},dataType:"json",success:function(a){a.release_id=c,$("#wantlist_r"+c).append(_.template($("#newWantBlockTemplate").html(),a)),$("#want_num_r"+c).html(a.num_want),$(".want_add_button").prop("disabled",!0),ds.wantlist.notes.init(),ds.util.track("release","wantlist_add"),$.publish("addToCollWantList"),a.broadcast&&$(".broadcast_dropzone").html(ds.templates.broadcastWidget(a.broadcast))}}):"m"===d&&($.ajax({type:"POST",url:"/master/want_add",dataType:"json",data:{master_id:c},success:function(a){$.each(a.ids,function(a,b){ds.release.wantlistUpdate("r"+b,1)}),ds.util.track("release","wantlist_add_all")}}),$("#want_add_"+c).hide(),$("#want_remove_"+c).show()),a.preventDefault()},ds.wantlist.addremove.clickRemove=function(a){ds.util.requireLogin();var b=$(this).data("id");$.ajax({type:"POST",url:"/master/want_remove",dataType:"json",data:{master_id:b},success:function(a){$.each(a.ids,function(a,b){ds.release.wantlistUpdate("r"+b,0)}),ds.util.track("release","wantlist_remove_all")}}),$("#want_add_"+b).show(),$("#want_remove_"+b).hide(),a.preventDefault()},ds.wantlist.addremove.clickRemove2=function(a){ds.util.requireLogin();var b=parseInt($(this).parent().attr("id").match(/want_block_r(\d+)/)[1],10);$(".want_add_button").prop("disabled")&&($("#want_num_r"+b).load("/list/want_remove",{release_id:b,styleVersion:ds.datagrab.get("styleVersion")}),$(".want_add_button").prop("disabled",!1),$("#want_block_r"+b).remove(),ds.util.track("release","wantlist_remove")),a.preventDefault()},ds.wantlist.addremove.clickAddLink=function(a){ds.util.requireLogin();var b=$(this),c=parseInt(b.parent().data("release-id"),10);$("#want_add_r"+c).load("/list/want_add",{release_id:c,context:1,styleVersion:ds.datagrab.get("styleVersion")}),ds.util.track("release","wantlist_add"),a.preventDefault()},ds.wantlist.addremove.clickRemoveLink=function(a){ds.util.requireLogin();var b=$(this),c=parseInt(b.parent().data("release-id"),10);ds.wantlist.lockRemove||($("#want_add_r"+c).load("/list/want_remove",{release_id:c,context:1,styleVersion:ds.datagrab.get("styleVersion")}),ds.util.track("release","wantlist_remove")),a.preventDefault()},ds.admin=ds.admin||{},ds.admin.creditsFormat=ds.admin.creditsFormat||{},ds.admin.menu=ds.admin.menu||{},ds.admin.ad=ds.admin.ad||{},ds.admin.graphs=ds.admin.graphs||{},ds.admin.holds=ds.admin.holds||{},ds.admin.queues=ds.admin.queues||{},ds.admin.jserror=ds.admin.jserror||{},ds.admin.failQueue=ds.admin.failQueue||{},ds.admin.resqFailed=ds.admin.resqFailed||{},ds.admin.cron=ds.admin.cron||{},ds.admin.init=function(){return ds.util.initByUrls(ds.admin,{ad:"ad_submissions",creditsFormat:["credits","formats"],holds:"holds",queues:"job_queues",resqFailed:"resq_failed",jserror:"js_errors",failQueue:"fail_queue",cron:"cron"}),ds.util.initComponent(ds.admin,"menu"),ds.util.inUrl("support_form")&&$('input:submit[name="Action.PreviewFAQ"]').click(function(){return ds.util.alert("ok"),!1}),$("#acc").click(function(){this.focus(),this.select()}),ds.util.inUrl("qm")&&$("#qid").change(function(){this.form.submit()}),!0},ds.admin.creditsFormat.init=function(){var a=$("body");a.on("click",".edit",this.edit),a.on("click",".cancel",this.cancel),a.on("click",".add",this.add),a.on("click",".save",this.save),a.on("click",".delete",this.del),$(".table_block.table_block_editable tbody tr").hover(function(){$(this).find("td div").show()},function(){$(this).find("td div").hide()})},ds.admin.creditsFormat.edit=function(){var a,b=$(this),c=b.parents("tr").children();c.each(function(b){a=0===b?$("<input />",{type:"text",name:this.className,value:this.innerHTML,"class":"admin_credits_format_short_input"}):4>=b?$("<input />",{type:"text",name:this.className,value:this.innerHTML}):5===b?$("<textarea />",{name:this.className,"class":"admin_credits_format_textarea"}).html(this.innerHTML):$("<button class='save'>save</button>\n<button class='cancel'>cancel</button>"),$(this).html(a)})},ds.admin.creditsFormat.cancel=function(){var a=$(this),b=a.parents("tr").children();ds.admin.creditsFormat.cancelEditing(b)},ds.admin.creditsFormat.add=function(){var a=$(this),b=a.parents("tr"),c=b.children(),d={};c.each(function(){var a=$(this).find("input, textarea");a.length>0&&(d[a.attr("name")]=a.val())}),$.post("/_d1m3n_/"+a.parents("table").attr("class").split(" ").pop()+"_add",d,function(){window.location.reload()})},ds.admin.creditsFormat.save=function(){var a=$(this),b=a.parents("tr"),c=b.children(),d={id:b.attr("id").split("_")[1]};c.each(function(){var a=$(this).find("input, textarea");a.length>0&&(d[a.attr("name")]=a.val())}),$.post("/_d1m3n_/"+a.parents("table").attr("class").split(" ").pop()+"_save",d,function(){ds.admin.creditsFormat.cancelEditing(c),b.effect("highlight","slow")})},ds.admin.creditsFormat.del=function(){var a=$(this);ds.util.confirm("Are you sure you want to delete this?",function(){var b=a.parents("tr"),c={id:b.attr("id").split("_")[1]};$.post("/_d1m3n_/"+a.parents("table").attr("class").split(" ").pop()+"_delete",c,function(){b.fadeOut()})})},ds.admin.creditsFormat.cancelEditing=function(a){a.each(function(a){var b=$(this);6>a?(b.html(b.children("input").val()),b.html(b.children("textarea").val())):b.html("<div style='display:none'><a class='edit'>edit</a>\n<a class='delete'>delete</a></div>")})},ds.admin.ad.init=function(){$(".admin_status_selector").change(this.changeAdminStatus)},ds.admin.ad.changeAdminStatus=function(a){var b=$(a.currentTarget),c=b.attr("data_ad_id"),d=ds.datagrab.get("admin/ad_submissions:adUrl")+c,e={admin_status:b.val(),"Action.ChangeStatus":"ChangeStatus"};$.post(d,e)},ds.admin.holds.init=function(){this.$checkboxes=$('input:checkbox[name="uid"]'),this.checkedAll=!1,$(".toggle_all").click(ds.admin.holds.toggleAll)},ds.admin.holds.toggleAll=function(a){ds.admin.holds.$checkboxes.prop("checked",!ds.admin.holds.checkedAll),ds.admin.holds.checkedAll=!ds.admin.holds.checkedAll,a.preventDefault()},ds.admin.queues.init=function(){this.timer=0,$("#refreshToggler").on("click",this.toggle).click()},ds.admin.queues.fetch=function(){$.getJSON("/_d1m3n_/job_queues_ajax",function(a){$("#date").html(a.date),$("#failed").html(a.failed),$.each(a.queues,function(a,b){$("#"+a+"_waiting").html(b)}),$.each(a.solr,function(a,b){$.each(b,function(a,c){$("#"+b.core+"_"+a).html(c)})})})},ds.admin.queues.toggle=function(a){ds.admin.queues[0===ds.admin.queues.timer?"on":"off"].call(this),a.preventDefault()},ds.admin.queues.on=function(){$(this).html("on"),ds.admin.queues.timer=setInterval(ds.admin.queues.fetch,3e3)},ds.admin.queues.off=function(){$(this).html("off"),clearInterval(ds.admin.queues.timer),ds.admin.queues.timer=0},ds.admin.jserror.init=function(){$("summary").click(ds.admin.jserror.clickSummary),$("#clear_js_errors").click(ds.admin.jserror.clear)},ds.admin.jserror.clickSummary=function(){var a=$("#js_error_dialog");return a.length<1&&(a=$('<div id="js_error_dialog" style="display:none" />').appendTo("body")),a.html("<pre>"+$(this).parent().find("pre").html()+"</pre>"),a.show().discogsDialog(),!1},ds.admin.jserror.clear=function(){ds.util.confirm("Clear out the entire JS error log?",function(){$.getJSON("/_d1m3n_/clear_js_errors",function(a){a.success&&window.location.reload()})})},ds.admin.resqFailed.init=function(){$("body").on("click",".queue_error",ds.admin.resqFailed.toggleExpandError)},ds.admin.resqFailed.toggleExpandError=function(){$(this).hasClass("queue_error_expanded")?($(this).find(".compressed_info").slideDown(),$(this).find(".full_info").slideUp()):($(this).find(".compressed_info").slideUp(),$(this).find(".full_info").slideDown()),$(this).toggleClass("queue_error_expanded")},ds.admin.failQueue.init=function(){$(".delete_job").click(ds.admin.failQueue.deleteJob)},ds.admin.failQueue.deleteJob=function(){var a=$(this),b=a.attr("payload");return $.ajax({type:"POST",dataType:"json",url:"/_d1m3n_/fail_queue_run",data:{what:"delete_job",payload:b}}).done(function(){window.location.reload()}),!1},ds.admin.cron.init=function(){var a=$.param.fragment();a&&$("#"+a).addClass("log_entry_highlight"),$(".log_entry_permalink a").click(function(){$(".log_entry").removeClass("log_entry_highlight"),$(this).parents(".log_entry").addClass("log_entry_highlight")})},ds.artist=ds.artist||{},ds.artist.init=function(){if(ds.util.inUrl("recent"))this.artistName=ds.datagrab.get("artist/recent:artistName"),this.rType=ds.datagrab.get("artist/recent:rtype"),$("#rtype").change(function(){var a=$(this),b=a.data("rtype-artistname"),c=a.data("rtype-noaliases");window.location=["/artist/",b,"/recent?rtype=",this.value,"&noaliases=",c].join("")}),$("input:checkbox[name=noaliases]").change(ds.artist.checkAliases);else if(ds.util.matchesSegments({1:"artist"})){var a=$("body");if(this.artistID=ds.datagrab.get("artist/view:artistID"),!this.artistID)return;ds.util.track("artist","view_artist_id","artistID_"+this.artistID),this.defaultCredit=ds.datagrab.get("artist/view:defaultCredit").split("_"),this.images=ds.datagrab.get("artist/view:images"),a.on("click",".artist-view-list-add",function(){var a=$(this),b=a.data("list-add-what"),c=a.data("list-add-obid"),d=a.data("list-add-pos");ds.addtolist.add(b,c,d)}),a.on("click",".artist-submit-add-release-form",function(){$("#addreleaseform").submit(),ds.util.track("artist","add_release")}),a.on("click",".artist-track-view-recent-release",function(){ds.util.track("artist","view_recent_releases")}),a.on("click","#mr_a_create",function(){ds.util.track("artist","create_master")}),a.on("click",".artist_releases_pagination a.pagelinknorm",ds.artist.artistLinearNav),a.on("click",".artist_releases_pagination a",ds.artist.numericNav),a.on("click",".mr_toggler",ds.artist.toggleMasterRelease),a.on("mouseenter mouseleave","tr.main, tr.sub",ds.artist.showDropDown),a.on("click",".edit_menu_handle",ds.artist.editMenu),a.on("click","li.list_action",ds.artist.clickEditMenu),a.on("click",".ru_master_edit",ds.artist.masterEdit),this.originalPersistedState=this.getPersistedState(),this.setState(this.originalPersistedState),this.getReleases(),this.render(),$(window).on("hashchange",_.bind(ds.artist.hashChangeHandler,this))}return ds.release.enableEditOnMaster(),!0},ds.artist.getPersistedState=function(){var a={};return ds.persist.get("artist_limit")&&(a.per=ds.persist.get("artist_limit").split("_")),ds.persist.get("artist_sort")&&(a.sort=ds.persist.get("artist_sort").split("_")),ds.persist.get("artist_layout")&&(a.layout=ds.persist.get("artist_layout")),a},ds.artist.setState=function(a){a=a||{};var b=$.bbq.getState("q")||"";b&&!_.isBlank(b)?(this.credit=null,this.q=b,this.$discography=$("#search-results")):(this.q=null,this.credit=ds.artist.defaultCredit,$.bbq.getState("t")&&(this.credit=$.bbq.getState("t").split("_")),this.$discography=$("#"+this.credit.join("_"))),this.qs=$.deparam.querystring(),this.page=$.bbq.getState("p")?parseInt($.bbq.getState("p"),10):1,this.per=this.originalPersistedState.per||"25",this.sort=this.originalPersistedState.sort||["year","asc"],this.anv=this.qs.anv,this.noanv=this.qs.noanv,this.filterAnv=this.qs.filter_anv,this.layout=a.layout||this.originalPersistedState.layout||"med",this.masterMode=$.bbq.getState("m")||!1,$.bbq.getState("per")&&(this.per=$.bbq.getState("per").split("_")),$.bbq.getState("s")&&(this.sort=$.bbq.getState("s").split("_")),$.bbq.getState("v")&&(this.layout=$.bbq.getState("v")),$("#next_img, #prev_img").click(ds.artist.cycleImage),$("#layout_buttons a").on("click",ds.artist.layoutArtist).each(function(a,b){$(b).removeAttr("href")}),$("#artist_sort").change(ds.artist.sortArtist),$("#artist_limit").change(ds.artist.limitArtist),$("#search").submit(ds.artist.search),$(".discography_nav a.credit_type").click(ds.artist.changeCreditType),$(".remove_listitem").click(ds.artist.removeListItem),this.$query=$("#search-query"),this.$query.val(b)},ds.artist.checkAliases=function(a){a=a||this;var b=["/artist/",ds.artist.artistName,"/recent?rtype=",ds.artist.rType,"&noaliases="].join("");b+=a.target.checked?1:0,window.location=b},ds.artist.animateToTop=function(){ds.util.scrollTo("discography-header")},ds.artist.key=function(){return ds.artist.credit?[ds.artist.credit.join("_"),ds.artist.page,ds.artist.per,ds.artist.sort.join("_"),this.layout].join("_"):void 0},ds.artist.getReleases=function(){function a(){d.$discography.html(['<div class="apr_info">',"<p>Sorry, there was an error retrieving data. Please refresh and try again.</p>","</div>"].join("")),d.postProcess(),f.reject()}var b,c=$(".default_releases"),d=this,e=this.key(),f=$.Deferred(),g=f.promise();this.preProcess();var h=$("#"+e).length>0;if(this.q)return this.searchReleases();c.toggle(e===c.attr("id")),b=this.buildURL(this.credit[0],this.credit[1]);var i;return h?(this.$discography=$("#"+e),f.resolve(this.$discography.html())):(i=$.ajax({type:"get",url:b,cache:!1}),i.then(function(a){d.process(a),f.resolve(a)},a)),g.done(ds.artist.postProcessAndCreateMR),g},ds.artist.postProcessAndCreateMR=function(){ds.artist.postProcess(),$.bbq.getState("m")&&$("#mr_panel").is(":visible")&&ds.artist.createMR()},ds.artist.searchReleases=function(){var a=this.buildURL("all","all"),b=$.post(a,{query:this.q},_.bind(ds.artist.process,this));return b.done(ds.artist.postProcessAndCreateMR),b},ds.artist.preProcess=function(){this.hideChildren(),$("#activity").show()},ds.artist.process=function(a){var b,c=$(".default_releases");this.q?(c.hide(),b="search_results_"+_.slugify(this.q)+"_"+this.page,this.$discography=$("#"+b),0===this.$discography.length&&(this.$discography=$('<div class="search_results" id="'+b+'"/>'),this.$discography.html(a),c.after(this.$discography.get()[0]))):(this.$discography=$("#"+this.key()),this.$discography=$('<div id="'+this.key()+'" class="discography_wrapper"/>'),this.$discography.html(a),this.$discography.insertAfter(c),this.$discography.find("[rel=tooltip]").tooltip())},ds.artist.postProcess=function(){$("#activity").hide(),$(".artist_main_table_tow_odd").removeClass("artist_main_table_tow_odd"),$("tr.main:odd").addClass("artist_main_table_tow_odd"),this.$discography.show()},ds.artist.createMR=function(){var a,b,c=$("#"+ds.artist.key()),d=c.find("span.r_check"),e=d.toArray();d.each(function(c){b=ds.artist.getObid($(e[c]).closest("tr")),"r"===b.charAt(0)&&0===$(this).find("input").length&&(a=document.createElement("input"),a.type="checkbox",a.className="r_check "+b,e[c].appendChild(a),$(a).click(ds.release.rcheckMaster))})},ds.artist.buildURL=function(a,b){var c=["artist",this.artistID,"get_releases",a,b],d=["sort="+this.sort[0]+"-"+this.sort[1],"page="+this.page,"per="+this.per];return this.anv&&d.push("anv="+encodeURIComponent(this.anv)+"&filter_anv="+this.filterAnv),this.noanv&&d.push("noanv=1"),"/"+c.join("/")+"?"+d.join("&")},ds.artist.isEmpty=function(){var a=$.trim(this.$discography.html());return _.isBlank(a)},ds.artist.hideChildren=function(){$(".default_releases, .discography_wrapper, .search_results").hide()},ds.artist.reset=function(a){var b;a?(b=$("#"+a),b.html("\n")):$("#releases").children().html("\n")},ds.artist.changeImage=function(a){var b=$(".image").find("img:first");b.hide().on("load",function(){$(this).fadeIn()}).attr("src",ds.artist.images[a])},ds.artist.relURL=function(a){return 0===a.search(/^http/)?"/"+a.split("/").splice(3,4).join("/"):a},ds.artist.changeCreditType=function(){var a,b=$(this);return b.addClass("selected"),this.blur(),ds.artist.credit&&$(this).hasClass(ds.artist.credit.join("_"))?!1:(ds.artist.$query.closest("li").removeClass("selected"),a=b.attr("class").split(" ")[0],$.bbq.pushState({t:a,q:"",p:1}),ds.artist.$query.val(""),ds.artist.q=null,ds.util.track("artist","section",a),!1)},ds.artist.cycleImage=function(){var a,b,c=$(".image").find("img:first");a=$.inArray(ds.artist.relURL(c.attr("src")),$.map(ds.artist.images,function(a){return ds.artist.relURL(a)})),b=0===a?ds.artist.images.length-1:a-1,"next_img"===this.id?(ds.util.track("artist","next_image"),b=a===ds.artist.images.length-1?0:a+1):ds.util.track("artist","prev_image"),ds.artist.changeImage(b),$("#img_pos").html(b+1+"/"+ds.artist.images.length)},ds.artist.sortArtist=function(){ds.artist.masterMode&&$("#mr_panel").is(":visible")?ds.util.alert("It isn't recommended to change sorting when creating or editing a master release."):($.bbq.pushState({s:this.value,p:1,t:ds.artist.credit.join("_")}),ds.persist.updateAt("artist_sort",this.value)),$(this).blur()},ds.artist.limitArtist=function(){ds.artist.masterMode&&$("#mr_panel").is(":visible")?ds.util.alert("It isn't recommended to change limits when creating or editing a master release."):(ds.persist.updateAt("artist_limit",this.value),$.bbq.pushState({per:this.value,p:1,t:ds.artist.credit.join("_")})),$(this).blur()},ds.artist.layoutArtist=function(a){var b;ds.artist.masterMode&&$("#mr_panel").is(":visible")?ds.util.alert("It isn't recommended to switch views when creating or editing a master release."):(b=$(this).data("size"),ds.persist.updateAt("artist_layout",b),$.bbq.pushState({v:b,t:ds.artist.credit.join("_")})),$(this).blur(),a.preventDefault()},ds.artist.artistLinearNav=function(a){var b=ds.artist.page-1,c={};$(this).html().search(/next/i)>=0&&(b=ds.artist.page+1),c.p=b,$.bbq.getState("q")||$.bbq.getState("t")||(c.t=ds.artist.defaultCredit.join("_")),$.bbq.pushState(c),ds.artist.animateToTop(),a.preventDefault()},ds.artist.numericNav=function(a){var b={};_.isBlank(this.className)&&(b.p=parseInt($(this).html(),10)),ds.artist.animateToTop(),$.bbq.getState("q")||$.bbq.getState("t")||(b.t=ds.artist.defaultCredit.join("_")),$.bbq.pushState(b),a.preventDefault()},ds.artist.search=function(a){$.bbq.pushState({q:ds.artist.$query.val(),t:"",p:1}),a.preventDefault(),ds.util.track("artist","search")},ds.artist.toggleMasterRelease=function(){var a=$(this),b=a.parents("tr"),c=b.parent().find("tr."+b.attr("id")).not("tr.master"),d=b.find("span.toggle_indicator");c.toggle(),a.hasClass("open")?(a.removeClass("open"),d.html("&#x25C4;")):(a.addClass("open"),d.html("&#x25BC;"))},ds.artist.showDropDown=function(a){var b=$(this),c=b.find(".edit_menu_handle"),d=b.find(".edit_menu");"mouseenter"===a.type?c.removeClass("hidden"):(c.addClass("hidden").removeClass("edit_menu_handle_active"),d.hide())},ds.artist.editMenu=function(){var a=$(this),b=a.parents("tr").find(".edit_menu");a.toggleClass("edit_menu_handle_active"),b.toggle()},ds.artist.clickEditMenu=function(){var a=$(this),b=a.parents("td"),c=b.find(".edit_menu_handle"),d=a.attr("class").split(" ")[0],e=d.split("_"),f=e[0],g="add"===e[1]?"remove":"add",h=a.parents("tr").attr("id"),i=h.charAt(0).toUpperCase(),j=h.replace("m","").replace("r",""),k=b.prev(),l={};"list"===f?ds.addtolist.add(i,j):$.ajax({type:"POST",url:"/list/"+d,data:"release_id="+j+"&context=2",success:function(b){"want"===f&&a.toggle(),c.find("li."+f+"_"+g).toggle(),"coll"===f?l.collection=b.count:l.wantlist=b.count,ds.skittles.updateStatus(k,l),$.publish("addToCollWantList")}})},ds.artist.masterEdit=function(){var a=ds.artist.getObid($(this).parents("tr").get()[0]);"m"===a.charAt(0)&&ds.release.clickMasterEdit(null,a)},ds.artist.removeListItem=function(){var a=$(this).get(0),b=$(a).parent().attr("id").match(/listitem_(\d+)_([RAML])_(\d+)/),c=b.splice(1,3);ds.util.confirm("Are you sure you want to remove this item?",function(){$.ajax({type:"POST",url:"/lists/update_item",data:"list="+c[0]+"&what="+c[1]+"&obid="+c[2]+"&remove=1",success:$(a).parent().remove()})})},ds.artist.hashChangeHandler=function(){this.setState(),this.getReleases(),this.render()},ds.artist.render=function(){ds.layout.selectLayout(this.layout),$(".discography_nav a").removeClass("selected"),this.credit&&$("."+this.credit.join("_")).addClass("selected"),$("#artist_sort").val(this.sort.join("_")),$("#artist_limit").val(this.per)},ds.artist.getObid=function(a){var b=$(a).attr("class"),c=b.match(/[a-z][0-9]+/);return c[0]},ds.blog={},ds.blog.init=function(){$("body").on("click","#btn_entry_preview",this.previewEntry),$("body").on("focusout","#title",this.generateUrl),$('input[name="draft"]').on("click",function(){$('input[name="pub_ts"]').closest("div").toggle()})},ds.blog.previewEntry=function(){var a=$("#form_entry").serialize();$.post("/blog/preview",a,function(a){$("#entry_preview").html(a)})},ds.blog.generateUrl=function(){$("#url").val(_.slugify($("#title").val()))},ds.dashboard=ds.dashboard||{},ds.dashboard.init=function(){var a=$("#page"),b={connectWith:".wrapped_blocks.left, .wrapped_blocks.right",placeholder:"module_placeholder",forcePlaceholderSize:!0,handle:".header",update:ds.dashboard.sortableUpdate,receive:ds.dashboard.sortableReceive};return $(".wrapped_blocks").length<1?!1:(ds.features.hasTouch||(this.$leftDash=$(".wrapped_blocks.left").sortable(b),this.$rightDash=$(".wrapped_blocks.right").sortable(b)),this.pageResize(),a.on("click","#module_chooser",this.chooseModule),a.on("click",".remove_module",this.removeModule),$("body").on("click",".add_module",this.addModule),a.on("change",".list_module_select",this.changeListModuleSelect),!0)},ds.dashboard.sortableUpdate=function(){var a=$(this),b=a.hasClass("left")?"l":"r",c=a.sortable("serialize");c="col="+b+"&"+c,$.ajax({type:"POST",url:"/users/update_dashboard",data:c}),ds.dashboard.pageResize()},ds.dashboard.sortableReceive=function(){$(".wrapped_blocks").stop()},ds.dashboard.addModule=function(){var a;return $(".dashboard_module").length>=10?(ds.util.alert("No more than 10 items may be present on your dashboard at one time"),$("#modules_modal").dialog("close"),void 0):(a=$(this).attr("class").split(" ")[1],$.ajax({type:"POST",url:"/users/module",data:{module_name:a},success:function(b){var c=$(".wrapped_blocks.left"),d=$(".wrapped_blocks.right");c.prepend(b),c=$(".wrapped_blocks.left"),$("#dashboard_"+a).effect("pulsate",{times:1},"slow"),ds.dashboard.pageResize(),$.ajax({type:"POST",url:"/users/update_dashboard",data:"col=l&"+c.sortable("serialize"),error:function(a){ds.util.alert(a.responseText)}}),$.ajax({type:"POST",url:"/users/update_dashboard",data:"col=r&"+d.sortable("serialize"),error:function(a){ds.util.alert(a.responseText)}})},error:function(a){ds.util.alert(a.responseText)}}),"list"!==a&&$("#add_"+a).remove(),$("#modules_modal").dialog("close"),void 0)},ds.dashboard.chooseModule=function(a){$("#modules_modal").discogsDialog({position:["center",100],title:"Customize This Page"}),a.preventDefault()},ds.dashboard.removeModule=function(){var a=this.id.replace(/remove_/,""),b=$(this).parent().find(".dashboard_title").html();$("#dashboard_"+a).fadeOut(function(){$(this).remove(),ds.dashboard.pageResize(),$.ajax({type:"POST",url:"/users/update_dashboard",data:"removed="+a+"&col=l&"+ds.dashboard.$leftDash.sortable("serialize")}),$.ajax({type:"POST",url:"/users/update_dashboard",data:"removed="+a+"&col=r&"+ds.dashboard.$rightDash.sortable("serialize")})}),a.search(/^list\d+/)<0&&$("#add_modules").prepend(['<li id="add_',a,'"><a class="add_module ',a,'">',b,"</a></li>"].join(""))},ds.dashboard.changeListModuleSelect=function(){var a=$(this),b=this.value;$.ajax({type:"POST",url:"/users/update_dashboard_list",data:"obid="+b,success:function(c){var d=a.parents(".list_module");d.html($(c).html()),d.attr("id","dashboard_list"+b),ds.dashboard.pageResize()},error:function(a){ds.util.alert(a)}})},ds.dashboard.pageResize=function(){if(!ds.features.hasTouch){var a=$("#page"),b=$(".wrapped_blocks");b.height("auto"),_.defer(function(){b.height(a.height())})}},ds.discuss=ds.discuss||{},ds.discuss.init=function(){return ds.util.initComponent(ds.discuss,["thread"]),!0},ds.explore=ds.explore||{},ds.explore.sort=ds.explore.sort||{},ds.explore.init=function(){return ds.util.initComponent(ds.explore,["sort"]),$(".more_facets_link").on("click",this.toggleFacetsHandler),!0},ds.explore.sort.init=function(){return $("#layout_buttons a").on("click",this.saveArtistLayout),!0},ds.explore.sort.saveArtistLayout=function(){var a=$(this).data("size");ds.persist.updateAt("explore_layout",a)},ds.explore.toggleFacetsHandler=function(){function a(a){return function(){c.data("visible",a)}}var b=$(this),c=$("#"+b.data("for")),d=c.data("title");return c.data("visible")?(c.dialog("close"),c.dialog("destroy")):(c.find("ul.facets_nav").each(function(a,b){var c=$(b);a+=1,a>1&&0===a%3&&!c.hasClass("last")&&c.addClass("last")}),c.discogsDialog({maxHeight:400,width:c.find("ul").length>2?570:190,title:d,close:a(!1),open:a(!0)})),!1},ds.forum=function(){function a(){$(".quote_user").on("mousedown touchstart",c)}var b={};b.init=function(){return a(),$(document).on("pjax:end",a),!0};var c=function(){var a,c,f,g,h=$("#text");return c=$(this).data("mess-username"),f=$(this).parents(".thread_message").attr("id"),g=b.selection||d(f),a="[quote="+c+"]"+$.trim(g)+"[/quote]\n\n",e(h,a.toString()),h.focus(),ds.util.scrollTo(h),!1},d=function(a){var b,c,d,e="",f=window.getSelection||document.getSelection;return f?(b=f(),d=b.anchorNode):document.selection&&(b=document.selection.createRange(),d=b.parentElement(),b=b.text),c=$(d).parents(".thread_message").attr("id"),e=c==a?b:$("#"+a+" .width_limit").text()},e=function(a,b){var c,d,e;document.selection?(a.focus(),e=document.selection.createRange(),e.text=b):a.selectionStart||"0"===a.selectionStart||0===a.selectionStart?(c=a.selectionStart,d=a.selectionEnd,a.val([a.value.substring(0,c),b,a.value.substring(d,a.value.length)].join(""))):a.val(a.val()+b)};return b}(),ds.getStarted=ds.getStarted||{},ds.getStarted.init=function(){return this.parallax(),$(window).on("load.getStarted",function(){setTimeout(ds.getStarted.albumFlipper,1e4),$(this).off("load.getStarted")}),!0},ds.getStarted.parallax=function(){var a=[],b=function(b){var c=$(b.target).scrollTop();$.each(a,function(){if(c>=this.start&&c<=this.end){var a=Math.floor((c-this.start)/(this.end-this.start)*this.amount);this.$elem.css("transform","translate3d(0, "+a+"px, 0)")}})},c=function(){var c=$(".gs_parallax_bg");c.length&&!ds.features.isMobile&&ds.features.has3d&&(c.each(function(b){var c=$(this),d=c.offset().top,e={$elem:c,start:d-$(window).height()>0?d:0,end:d+c.outerHeight(),amount:c.data("parallax-amount")||200};a[b]=e}),a.length&&$(window).on("scroll",b))};return c()},ds.getStarted.albumFlipper=function(){var a=$("#gs_album_covers_bg"),b=[],c=function(){var c=Math.floor(2999*Math.random()+1);$.get("http://api.discogs.com/database/search?q=format:lp&type=release&page="+c+"&per_page=50",function(c){$.each(c.results,function(){"http://s.pixogs.com/images/record90.png"!==this.thumb&&b.push(this.thumb.replace("api.discogs.com","s.pixogs.com"))}),a.find("img:not(.loaded)").remove(),d()})},d=function(){var e=$(window).width(),f=75*(Math.floor(Math.random()*(e/75/2))-Math.floor(Math.random()*(e/75/2))),g=75*Math.floor(430*Math.random()/75)+20,h=$('<img src="'+b[0]+'" class="album_cover" style="left: 50%; margin-left: '+f+"px; top: "+g+'px;" data-album-flipper-coords="'+f+","+g+'" />'),i=a.find('img[data-album-flipper-coords="'+f+","+g+'"]');a.append(h),h.on("load.albumFlipper",function(){i.length&&i.removeClass("loaded"),$(this).addClass("loaded").off("load.albumFlipper")}),b.splice(0,1),b.length?setTimeout(d,1500):c()},e=function(){a.length&&!ds.features.isMobile&&c()};return e()},ds.help=ds.help||{},ds.help.view=ds.help.view||{},ds.help.wiki=ds.help.wiki||{},ds.help.edit=ds.help.edit||{},ds.help.init=function(){return ds.util.initByUrls(ds.help,{edit:"editdoc",view:"support/view",wiki:"wikidoc"}),ds.util.registerDelegate("body",{click:{".was_this_helpful_yes":this.wasThisHelpfulYes,".was_this_helpful_no":this.wasThisHelpfulNo}}),$("#was_this_helpful_form").submit(this.wasThisHelpfulYes),!0},ds.help.view.init=function(){$("#support_area").change(function(a){var b=ds.datagrab.get("support/view-support:requestID");ds.support.area(a,b)}),$("#support_owner").change(function(a){var b=ds.datagrab.get("support/view-support:requestID");ds.support.changeOwner(a,b)}),$("#close").change(ds.support.closeClick),$("#help-view-support-submit").submit(ds.support.checkTalk),$(".help-view-support-load-template").click(function(){var a=ds.datagrab.get("support/view-support:requestQueue");return ds.support.loadTemplate(a),!1}),$(".help-view-support-save-new-template").click(function(){return ds.support.saveTemplate(),!1}),$("#template_replace").click(function(){return ds.support.saveTemplate(1),!1})},ds.help.wiki.init=function(){$(".delete-document").click(function(){var a=$(this).attr("href");return ds.util.confirm($(this).data("click-confirm-message"),function(){window.location=a}),!1})},ds.help.edit.init=function(){$("#submitSave").click(this.submitSave)},ds.help.edit.submitSave=function(a){var b="/help/savedoc",c={};c.name=$("#docname").val(),c.publish=$("#publish:checked").length?"Y":"N",c.pagetitle=$("#pagetitle").val(),c.editor_data=$("#editdoc").val(),$.post(b,c).done(function(){$("#saving").hide()}),$("#saving").show(),a.stopPropagation()},ds.help.wasThisHelpfulYes=function(a){var b,c=$("#was_this_helpful_form");return $(".was_this_helpful_no").hasClass("selected")&&(b=$("#was_this_helpful_notes textarea"),!b.val())?(ds.util.alert("You must enter a comment."),!1):($.post("/help/ratedoc",c.serialize()).done(function(){$(".was_this_helpful").html("Thank you.")}),a.preventDefault(),void 0)},ds.help.wasThisHelpfulNo=function(a){var b=$("#was_this_helpful_notes");b.show().find("textarea").focus(),$(".was_this_helpful_yes").hide(),$(".was_this_helpful_no").addClass("selected"),$("#was_this_helpful_rating").val("N"),a.preventDefault()},ds.history=ds.history||{},ds.history.init=function(){return ds.util.initComponent(ds.history,["form","submissions"]),!0},ds.label=ds.label||{},ds.label.init=function(){var a=$("body");return ds.util.initComponent(ds.label,"miniMenu"),this.$miniMenuListAdd=$(".mini-menu-list-add"),this.$miniMenuListAdd.length>0&&this.$miniMenuListAdd.click(this.miniMenuListAdd),$(".label-jump-reviews").click(function(){ds.util.track("label","jump_reviews")}),$(".label-jump-lists").click(function(){ds.util.track("label","jump_lists")}),a.on("click",".mr_toggler",ds.label.toggleMasterRelease),$(".remove_listitem").click(ds.artist.removeListItem),!0},ds.label.toggleMasterRelease=function(){var a,b,c,d=$(this),e=d.parents("tr"),f=e.attr("class").split(" ");a=_.find(f,function(a){return"m"===a[0]}),b=e.parent().find("tr.version_"+a),c=$(this).find("span").first(),b.toggle(),d.hasClass("open")?(d.removeClass("open"),c.html("&#x25C4;")):(d.addClass("open"),c.html("&#x25BC;"))},ds.label.miniMenu={init:function(){this.$menuli=$(".mini_menu li"),this.$menuli.length>0&&this.$menuli.on("mouseover mouseout",ds.label.miniMenu.action)},action:function(a){var b=$(this).children("div"),c=$(this).children("a").first();"mouseover"===a.type?(b.show(),c.addClass("active")):(b.hide(),c.removeClass("active"))}},ds.label.miniMenuListAdd=function(){var a=$(this),b=a.data("list-add-what"),c=a.data("list-add-obid");ds.addtolist&&ds.addtolist.add(b,c)},ds.label.labelSort=function(){var a=$(this),b=a.children("span.linkText"),c="";b.length&&(c=b.text().replace(/[^\w]+/,"").toLowerCase(),ds.util.track("label","sort",c))},ds.label.genreSort=function(){var a=$(this),b="";a.length&&(b=$.text().replace(/[^\w]+/g,"_").toLowerCase(),ds.util.track("label","genre",b))},ds.lists=ds.lists||{},ds.lists.init=function(){return ds.lists.initialized?!1:(ds.lists.quilt.init(),$("#report-list").on("click",ds.lists.reportListHandler),!0)
},ds.lists.quilt={init:function(){var a=$("#lists_quilt").hide(),b=$(".listitem_image a").find("img").filter(function(){return"/images/spacer.gif"!==this.src}),c=ds.lists.quilt.findWrapPoint(b.length);_.each(b,function(b){var c=$(b).clone();c.addClass("lists_quilt_image"),a.append(c)}),a.width(c*a.find(".lists_quilt_image:first").width()),a.show()},findWrapPoint:function(a){var b=10,c=20,d=20,e=Math.sqrt(a);if(e===parseInt(e,!1))return e;if(a>=2*d)return c;for(;d>b&&0!==a%d;)d-=1;return d}},ds.lists.reportListHandler=function(){function a(a){$("#report-list").replaceWith('<span class="postTs">(Reported)</span>'),_.has(a,"success")&&_.has(a,"message")&&ds.util.alert(a.message)}function b(){$.ajax({type:"POST",url:"/lists/report",data:{id:c},success:a})}var c=ds.datagrab.get("lists/view:listReportID");ds.util.confirm(ds.content.reportListConfirm,b)},ds.marketplace=ds.marketplace||{},ds.marketplace.init=function(){ds.util.initByUrls(ds.marketplace,{buy:"buy-music",manage:"/sell/manage",list:["list_release","list","sell","/buy/"],order:["order","orders"],payment:["settings/payment","/settings/seller","settings/buyer","sell/paypal_settings"],checkout:"checkout",itemconditions:"post",feedback:"_feedback",digital:["buy-music","mp3","digital"],upload:["upload","upload_product_search"],cart:"cart"}),$("#open_offer").click(this.itemOpenOffer),$(".morelink").click(this.moreComments),$(".lesslink").click(this.lessComments);var a=$("#offer_form");return a.data("show-offer-form")&&(a.data("has-validation-message")&&(a.prepend($(".alert_message")),a.find(".alert_message .set_to_page_width").removeClass("set_to_page_width")),this.itemOpenOffer()),a.on("keyup change",".offer_price",ds.marketplace.offerPriceHandler),!0},ds.marketplace.offerPriceHandler=function(a){ds.marketplace.convertOfferPrice(a.target),ds.marketplace.controlSubmitButton(a.target.value)},ds.marketplace.controlSubmitButton=function(a){var b=!!$.trim(a);$("#submit_offer_button").prop("disabled",!b)},ds.marketplace.itemOpenOffer=function(){return ds.marketplace.controlSubmitButton($("#offer_price").val()),$("#offer_form").discogsDialog({width:500,title:"Make an Offer"}),!1},ds.marketplace.moreComments=function(){var a=$(this).data("more-link-id");return $("#fullcomments"+a+", #lesslink"+a).show(),$("#shortcomments"+a+", #morelink"+a).hide(),!1},ds.marketplace.lessComments=function(){var a=$(this).data("less-link-id");return $("#fullcomments"+a+", #lesslink"+a).hide(),$("#shortcomments"+a+", #morelink"+a).show(),!1},ds.marketplace.convertOfferPrice=function(a){var b=$(".offer_price_converted"),c=parseFloat(a.value,10),d=b.data("item-currency"),e=b.data("my-currency"),f="";d!==e&&(c>0&&(f="(about "+ds.marketplace.convertCurrency(c,d,e).toFixed(2)+" "+e+")"),b.html(f))},ds.marketplace.convertCurrency=function(a,b,c){var d=ds.datagrab.get("m:currencyRates");return a*d[b]/d[c]},ds.marketplace.updateOrderPrices=function(a,b){var c=$(this).find(":selected"),d=$(this).data("currency-abbr"),e=$(this).data("currency-prefix"),f=$(this).data("subtotal"),g=c.data("amount"),h=g+f,i=ds.templates.price(ds.marketplace.priceContext(e,f,d,a,b)),j=ds.templates.price(ds.marketplace.priceContext(e,g,d,a,b)),k=ds.templates.price(ds.marketplace.priceContext(e,h,d,a,b,!0));$(this).find(".order_shipping_amount").html(j),$(this).find(".order_subtotal .order_summary_value").html(i),$(this).find(".order_total .order_summary_value").html(k)},ds.marketplace.priceContext=function(a,b,c,d,e,f){var g={prefix:a,amount:b,abbr:c,converted:c!==d};return g.converted&&(g.myAmount=ds.marketplace.convertCurrency(b,c,d),g.myAbbr=d,g.myPrefix=e,g.about=!!f),g},ds.marketplace.renderCartItemsTotal=function(a){var b='<i class="icon-shopping-cart"></i> ';a=Math.max(a,0),a&&(b+='<span id="cart_items_total" class="activity_menu_total">'+a+"</span>"),$("#cart_link").html(b).toggleClass("accent",!!a)},ds.marketplace.modifyCartItemsTotal=function(a){var b=$("#cart_items_total"),c=(b.length?Number(b.text()):0)+a;ds.marketplace.renderCartItemsTotal(c)},ds.master=ds.master||{},ds.master.editForm=ds.master.editForm||{},ds.master.init=function(){return ds.util.initComponent(ds.master,"editForm"),!0},ds.master.editForm.init=function(){var a=ds.master.editForm;return $("#mr_panel").length||$("#form1.master_edit").length?(a.$masterId=$("#master_id"),a.$mrType=$("#mr_type"),a.$keyReleaseId=$('input[name="master.main"]'),a.$releaseIds=$('textarea[name="master.releases"]'),a.$previewBtn=$("#previewBtn"),a.$previewDiv=$("#previewDiv"),a.$notes=$('textarea[name="master.notes"]'),a.$subNotes=$('textarea[name="sub.notes"]'),a.$previewBtn.click($.proxy(a.clickPreview,a)),void 0):!1},ds.master.editForm.clickPreview=function(){var a,b=this,c=b.$masterId.val(),d=parseInt(b.$keyReleaseId.val(),10)||"",e=_.chain(b.$releaseIds.val()).trim().hasValue().value()&&(_.chain(b.$releaseIds.val()).trim().lines().value()||[]),f=b.$notes.val(),g=b.$subNotes.val(),h=b.$mrType.val()||"create",i=b.valid(h,d,e),j=_.isEmpty(i);return j?(b.$previewDiv.html("preview...").show(),$("html, body").animate({scrollTop:0},"fast"),a={master_id:c,main:d,mr_notes:f,sub_notes:g,mr_type:h},e&&(a.ids=_.map(e,function(a){return parseInt(a,10)}).join(",")),$.post("/master/preview",a,$.proxy(b.renderPreview,b))):ds.util.alert(i.join("\n")),!1},ds.master.editForm.valid=function(a,b,c){var d=[];return"edit"===a&&_.isEmpty(c)&&!_.isNumber(b)?d:(_.isNumber(b)||d.push("Please enter a Key Release ID"),_.hasValue(c)?(c.length<2&&d.push("Please enter at least one Release ID in addition to the Key Release ID."),_.each(c,function(a){parseInt(a,10)||d.push(a+" is invalid. Release IDs "+"should only contain numbers.")})):d.push("Please enter your Release IDs. Be sure to include the Key Release ID."),d)},ds.master.editForm.renderPreview=function(a){var b=this,c="6LeVJsMSAAAAAGzRbIlXiV28DTtzg29RJj-wEIw0",d=window.Recaptcha||!1;b.$previewDiv.html(a),d&&$("#recaptcha").length>0&&d.create(c,"recaptcha",{theme:"clean",callback:d.focus_response_field})},ds.messages=ds.messages||{},ds.messages.compose={},ds.messages.view={},ds.messages.init=function(){return ds.util.initByUrls(ds.messages,{compose:"messages/compose",view:"messages/view"}),!0},ds.messages.compose.init=function(){$("#previewbtn").click(this.preview),ds.datagrab.get("messages/compose:itemIdRequired")&&ds.messages.compose.focusBody()},ds.messages.compose.preview=function(){var a=ds.datagrab.get("staticServer")||"",b={body:$("#body").val(),subject:$("#subject").val()},c=$("#preview");c.html("<img src="+a+'"/images/spinner.gif"> generating preview...'),c.show(),$.post("/messages/preview",b,ds.messages.compose.previewReply)},ds.messages.compose.previewReply=function(a){$("#preview").html(a)},ds.messages.compose.focusBody=function(){$("#body").focus()},ds.messages.view.init=function(){this.$doPreview=$("#doPreview"),this.$reply=$("#reply"),this.$doPreview.on("click",this.preview),this.$reply.on("click",this.reply)},ds.messages.view.preview=function(){var a=ds.datagrab.get("staticServer")||"",b=$("#preview"),c=['<img src="'+a+'/images/spinner.gif"> generating preview...'].join("");b.html(c).show(),$.post("/messages/preview",$("form[name=replyForm]").serialize(),ds.messages.compose.previewReply)},ds.messages.view.reply=function(){var a=$("#replyBody"),b=a.get(0),c=ds.datagrab.get("messages/view:replyLength");$("#replyForm").show(),a.focus().scrollTop(a[0].scrollHeight-a.height()),$.isFunction(b.setSelectionRange)&&b.setSelectionRange(c,c)},ds.quicklist=ds.quicklist||{},ds.quicklist.init=function(){var a=$("body"),b=$(window);return $("#quicklister").length?(this.slideOpen="+=33%",this.slideClose="-=33%",this.openTime=250,this.closeTime=this.openTime/2,this.searchable=["artist","title","catno","barcode","label","genre","format","year","release_id"],this.defaultFilters=["artist","title"],this.apiRootUri=ds.datagrab.get("apiServer"),this.$resultsIndicator=$("#resultsIndicator"),this.$postIndicator=$("#postIndicator"),this.$resultsPane=$("#resultsPane"),this.$postPane=$("#postPane"),this.currency=ds.datagrab.get("quicklist/index:currency"),this.sres=ds.datagrab.get("quicklist:sres"),this.spost=ds.datagrab.get("quicklist:spost"),this.currentFile={},$("#acceptedFieldsHelp").on("click",this.clickAcceptedFieldsHelp),$("#qlsearch").on("submit",this.submitQlSearch),$("#qladvanced, .fileSearch").on("submit",this.submitFileOrAdvanced),$("#fileUpload").on("submit",this.submitFileUpload),$("#uploadTarget").on("load",this.loadUploadTarget),$("#uploads_open_file").on("click",this.clickSearchPaneLink),$("#startOver").on("click",this.clickStartOver),a.on("click",".fileUpload",this.clickFileUpload).on("click",".nextPage",this.clickNextPage).on("click","ul.uploadRows > li[class!=selected]",this.clickUploadRowItem).on("click",".filterSearch",this.clickFilterSearch).on("submit",".actionBar form",this.clickActionBarForm).on("click","#salesHistoryDetails",this.clickSalesHistoryDetails).on("click",".getMpItems",this.clickGetMpItems).on("keyup","#postItemForSale input[name=price]",this.keyupSaleItemPrice).on("submit","#postItemForSale",this.submitSaleItem).on("click",".uploadRows li.listedItem",this.clickUploadItem).on("click","#logIn",this.clickLogIn).on("click","#createAccount",this.clickCreateAccount).on("click",".prepareListing",this.clickPrepareListing).on("mouseenter mouseleave",".prepareListing",this.hoverPrepareListing).on("keyup","#comments",ds.quicklist.checkWords).on("click",".helpModal, #helpModal",this.clickHelpModal).on({mouseenter:this.hoverPreviewRelease,mouseleave:this.hoverOffPreviewRelease},".previewRelease").on({mouseenter:this.hoverReleasePreview,mouseleave:this.hoverOffReleasePreview},".releasePreview"),this.$helpModal=$('<div id="helpModal" />').appendTo(a),b.on("resize",this.resizeWindow),this.resizeWindow(),this.evaluateSearch(),!0):!1},ds.quicklist.checkWords=function(){var a=["promo","white label","version","reissue","repress","different catalogue","same (tracklist|tracks)","not same","not the (CD|LP|cassette|vinyl)","not listed on discogs","not on discogs","different (label|pressing|artwork)","i sell","i am selling","attention!","my copy has","minimum (order|purchase)","ebay","\\w+ (pressing|press)"],b=new RegExp(a.join("|"),"i"),c=$("#comments"),d=$("#comment_notice");-1!==c.val().search(b)?d.removeClass("condesc_off").addClass("condesc"):d.removeClass("condesc").addClass("condesc_off")},ds.quicklist.loadPanes=function(a){function b(){ds.quicklist.$resultsIndicator.hide()}function c(){return ds.quicklist.getResults(a,function(){ds.quicklist.openPane(ds.quicklist.$resultsPane).then(b)})}ds.quicklist.$resultsIndicator.show(),$("#resultsPaneDefault, #postPaneDefault").remove(),ds.quicklist.$postPane.is(":visible")?ds.quicklist.closePane(ds.quicklist.$postPane).then(function(){ds.quicklist.closePane(ds.quicklist.$resultsPane).then(c)}):ds.quicklist.$resultsPane.is(":visible")?ds.quicklist.closePane(ds.quicklist.$resultsPane).then(c):c()},ds.quicklist.getResults=function(a,b){var c=$.deparam.querystring().release_id||"",d=$.deparam.querystring().master_id||"";"qladvanced"!==a.attr("id")||$("#release_id").val()!==c&&$("#master_id").val()!==d?(ds.quicklist.openTime=250,$.getJSON(ds.quicklist.searchReleasesUri(a.serialize()),function(b){ds.quicklist.parseSearchResults(b.data,a)})):(ds.quicklist.openTime=0,ds.quicklist.parseSearchResults(ds.quicklist.sres,a),ds.util.track("quick_lister","reveal_release","id_"+(c||d))),b()},ds.quicklist.parseSearchResults=function(a,b){var c=a;c.formObj=b.serializeArray(),ds.quicklist.$resultsPane.scrollTop(0).find(".inner_pane").html(_.template($("#resultsTemplate").html(),c)),$.each(c.results,function(a,b){b.thumb=b.thumb?b.thumb.replace("api.discogs","s.pixogs"):"//s.pixogs.com/images/record50.png",$("#resultsPane .inner_pane > ul").append(_.template($("#"+b.type+"ResultTemplate").html(),{result:b})),$("#resultsPane .inner_pane > ul > li:even").addClass("even")}),1===c.results.length&&(ds.quicklist.$postIndicator.show(),ds.quicklist.getRelease(c.results[0].id,function(){ds.quicklist.populatePostItemForm(b),ds.quicklist.$postPane.show().animate({left:ds.quicklist.slideOpen},ds.quicklist.openTime,function(){ds.quicklist.$postIndicator.hide()})}))},ds.quicklist.getRelease=function(a,b){function c(a){var b,c=$(".fileSearchCurrent");ds.quicklist.$postPane.find(".inner_pane").html(_.template($("#postTemplate").html(),a)),b=ds.quicklist.$postPane.find(".suggested_price"),ds.priceSuggester.create(b,ds.quicklist.$postPane.find("#price"),ds.quicklist.$postPane.find("select[name=condition]"),a.suggested_prices),b.tooltip(),$("#post_section_artist_title a, #post_section_label_title a",ds.quicklist.$postPane).addClass("new_window"),c&&ds.quicklist.populatePostItemForm(c)}var d=$.Deferred(),e=d.promise();return e.then(c),"undefined"!=typeof b&&e.then(b),ds.quicklist.$postPane.attr("class","pane post-release-"+a),ds.quicklist.sres&&ds.quicklist.spost&&ds.quicklist.spost.releaseId===a?d.resolve(ds.quicklist.spost):(ds.quicklist.openTime=250,$.get("/sell/get_release/"+a,function(a){a.uploadId=ds.quicklist.currentFile.id,a.rowNum=ds.quicklist.currentFile.rowNum}).then(d.resolve)),e},ds.quicklist.populatePostItemForm=function(a){var b=$("#postItemForSale select[name=condition]"),c=$("#postItemForSale select[name=sleeve_condition]"),d=$("#postItemForSale input[name=comments]"),e=$("#postItemForSale input[name=external_id]"),f=$("#postItemForSale input[name=price]"),g=$("#postItemForSale input[name=allow_offers]");b.val(a.children("input[name=media_condition]").val()),c.val(a.children("input[name=sleeve_condition]").val()),d.val(a.children("input[name=comments]").val()),e.val(a.children("input[name=external_id]").val()),f.val(a.children("input[name=price]").val()),"Y"===a.children("input[name=allow_offers]").val()&&g.click(),$("#postItemForSale input[name=price]").trigger("keyup")},ds.quicklist.renderRows=function(a){var b=$("ul.uploadRows"),c=parseInt(a.pagination.page,10),d=parseInt(a.pagination.pages,10),e=parseInt(a.pagination.per_page,10),f=ds.datagrab.get("static_server")||"";1===c&&b.children().remove(),_.each(a.rows,function(a){b.append(_.template($("#rowTemplate").html(),{row:a,searchable:ds.quicklist.searchable,default_filters:ds.quicklist.defaultFilters}))}),d>c&&b.append('<li><a class="nextPage" data-page="'+(c+1)+'">Load next '+e+'</a> <img src="'+f+'/images/spinner.gif" class="paginationIndicator" style="display:none" /></li>')},ds.quicklist.doFilterDisplay=function(a){var b=$(a),c=b.data("field"),d=$(".fileSearch input[name="+c+"]"),e=$(".searchDisplay_"+c),f=b.prop("checked");d.prop("disabled",!f),e.toggleClass("quicklist_search_display_gray",!f)},ds.quicklist.submitQlSearch=function(a){var b=$('input[name="ql"]').val();return b.length<2?!1:(ds.quicklist.loadPanes($(this)),ds.util.track("quick_lister","basic_search"),a.preventDefault(),void 0)},ds.quicklist.submitFileOrAdvanced=function(a){var b=$(this);ds.quicklist.loadPanes(b),$(".fileSearchCurrent").removeClass("fileSearchCurrent"),b.addClass("fileSearchCurrent"),ds.util.track("quick_lister","detail_search"),a.preventDefault()},ds.quicklist.submitFileUpload=function(){var a=$(this);return a.find("input[type=file]").val()?(a.find("input[type=submit]").toggle(),$("#uploadFileIndicator").toggle(),void 0):(ds.util.alert("Please choose a file to upload"),!1)},ds.quicklist.loadUploadTarget=function(){var a=$.parseJSON(this.contentDocument.body.innerText),b=null,c=$('<li class="body_row" />').insertAfter("#uploadFiles li.header"),d=function(){$.get("/sell/ql_upload_progress",{token:a.token},function(e){c.html("Processing, "+Math.floor(100*e.progress)+"%"),1===e.progress?(clearTimeout(b),c.html(["Completed! <br />",'<a class="fileUpload" data-id="',a.id,'">',"Open: ",a.filename,"</a>"].join("")),$("#uploadFile-"+a.id).trigger("click")):b=setTimeout(d,1e3)})};b=setTimeout(d,1e3),$("#uploadFileIndicator").toggle()},ds.quicklist.clickSearchPaneLink=function(){$(this).fadeOut(),$("#uploadedFile").fadeOut(function(){$(".uploadWrapper").fadeIn()})},ds.quicklist.clickFileUpload=function(){$(".uploadWrapper").fadeOut(function(){$("#uploadedFile").fadeIn()}),ds.quicklist.currentFile.id=$(this).data("id"),$.getJSON("/sell/ql_upload_rows",{id:ds.quicklist.currentFile.id},function(a){var b=_.template($("#uploadedFileTemplate").html(),{header:a.header,searchable:ds.quicklist.searchable,default_filters:ds.quicklist.defaultFilters}),c=$("#uploadedFileIndicator");c.toggle(),$("#uploadedFile").html(b),$("#uploads_open_file").fadeIn(),ds.quicklist.renderRows(a),$("ul.uploadRows > li:first").trigger("click"),c.toggle(),$(".filterSearch").each(function(){ds.quicklist.doFilterDisplay(this)})})},ds.quicklist.clickNextPage=function(){var a=$(this);$(".paginationIndicator").toggle(),$.getJSON("/sell/ql_upload_rows",{id:ds.quicklist.currentFile.id,page:a.data("page")},function(b){a.parent().remove(),ds.quicklist.renderRows(b),$(".filterSearch").each(function(){ds.quicklist.doFilterDisplay(this)})})},ds.quicklist.clickUploadRowItem=function(){var a=$(this),b=a.find("div.extra"),c=a.find("form.fileSearch");ds.quicklist.currentFile.rowNum=a.data("row-num"),$("ul.uploadRows > li[class=selected]").removeClass("selected").children("div.extra").slideUp(),a.addClass("selected"),b.slideDown(function(){ds.quicklist.loadPanes(c),$(".fileSearchCurrent").removeClass("fileSearchCurrent"),c.addClass("fileSearchCurrent")})},ds.quicklist.clickFilterSearch=function(){var a=$(".fileSearchCurrent"),b=$(".filterSearch:checked");ds.quicklist.doFilterDisplay(this),ds.quicklist.defaultFilters=_.map(b,function(a){return $(a).data("field")}),a.length&&b.length&&ds.quicklist.loadPanes(a)},ds.quicklist.clickActionBarForm=function(a){var b=$(".uploadRows li.selected");$.post("/sell/ql_no_match",{upload_id:ds.quicklist.currentFile.id,row_num:ds.quicklist.currentFile.rowNum}),b.fadeOut(function(){b.next().trigger("click"),b.remove()}),a.preventDefault()},ds.quicklist.clickPrepareListing=function(){function a(){return ds.quicklist.openPane(ds.quicklist.$postPane)}function b(){return ds.quicklist.closePane(ds.quicklist.$postPane)}function c(){ds.quicklist.$postIndicator.show();var a=ds.quicklist.getRelease(d.data("release-id"));return a.then(function(){ds.quicklist.$postIndicator.hide()}),a}var d=$(this),e=d.data("release-id");$("#resultsPane li.selected").removeClass("selected"),d.addClass("selected");var f=!ds.quicklist.$postPane.hasClass("post-release-"+e),g=ds.quicklist.$postPane.is(":visible");f?g?b().then(function(){c().then(a)}):c().then(a):g||a()},ds.quicklist.openPane=function(a){return a.show().animate({left:ds.quicklist.slideOpen},{duration:ds.quicklist.openTime}).promise()},ds.quicklist.closePane=function(a){return a.animate({left:ds.quicklist.slideClose},{duration:ds.quicklist.closeTime}).promise().then(function(){a.hide()})},ds.quicklist.hoverPrepareListing=function(){$(this).find("a.previewRelease").toggleClass("hidden")},ds.quicklist.clickSalesHistoryDetails=function(){$("#historyDetails").slideToggle(),ds.util.track("quick_lister","show_sales_history")},ds.quicklist.clickGetMpItems=function(){var a=$(this);return a.hasClass("loaded")?($("#mpItems").slideToggle(),void 0):($("#mpItems").slideToggle(),$("#mpResultsIndicator").show(),$.ajax({url:ds.quicklist.apiRootUri+"/marketplace/search",data:"release_id="+a.data("release-id"),dataType:"jsonp",success:function(b){$.each(b.data,function(a,b){$("#mpItems tbody").append(_.template($("#mpResultTemplate").html(),{result:b}))}),a.addClass("loaded"),$("#mpResultsIndicator").hide()}}),ds.util.track("quick_lister","show_current_listings"),void 0)},ds.quicklist.keyupSaleItemPrice=function(){var a=parseFloat(this.value);return isNaN(a)||"number"!=typeof a||.1>a?($("#fee").html("0.00"),!1):($.ajax({url:ds.quicklist.apiRootUri+"/marketplace/fee/"+a.toFixed(2)+"/"+ds.quicklist.currency,dataType:"jsonp",success:function(a){$("#fee").html(a.data.value.toFixed(2))}}),void 0)},ds.quicklist.submitSaleItem=function(a){var b,c=$(this);c.children("button[type=submit]").prop("disabled",!0),$.ajax({type:"POST",url:"/sell/ql_post",data:c.serialize()}).done(function(a){if(a.errors.length){var d=$("#errors");d.show().html("<div>The following errors preventing this item from being listed</div><ul></ul>"),$.each(a.errors,function(a,b){d.children("ul").append("<li>"+b+"</li>")}),d.effect("pulsate",{times:2}),c.children("button[type=submit]").prop("disabled",!1)}else $("#postSection").html(_.template($("#postSuccessTemplate").html(),a.item)),b=$(".uploadRows li.selected"),b.length&&b.html(ds.quicklist.currentFile.rowNum+". Listed for sale.").effect("highlight").removeClass("selected").data("uri","/sell/item/"+a.item.item_id).addClass("listedItem").next().trigger("click"),ds.util.track("quick_lister","post_item_done"),$("label[for=release_id], #release_id").remove(),$("label[for=master_id], #master_id").remove()}),ds.util.track("quick_lister","post_item"),a.preventDefault()},ds.quicklist.clickUploadItem=function(){window.open($(this).data("uri"),"_blank")},ds.quicklist.clickStartOver=function(){window.location="/sell"},ds.quicklist.clickLogIn=function(){window.location.href="/login"},ds.quicklist.clickCreateAccount=function(){window.location.href="/users/create"},ds.quicklist.clickAcceptedFieldsHelp=function(a){$("#acceptedFieldsModal").discogsDialog({height:560,width:500,title:"Accepted Fields",resizable:!0,draggable:!0}),a.preventDefault()},ds.quicklist.hoverPreviewRelease=function(){var a=$(this),b=a.offset(),c=$(".releasePreview"),d=setTimeout(function(){c.animate({top:b.top-100,left:b.left-633},0,function(){var b=a.parents("li.release").data("release-id");$.get("/sell/get_release_html/"+b,{styleVersion:!0},function(a){c.html(a).show().scrollTop(0)})})},500);a.data("timeout",d)},ds.quicklist.hoverOffPreviewRelease=function(){var a,b=$(".releasePreview");clearTimeout($(this).data("timeout")),a=setTimeout(function(){b.hide()},250),b.data("hideTimeout",a)},ds.quicklist.hoverReleasePreview=function(){clearTimeout($(this).data("hideTimeout"))},ds.quicklist.hoverOffReleasePreview=function(){var a=$(this),b=setTimeout(function(){a.hide()},250);$(this).data("hideTimeout",b)},ds.quicklist.searchReleasesUri=function(a){return ds.quicklist.apiRootUri+"/database/search?"+a+"&type=release&exclude=file&f=json&callback=?"},ds.quicklist.evaluateSearch=function(){var a,b=$("#qlsearch input:text, #qladvanced input:text"),c=!1;b.each(function(){return $(this).val()?(c=!0,!1):void 0}),c?(a=b.parents("form"),ds.quicklist.loadPanes(a),ds.util.track("quick_lister",a.data("ga"))):$("#resultsPaneDefault").show().animate({left:ds.quicklist.slideOpen},ds.quicklist.openTime,function(){$("#postPaneDefault").show().animate({left:ds.quicklist.slideOpen},ds.quicklist.openTime)})},ds.quicklist.clickHelpModal=function(a){$.get(this.href,function(a){var b=ds.quicklist;a&&b.$helpModal.html(a).discogsDialog({title:this.title,width:800,height:560})}),a.preventDefault()},ds.quicklist.resizeWindow=function(){var a=$(window).height(),b=ds.util.getElementMetrics($("#quicklister_interior")).top;$("#quicklister").find("#quicklister_interior, .pane, .pane .inner_pane, .my_upload_wrapper").height(Math.max(a-b-28,560))},ds.recommendations=ds.recommendations||{},ds.recommendations.init=function(){return this.$parent=$("#slider_recs"),this.$parent.length<1?void 0:(this.pagetype=ds.datagrab.get("recommendations/_macro:pagetype"),this.pageid=ds.datagrab.get("recommendations/_macro:pageid"),this.$parent.length>0&&this.$parent.bind("slider_load_page",this.loadUrl),!0)},ds.recommendations.loadUrl=function(a,b){var c,d,e,f,g=ds.recommendations;b.find(".loading").length>0&&(d=b.attr("class"),e=d.match(/p(\d+)/)[1],c=parseInt(e,10)+1,f="/release/recs/{{id}}",f=f.replace("{{id}}",g.pageid),$.get(f,{type:g.pagetype,page:c},function(a){b.html(a)}))},ds.release=ds.release||{},ds.release.master=ds.release.master||{},ds.release.init=function(){return this.releaseID=ds.datagrab.get("release/view:releaseId"),this.inlineEditFields=ds.datagrab.get("release/view:collectionFieldOpts"),this.override=!1,ds.release.utilSetup(),ds.release.initAddToListMenu(),this.releaseID&&(ds.util.track("release","view_release_id","releaseID_"+this.releaseID),ds.util.initComponent(ds.release,"events")),ds.util.inUrl("/release/merge")&&ds.util.initComponent(ds.release,"merge"),ds.release.moveTitleOnBreakpoints($("#profile_title")),!0},ds.release.moveTitleOnBreakpoints=function(a){function b(){$(".body").prepend(a)}function c(){$(".profile").prepend(a)}0!==a.length&&$("html").hasClass("is_mobile needs_reduced_ui")&&$(window).on("breakpoint<=mobile",b).on("breakpoint>mobile",c)},ds.release.initAddToListMenu=function(){ds.release.$addToListMenu=$("#release_utils"),ds.release.$utilShow=$("span.r_util"),ds.release.$utilShow.on("click.addToListMenu",ds.release.showAddToListMenu)},ds.release.showAddToListMenu=function(){var a,b,c,d,e,f=$(this);f.parent().append(ds.release.$addToListMenu),a=ds.util.getElementMetrics(f,!0),b=ds.util.getElementMetrics(ds.release.$addToListMenu,!0),c=a.right-b.width,d=a.bottom,e=Math.max(b.width,a.width),ds.release.$addToListMenu.css({left:c,top:d,width:e}),f.addClass("active"),ds.release.$addToListMenu.addClass("active"),setTimeout(function(){$(window).on("click.addToListMenu",ds.release.hideAddToListMenu),ds.release.$utilShow.off("click.addToListMenu"),ds.release.$utilShow.on("click.addToListMenu",ds.release.hideAddToListMenu)},0)},ds.release.hideAddToListMenu=function(){ds.release.$utilShow.off("click.addToListMenu"),ds.release.$utilShow.on("click.addToListMenu",ds.release.showAddToListMenu),$(window).off("click.addToListMenu"),ds.release.$utilShow.removeClass("active"),ds.release.$addToListMenu.removeClass("active")},ds.release.utilSetup=function(){var a=$("body");a.on("click","#ru_coll_add",this.collectionAdd),a.on("click","#ru_coll_rem",this.collectionRemove),a.on("click","#ru_want_add",this.wantlistAdd),a.on("click","#ru_want_rem",this.wantlistRemove),a.on("click","#ru_list_add",this.listAdd),a.on("click","#ru_master_edit",this.editMaster),a.on("click","#mr_a_create",this.createMaster),a.on("click","#ru_history",this.history)},ds.release.collectionAdd=function(){ds.release.actionFacade("add","coll",ds.release.collectionUpdate)},ds.release.wantlistAdd=function(){ds.release.actionFacade("add","want",ds.release.wantlistUpdate)},ds.release.collectionRemove=function(){ds.release.actionFacade("remove","coll",ds.release.collectionUpdate)},ds.release.wantlistRemove=function(){ds.release.actionFacade("remove","want",ds.release.wantlistUpdate)},ds.release.listAdd=function(){var a=ds.release.getTarget().toUpperCase().match(/([RM])(\d+)/).splice(1,2);ds.addtolist.add(a[0],a[1])},ds.release.editMaster=function(){var a=ds.release.getTarget();"m"===a.charAt(0)&&ds.release.clickMasterEdit(null,a)},ds.release.actionFacade=function(a,b,c){var d=ds.release.getTarget();"r"===d.charAt(0)&&$.ajax({type:"POST",url:"/list/"+b+"_"+a,dataType:"json",data:{release_id:d.substr(1),context:2},success:function(a){c(a.id,a.count)}})},ds.release.getTarget=function(){var a=$("#release_utils").parents("tr").attr("class");return a.match(/[a-z][0-9]+/)[0]},ds.release.getParentRow=function(a){return a.parents("tr")},ds.release.getRowHTML=function(a){var b,c,d=[],e=$("#r"+a);for(b=e.children(),c=0;4>c&&c<b.length;c++)d.push("<td>"),d.push($(b[c]).html()),d.push("</td>");return d.join("")},ds.release.getObid=function(a){a=$(a);var b=a.attr("class");return b.match(/[a-z][0-9]+/)[0]},ds.release.history=function(){var a=ds.release.getTarget();window.location.href=["/history?","r"===a.charAt(0)?"release":"master","=",a.substr(1),"#latest"].join("")},ds.release.collectionUpdate=function(a,b){var c=$(".r_tr."+a);b?c.addClass("collection"):c.removeClass("collection"),c.each(function(){var a=$(this);ds.skittles.updateStatus(a,{collection:b}),ds.release.checkMasterStatus(a)})},ds.release.wantlistUpdate=function(a,b){var c=$("tr.r_tr."+a);b?c.addClass("wantlist"):c.removeClass("wantlist"),c.each(function(){var a=$(this);ds.skittles.updateStatus(a,{wantlist:b}),ds.release.checkMasterStatus(a)})},ds.release.checkMasterStatus=function(a){var b,c,d,e,f=a.attr("class").match(/version_(m\d+)/),g=function(a){return _.reduce(a,function(a,b){return a+b},0)};f&&(c=f[1],c&&(b=$("."+c),e=$(".version_"+c),d={collection:g(e.find(".skittle_collection").map(function(){return 1*$(this).text()})),wantlist:e.filter(".wantlist").length},ds.skittles.updateStatus(b,d)))},ds.release.visible=function(a){return 0!==$("#r"+a).length},ds.release.cancelMaster=function(){var a;ds.release.isEditing&&($("tr.m"+ds.release.isEditing.id).toggleClass("hidden"),ds.release.isEditing=null),ds.release.enableEditOnMaster(!0),a=$("span.r_check"),a.html("&nbsp;"),$("#mr_panel").hide(),$("#mr_panel_inner").html(""),$("#mr_notes").val(""),$("#sub_notes").val(""),ds.release.enableButtons(),$("body").css("margin-bottom",0)},ds.release.enableEditOnMaster=function(a){var b=$("#mr_a_create"),c=$("#mr_a_edit"),d=a?"on":"off";b[d]("click.releaseEnable",ds.release.createMaster),c[d]("click.releaseEnable",ds.release.editMasterMM)},ds.release.createMaster=function(){var a=$("#mr_panel"),b=0,c=$("body"),d=$("#mr_save_button"),e=$("#mr_panel_title");ds.release.cancelMaster(),ds.release.enableEditOnMaster(!1),a.length<1||($.bbq.pushState({m:"mr"}),ds.release.createMasterCheckboxes(),d.html("Create"),d.off("click"),d.click(ds.release.saveMaster),$("#mr_cancel_button").click(ds.release.cancelMaster),a.show(),e.html("Create Master Release"),b=c.css("margin-bottom").match(/\d+/),b=parseInt(b,10)||0,b+=212,c.css("margin-bottom",b))},ds.release.editMasterMM=function(){ds.util.alert("Usage of previous master_edit. Please alert Discogs staff.");var a;ds.release.cancelMaster(),a=$("span.rcheck"),a.each(function(){var a,b,c=$(this);a=ds.release.getObid(c),"m"===a.charAt(0)&&(b=$("<button class='button_mr'>Edit</button>"),c.append(b),b.click(ds.release.clickMasterEdit))})},ds.release.clickMasterEdit=function(a,b){b=b.substr(1),ds.util.requireLogin(),$("button.button_mr").prop("disabled",!0),$.ajax({url:"/master/data",type:"GET",data:{master_id:b},success:ds.release.startEditMaster,error:function(a){ds.util.alert(ds.util.errorMessageFromXHR(a))}})},ds.release.enableButtons=function(){$("#mr_save_button").prop("disabled",!1),$("#mr_cancel_button").prop("disabled",!1)},ds.release.createMasterCheckboxes=function(){var a=$("span.r_check");a.each(function(){var a,b,c=$(this);a=ds.release.getObid(ds.release.getParentRow(c)),"r"===a.charAt(0)&&(b=$('<input type="checkbox" class="r_check '+a+'" />'),c.append(b))}),$("input.r_check:checkbox").click(ds.release.rcheckMaster)},ds.release.saveMaster=function(a){var b,c,d,e=$("input.r_radio"),f=a.data&&a.data.id,g=[],h=[],i=!1,j={data:{}};return i=ds.release.getObid(e.filter(":checked")).substr(1),g=ds.release.isEditing.originalIds,h=_.keys(ds.release.isEditing.versions),c=_(h).difference(g),d=_(g).difference(h),i?(j.data.sub_notes=$("#sub_notes").val(),ds.release.override&&(j.data.override=1),b=$("#mr_notes").val(),f?(b!==encodeURIComponent(ds.release.isEditing.notes)&&(j.data.mr_notes=b),i!==ds.release.isEditing.main&&(j.data.main=i),d.length&&(j.data.remove=d.join(",")),c.length&&(j.data.add=c.join(",")),j.data.master_id=ds.release.isEditing.id,j.url="/master/save"):(j.data.ids=_.keys(ds.release.isEditing.versions).join(","),j.data.main=i,j.data.mr_notes=b,j.url="/master/new"),j.success=function(a){"success"==a.type?ds.release.saveMasterSuccess():"warn"==a.type?ds.release.saveMasterWarn(a.msg):ds.release.saveMasterError(a.msg)},j.error=function(a){ds.release.saveMasterError(ds.util.errorMessageFromXHR(a))},j.type="POST",ds.release.disableButtons(),$.ajax(j),void 0):(ds.util.alert("Please select a key release."),void 0)},ds.release.rcheckMaster=function(){var a=$(this),b=$("input."+this.className),c=parseInt(ds.release.getObid(a).slice(1),10);b.each(function(){var b=$(this);b!==a&&b.prop("checked",a.is(":checked"))}),ds.release.isEditing||(ds.release.isEditing={versions:{},main:c}),a.is(":checked")?ds.release.isEditing.versions[c]={id:c}:delete ds.release.isEditing.versions[c],ds.release.updateMaster()
},ds.release.disableButtons=function(){$("#mr_save_button").prop("disabled",!0),$("#mr_cancel_button").prop("disabled",!0)},ds.release.updateMaster=function(){var a,b=$("#mr_panel_inner");ds.release.override=!1,a=ds.templates.editMasterTable({versions:ds.release.isEditing.versions}),b.html(a),$(".r_radio.r"+ds.release.isEditing.main).prop("checked",!0)},ds.release.startEditMaster=function(a){function b(){$(this).find("input.r_check:first").prop("checked",!0)}var c,d=$("#mr_save_button"),e=$(".m"+a.id),f=e.find("span.toggle_indicator");ds.release.createMaster(null,a.id),ds.release.isEditing=a,ds.release.isEditing.originalIds=_.keys(a.versions),$("tr."+e.attr("id")).toggleClass("hidden"),e.hasClass("open")?(e.removeClass("open"),f.html("&#x25C4;")):(e.addClass("open"),f.html("&#x25BC;")),_.each(a.versions,function(a,d){c=$("tr.r_tr.r"+d),0!==c.length&&c.each(b)}),$("#mr_notes").val(a.notes),ds.release.updateMaster(),d.html("Save"),d.off("click"),d.on("click",{id:a.id},ds.release.saveMaster),$("#mr_panel_title").html("Edit Master Release")},ds.release.saveMasterError=function(a){ds.release.enableButtons(),ds.util.alert("Error:\n\n"+a)},ds.release.saveMasterSuccess=function(){ds.release.cancelMaster(),ds.util.alert("Master release saved successfully and will be processed soon. Please refresh the page in a minute to see the updated discography."),window.location.reload()},ds.release.saveMasterWarn=function(a){ds.util.alert("Warning:\n\n"+a+"\n\nClick "+$("#mr_save_button").html()+" again to save anyway."),ds.release.enableButtons(),ds.release.override=1},ds.releaselist=ds.releaselist||{},ds.releaselist.init=function(){return(ds.util.inUrl("mycollection")||ds.util.inUrl("mywantlist"))&&(this.$searchForm=$("#search_form"),this.$searchForm.length>0&&this.$searchForm.submit(this.submitSearchForm),$('[name="Action.RemoveItems"]').on("click.removeCheck",function(){var a=$(this);return ds.util.confirm("Are you sure you want to remove these items?",function(){a.off("click.removeCheck"),_.defer(function(){a.click()})}),!1})),ds.release.inlineEditFields||(ds.release.inlineEditFields=ds.datagrab.get("releaselist/*:fieldOptions")),!0},ds.releaselist.submitSearchForm=function(){var a=$("#searchbutton");a.prop("disabled",!0),a.val("Searching...")},ds.reportabuse=ds.reportabuse||{},ds.reportabuse.init=function(){return this.$form=$("#report-abuse-form"),this.$report=$(".report_item"),this.$cancel=$(".cancel_report_item"),this.$form.length<1?!1:(this.$report.length>0&&this.$report.click(this.report),this.$cancel.length>0&&this.$cancel.click(this.cancel),!0)},ds.reportabuse.report=function(a){ds.reportabuse.$form.slideDown(),a.preventDefault()},ds.reportabuse.cancel=function(a){ds.reportabuse.$form.slideUp(),a.preventDefault()},ds.reviews=ds.reviews||{},ds.reviews.init=function(){var a=$("body");return this.previewTimeout=0,ds.datagrab.get("loggedIn")?ds.datagrab.get("userIsDbBanned")||ds.reviews.restore():$("#add_new_review").on("click",_.partial(_.defer,ds.util.requireLogin)),a.on("click",".review_action1-reply",ds.reviews.contextualCompose("reply")),a.on("click",".review_action1-edit",ds.reviews.contextualCompose("edit")),a.on("click",".review_action2-notify",function(){var a=this.id.replace("rvnotify_","");ds.reviews.notify(a)}),a.on("click",".review .review_tag",ds.reviews.tag),!0},ds.reviews.compose=function(a,b,c){function d(a){ds.reviews.canCompose()&&(ds.reviews.insertHTML(a,b),ds.reviews.initCompose(c))}var e;ds.reviews.canCompose()||ds.reviews.hideOthers(),ds.util.requireLogin(),ds.reviews.composing=e=$.Deferred(),ds.reviews.mode=c;var f=$.get(a,{styleVersion:!0});f.then(d,ds.reviews.alertResponseText),f.fail(e.reject);var g=e.promise();return g.always(function(){$("#review_compose").remove()}),g},ds.reviews.initCompose=function(a){a=a||"add";var b="add"==a&&_.includeString(location.hash,"add-new-review"),c=$("#review"),d=$("#review_compose");return d.find(".quote_review").on("click",ds.reviews.quote),$("#reviews_compose_submit").on("click",function(){var b=$(this);c.prop("disabled",!0),b.prop("disabled",!0),b.text({edit:"Saving",add:"Posting",reply:"Replying"}[a]),b.blur()}),$(".reviews-compose-submit-edit").on("click",function(){var a=$(this).data("review-cid");return ds.reviews.submitEdit(a),!1}),$(".reviews-compose-submit-reply").on("click",function(){var a=$(this).data("review-parent-cid");return ds.reviews.submitReply(a),!1}),$(".reviews-compose-submit-add").on("click",function(){var a=$(this).data("review-what"),b=$(this).data("review-obid");return ds.reviews.submitAdd(a,b),!1}),$(".reviews-cancel-event").on("click",ds.reviews.cancelClickHandler),ds.reviews.validate.call(c),c.on("change keyup",ds.reviews.preview).on("change keyup",ds.reviews.validate).on("keyup",ds.reviews.cancelOnEscape),("add"!=a||b)&&c.focus(),b&&(_.delay(ds.util.scrollTo,c,10),location.hash=""),this},ds.reviews.validate=function(){var a=$.trim(this.value).split(" ").length>1;$("#review_compose #reviews_compose_submit").prop("disabled",!a)},ds.reviews.cancelOnEscape=function(a){a.keyCode==$.ui.keyCode.ESCAPE&&"add"!=ds.reviews.mode&&ds.reviews.cancel()},ds.reviews.canCompose=function(){return $("#review_compose").length<1},ds.reviews.hideOthers=function(){ds.reviews.close()},ds.reviews.add=function(a,b){return ds.reviews.compose("/reviews/add?what="+a+"&obid="+b,$("#review_space"),"add")},ds.reviews.addReviewFromElement=function(a){var b=$(a),c=b.data("reviews-add-what"),d=b.data("reviews-add-obid");return c&&d?ds.reviews.add(c,d):void 0},ds.reviews.contextualCompose=function(a){return function(){var b=$(this),c=b.closest(".review"),d="/reviews/"+a+"?id="+c.data("cid");c.addClass(a+"ing");var e=ds.reviews.compose(d,c,a);return e.always(function(){c.removeClass(a+"ing")}),"edit"===a&&e.then(function(){c.remove()}),e}},ds.reviews.preview=function(a){ds.reviews.previewTimeout&&clearTimeout(ds.reviews.previewTimeout);var b=ds.util.toString((new Date).getTime()).replace(/\D/gi,"");$(a.target).parent().find("div.review_preview").attr("id",b),ds.reviews.previewTimeout=_.delay(ds.reviews.doPreview,150,b)},ds.reviews.doPreview=function(a){a=a.target?$(a.target):$(a);var b=$("#review").val();return $(".review_preview_wrap").toggle($.trim(b).length>0),$.post("/reviews/preview",{comment:b,styleVersion:!0},function(a){$(".review_preview").html(a)})},ds.reviews.submit=function(a,b){function c(a){ds.reviews.insertHTML(a,$("#review_compose"));var b=$("#parent").val();b&&ds.reviews.notify(b,1),ds.reviews.reset(),ds.reviews.composing.resolve(d),ds.rating.init()}ds.util.requireLogin();var d=$("#review").val();("add"==ds.reviews.mode||"edit"==ds.reviews.mode)&&(b.is_review=Number($("#is_review").is(":checked"))),b.notify=Number($("#notify").is(":checked")),b.comment=d,b.styleVersion=!0;var e=$.post("/reviews/"+a,b);return e.then(c,ds.reviews.alertResponseText),e.then(ds.reviews.restore),e},ds.reviews.alertResponseText=function(a){return a.responseText.length>0?ds.util.alert(a.responseText):void 0},ds.reviews.submitAdd=function(a,b){return ds.reviews.submit("post",{what:a,obid:b})},ds.reviews.submitReply=function(a){return ds.reviews.submit("post",{id:a})},ds.reviews.submitEdit=function(a){return ds.reviews.submit("save",{id:a})},ds.reviews.cancel=function(){return ds.reviews.close(),ds.reviews.restore()},ds.reviews.restore=function(){return ds.reviews.addReviewFromElement($("#review_space"))},ds.reviews.cancelClickHandler=function(a){ds.reviews.cancel(),a.preventDefault()},ds.reviews.close=function(){ds.reviews.composing.reject(),$("#review_compose").remove()},ds.reviews.reset=function(){$("#review").val(""),$(".review_preview_wrap").hide()},ds.reviews.insertHTML=function(a,b){return $(b).after("<div>"+a+"</div>")},ds.reviews.tag=function(){var a=$(this),b=a.parents(".review_content"),c=0,d=1;return ds.util.requireLogin(),b.length>0&&b.attr("id")&&(c=b.attr("id").replace("c","")),c&&d?($.post("/reviews/tag",{cid:c,tid:d,styleVersion:!0},function(){$("#tags_rv"+c).css("font-weight","bold"),window.location.reload()}),!1):void 0},ds.reviews.quote=function(a){var b="",c=$("#review_compose").parent().prev(":not(.hidden)");b+="[quote=",b+=c.find("a.user").first().html(),b+="]",b+=$.trim(c.find("div.review_comment").first().html()),b+="[/quote]\n",b+=$("#review").val(),b=_.stripTags(b),$("#review").val(b).focus(),ds.reviews.preview(a)},ds.reviews.notify=function(a,b){return ds.util.requireLogin(),$.post("/reviews/notify",{id:a,peek:b,styleVersion:!0},function(b){$("#rvnotify_"+a).html(_.capitalize(b))})},ds.shipping=ds.shipping||{},ds.shipping={init:function(){var a,b=$(".policies"),c=$("body");return this.policies=ds.datagrab.get("shipping:policies"),this.regions=ds.datagrab.get("shipping:regions"),this.methodTypes=ds.datagrab.get("shipping:method_types"),this.endpoints=ds.datagrab.get("shipping:endpoints"),this.currSymbol=ds.datagrab.get("shipping:curr_symbol"),this.takesPayPal=ds.datagrab.get("shipping:takes_paypal"),this.enabled=ds.datagrab.get("shipping:enabled"),this.staticServer=ds.datagrab.get("staticServer")||"",this.popularRegionIds=[222,13,35,107,180,39],this.euRegionIds=[12,19,21,93,51,52,55,60,241,70,53,84,95,97,104,127,125,126,143,156,170,174,179,191,189,64,186,220],a=function(a){return ds.shipping.regions[a]},this.popularRegions=_.map(this.popularRegionIds,a),this.euRegions=_.map(this.euRegionIds,a),this.renderToggler(),this.randomTip(),this.buildRegionTree(),b.on("click",".policy.contracted",this.expandThis).on("click",".method.contracted",this.expandThis).on("click",".save_button",this.savePolicy).on("click",".method .done_button",this.contractMethodIfValid).on("change",".method .range_type",this.changeRangeType).on("change",".method .method_type",this.changeMethodType).on("click",".add_method",this.addMethod).on("click",".method .remove_button",this.removeMethod).on("click",".policy .delete_button",this.removePolicy).on("click",".add_policy",this.addPolicy).on("focus",".method_ranges .and_up",this.focusAndUpField).on("click",".add_range",this.addRange).on("click",".method_ranges .remove_link",this.removeRange).on("blur",".method_ranges .and_up",this.blurAndUpField).on("keyup",".method .range_max",this.updateNextRangeMin).on("blur",".method .range_max",this.updateRangeMax).on("change",".delivery_min, .delivery_max, .ships_within",this.clampValToPositive).on("change",".delivery_min",{me:"min",other:"max"},this.updateDeliveryRange).on("change",".delivery_max",{me:"max",other:"min"},this.updateDeliveryRange).on("blur",".range_price, .constraint_price",this.updatePrice),c.on("click",".tip_nav a",this.nextTip).on("click",".shipping_toggler",this.togglePolicies),$(".loading_placeholder").remove(),this.loadPolicies(),!0},buildRegionTree:function(){_.each(this.regions,function(a,b){if(a.title=a.name,a.icon=!1,a.key="region-id-"+b,"0"!==b.toString()){var c=ds.shipping.regions[a.parent_id];void 0===c.children&&(c.children=[]),c.children.push(a)}})},methodContext:function(a){var b=_.clone(a),c="quantity"===a.range_type,d=1,e=1,f=[];return _.each(a.ranges,function(b,c){var g=0===c?e:a.ranges[c-1][0]+d;f.push([g,b[0],b[1],b[2]])}),b.ranges=f,b.is_qty=c,{m:b,state:"contracted",types:this.methodTypes,curr_symbol:this.currSymbol}},newMethodContext:function(){return{m:{range_type:"quantity",is_qty:!0,constraint_type:"gte",constraint_price:0,ships_within:1,delivery_min:3,delivery_max:5,ranges:[[1,0,0]]},state:"expanded",types:this.methodTypes,curr_symbol:this.currSymbol}},policyContext:function(a){var b=this.policies[a],c=_.clone(b);return c.id=a,c.regions=[],_.each(b.region_ids,function(a){c.regions.push(ds.shipping.regions[a])}),{p:c}},updateRegionsLabel:function(a){var b=_.map(this.extractRegions(a),function(a){return ds.shipping.regions[a]});a.find(".regions").html(ds.templates.regions({regions:b}))},initializePolicy:function(a,b){var c=a.find(".destinations"),d=function(a){return a.title=a.name,a.icon=!1,a},e=_.map(this.popularRegions,d),f=_.map(this.euRegions,d),g=a.find(".add_method");e.unshift({title:"European Union",id:-2,icon:!1,children:f}),c.dynatree({imagePath:"/images/dynatree/",checkbox:!0,selectMode:3,idPrefix:"p"+a.data("policy-id")+"id-",children:[{title:"Popular Destinations",id:-1,expand:!0,icon:!1,children:e},this.regions[0]],onKeydown:function(a,b){return 32===b.which||13===b.which?(a.toggleSelect(),!1):void 0},onSelect:function(){ds.shipping.updateRegionsLabel(a),a.find(".destination_hint").replaceWith(ds.templates.addMethod({}))}}),a.find(".methods").sortable({handle:".drag_handle",items:".method",placeholder:"method_placeholder",forcePlaceholderSize:!0,revert:!0,stop:function(){ds.shipping.updateMethodTypesLabel($(this).parents(".policy"))}}),b&&(_.each(b.methods,function(a){g.before(ds.templates.method(ds.shipping.methodContext(a)))}),c.dynatree("getTree").visit(function(a){_.include(b.region_ids,a.data.id)&&a.select()})),this.updateMethodTypesLabel(a)},expandThis:function(a){$(this).addClass("expanded").removeClass("contracted"),a&&a.preventDefault()},contractThis:function(a){$(this).addClass("contracted").removeClass("expanded"),a&&a.preventDefault()},removeThis:function(a){$(this).fadeOut(1e3,function(){$(this).remove()}),a&&a.preventDefault()},stringToInt:function(a){return parseInt(a,10)||0},updateMethodTypesLabel:function(a){var b=[];a.find(".method_type").each(function(){b.push({method_type:$(this).val()})}),a.find(".method_types_label").html(ds.templates.methodTypes({methods:b}))},extractRegions:function(a){var b=[],c=a.find(".destinations"),d=c.dynatree("getTree").getSelectedNodes(),e=[],f=null;return _.each(d,function(a){f=a.data,-1===f.id?_.each(ds.shipping.popularRegions,function(a){b.push(a.id)}):-2===f.id?_.each(ds.shipping.euRegions,function(a){b.push(a.id)}):b.push(f.id)}),_.each(b,function(a){0!==a&&_.include(b,ds.shipping.regions[a].parent_id)&&e.push(a)}),_.uniq(_.difference(b,e))},extractPolicy:function(a){var b=[];return a.find(".method").each(function(){b.push(ds.shipping.extractMethod($(this)))}),{id:a.data("policy-id"),region_ids:this.extractRegions(a),methods:b}},extractMethod:function(a){return{ships_within:this.stringToInt(a.find(".ships_within").val()),delivery_min:this.stringToInt(a.find(".delivery_min").val()),delivery_max:this.stringToInt(a.find(".delivery_max").val()),constraint_type:a.find(".constraint_type").val(),constraint_price:parseFloat(a.find(".constraint_price").val(),10),method_type:a.find(".method_type").val(),range_type:a.find(".range_type").val(),ranges:this.extractRanges(a)}},extractRanges:function(a){var b=[];return a.find(".range").each(function(){var a=[];a.push(ds.shipping.stringToInt($(this).find(".range_max").val())),a.push(parseFloat($(this).find(".range_price").val(),10)),b.push(a)}),b},validateMethod:function(a){var b=this.extractRanges(a),c=this.validateRanges(b);return c.ok?{ok:!0}:c},validateRanges:function(a){var b,c,d=1,e=0;if(!a.length)return{ok:!1,message:"All shipping methods must define at least one range"};for(c=a.length,0===a[c-1][0]&&c--,b=0;c>b;b++){if(b>0&&a[b][0]<e+d)return{ok:!1,message:"Ranges overlap or are ordered incorrectly"};e=a[b][0]}return{ok:!0}},validatePolicy:function(a){var b,c,d=null,e=[],f=[];if(a.find(".method").each(function(){return d=ds.shipping.validateMethod($(this)),d.ok?(e.push($(this).find(".method_type").val()),void 0):!1}),null===d)return{ok:!1,message:"You must add at least one shipping method"};for(e.sort(),b=0,c=e.length;c-1>b;b++)if(e[b]===e[b+1])return{ok:!1,message:"You can't have more than one &quot;"+e[b]+"&quot;<br />shipping method in the same policy"};return d.ok?(f=this.extractRegions(a),f.length?{ok:!0}:{ok:!1,message:"You must select at least one destination"}):d},setError:function(a,b){var c=a.find(".policy_errors");b?c.html(ds.templates.policyError({message:b})).effect("pulsate",{times:3}):c.empty()},savePolicy:function(a){var b=$(this).parents(".policy"),c=ds.shipping.validatePolicy(b),d=null;return c.ok?(d=JSON.stringify(ds.shipping.extractPolicy(b)),b.find(".save_button").prop("disabled",!0).html('<img src="'+ds.shipping.staticServer+'/images/throbber.gif" /> Saving...'),$.ajax({url:ds.shipping.endpoints.save,type:"POST",data:d,dataType:"json",contentType:"application/json; charset=utf-8",success:function(a){b.data("policy-id",a.id),ds.shipping.setError(b,""),ds.shipping.contractThis.call(b)},error:function(a){ds.shipping.setError(b,ds.util.errorMessageFromXHR(a))}}).always(function(){b.find(".save_button").prop("disabled",!1).html("Save Changes")}),a.preventDefault(),void 0):(ds.shipping.setError(b,c.message),a.preventDefault(),void 0)},contractMethodIfValid:function(a){var b=$(this).parents(".policy"),c=$(this).parents(".method"),d=ds.shipping.extractRanges(c),e=ds.shipping.validateRanges(d);c.find(".method_type_label").html(c.find(".method_type").val()),ds.shipping.setError(b,e.message||""),e.ok&&ds.shipping.contractThis.call(c),a.preventDefault()},changeRangeType:function(){var a=$(this).parents(".method"),b="quantity"===$(this).val(),c=b?"items":"grams";a.find(".range_unit_label").html(c),a.find(".range_type_label").html($(this).val())},changeMethodType:function(){var a=$(this).parents(".policy");ds.shipping.updateMethodTypesLabel(a)},addMethod:function(a){var b=$(this).parents(".policy");$(this).before(ds.templates.method(ds.shipping.newMethodContext())),ds.shipping.updateMethodTypesLabel(b),a.preventDefault()},removeMethod:function(a){var b=$(this).parents(".method"),c=$(this).parents(".policy");ds.util.confirm("Remove this shipping method?",function(){b.slideUp(1e3,function(){$(this).remove(),ds.shipping.updateMethodTypesLabel(c)})}),a.stopPropagation(),a.preventDefault()},removePolicy:function(a){var b=$(this).parents(".policy"),c=b.data("policy-id");ds.util.confirm("Remove this shipping policy?",function(){b.fadeTo(500,.5),$(this).prop("disabled",!0).html('<img src="'+ds.shipping.staticServer+'/images/throbber.gif" /> Deleting...'),c?$.ajax({url:ds.shipping.endpoints["delete"],type:"POST",data:JSON.stringify({id:c}),dataType:"json",contentType:"application/json; charset=utf-8",success:function(){ds.shipping.removeThis.call(b)}}):ds.shipping.removeThis.call(b)}),a.preventDefault()},loadPolicies:function(){var a=null;_.each(this.policies,function(b,c){a=$(ds.templates.policy(ds.shipping.policyContext(c))),a.insertBefore(".add_policy"),ds.shipping.initializePolicy(a,b)})},addPolicy:function(a){var b=$(ds.templates.policy({p:{}}));$(this).before(b),ds.shipping.initializePolicy(b,{}),ds.shipping.expandThis.call(b),a.preventDefault()},focusAndUpField:function(){"and up"===$(this).val()&&($(this).parents(".range").find(".range_to").html("to"),$(this).val(""))},blurAndUpField:function(){var a=$(this).parents(".range");""===$(this).val()?(a.find(".range_to").html(""),$(this).val("and up")):ds.shipping.setRangeBounded.call(a)},setRangeBounded:function(){var a=$(this).find(".and_up");a.removeClass("and_up").addClass("range_max").addClass("parameter"),$(this).find(".range_to").removeClass("dim"),ds.shipping.updateRangeMax.call(a),ds.shipping.updateNextRangeMin.call(a)},setRangeUnbounded:function(){var a=$(this).find(".range_max");a.removeClass("parameter").removeClass("range_max").addClass("and_up"),$(this).find(".range_to").addClass("dim").html(""),a.val("and up")},addRange:function(a){var b,c=$(this).parents(".method"),d="quantity"===c.find(".range_type").val(),e=1,f=c.find(".range").last(),g=f.find(".range_min"),h=f.find(".range_max"),i=f.find(".and_up");i.length&&(i.removeClass("and_up").addClass("range_max").addClass("parameter").val(ds.shipping.stringToInt(g.val())+e),f.find(".range_to").removeClass("dim").html("to"),h=i),b=h.length?[ds.shipping.stringToInt(h.val())+e,0,0]:[1,0,0],$(this).parents("tr").before(ds.templates.range({r:b,is_qty:d,curr_symbol:ds.shipping.currSymbol})),a.preventDefault()},removeRange:function(a){var b,c=1,d=1,e=$(this).parents(".range"),f=e.prev(),g=e.next();f.length?(b=ds.shipping.stringToInt(f.find(".range_max").val()),g.find(".range_min").val(b+d)):g.find(".range_min").val(c),e.remove(),a.preventDefault()},updateNextRangeMin:function(){var a=1,b=$(this).parents(".range"),c=b.next(".range"),d=ds.shipping.stringToInt($(this).val());c.length&&c.find(".range_min").val(d+a)},updateRangeMax:function(){var a=$(this).parents(".range"),b=ds.shipping.stringToInt($(this).val());b>0?$(this).val(b):ds.shipping.setRangeUnbounded.call(a)},clampValToPositive:function(){var a=parseInt($(this).val(),10)||0;$(this).val(Math.max(0,a))},updateDeliveryRange:function(a){var b=$(this).parents(".method"),c=b.find(".delivery_"+a.data.me),d=b.find(".delivery_"+a.data.other),e=parseInt(b.find(".delivery_min").val(),10),f=parseInt(b.find(".delivery_max").val(),10),g=parseInt(c.val(),10);e>f&&d.val(g)},updatePrice:function(){$(this).val((parseFloat($(this).val(),10)||0).toFixed(2))},togglePolicies:function(a){$(".shipping_toggler").addClass("posting"),$.ajax({url:ds.shipping.endpoints.enable,type:"POST",data:JSON.stringify({enabled:!ds.shipping.enabled}),contentType:"application/json; charset=utf-8",success:function(a){ds.shipping.enabled=a.enabled},error:function(a){ds.util.alert(ds.util.errorMessageFromXHR(a))}}).always(ds.shipping.renderToggler),a.preventDefault()},renderToggler:function(){$(".shipping_toggler").removeClass("posting hidden").toggleClass("enabled",ds.shipping.enabled).html(ds.templates.toggle({enabled:ds.shipping.enabled,takesPayPal:ds.shipping.takesPayPal}))},randomTip:function(){var a=$(".tip"),b=Math.floor(Math.random()*a.length);a.removeClass("tip_active"),a.eq(b).addClass("tip_active")},nextTip:function(a){var b=$(".tip_contents .tip_active"),c=b.next();c.length<1&&(c=$(".tip_contents .tip").first()),$(".tip_container").fadeOut(200,function(){b.removeClass("tip_active"),c.addClass("tip_active"),$(this).fadeIn(800)}),a.preventDefault()}},ds.slider=ds.slider||{},ds.slider.init=function(){return this.$slider=$(".slider"),this.$slider.length>0?(this.$navLinear=this.$slider.find(".slider_next, .slider_back"),this.$navNumeric=this.$slider.parent().find(".pager"),this.$navLinear.click(this.clickLinear),this.$navNumeric.click(this.clickNumeric),this.$slider.bind("slider_slide_to",this.slideTo),!0):!1},ds.slider.clickLinear=function(){var a=1,b="recs_next";return $(this).hasClass("slider_back")&&(a=-1,b="recs_prev"),$(this).hasClass("disabled")?!1:($(this).parents(".slider").trigger("slider_slide_to",[a,!0]),ds.util.track("release",b),void 0)},ds.slider.clickNumeric=function(){var a=parseInt($(this).attr("class").match(/pager(\d+)/)[1],10);$(this).parent(".pagers").parent().find(".slider").trigger("slider_slide_to",[a])},ds.slider.slideTo=function(a,b,c){var d,e,f,g,h,i,j=$(this).find(".slider_page");j.each(function(a){return $(this).hasClass("hidden")?void 0:(d=a,!1)}),(d||0===d)&&(e=c?d+b:b,0>e||e===d||e>j.length||(j.eq(d).addClass("hidden"),j.eq(e).removeClass("hidden"),g=$(this).find(".slider_back"),h=$(this).find(".slider_next"),i=e?"removeClass":"addClass",g[i].call(g,"disabled"),i=e+1===j.length?"addClass":"removeClass",h[i].call(h,"disabled"),f=$(this).parent().find(".pagers"),f&&(f.find(".pager"+e).addClass("active"),f.find(".pager"+d).removeClass("active")),$(this).trigger("slider_load_page",[j.eq(e)])))},ds.stickers=ds.stickers||{},ds.stickers={init:function(){this.$activity=$("#activity"),this.$image=$(".image");var a,b="http://api.flickr.com/services/feeds/photos_public.gne?",c={tags:"discogsstickers",tagmode:"any",format:"json"};if(this.$activity.length>0&&this.$image.length>0){for(a in c)c.hasOwnProperty(a)&&(b+=[a,"=",c[a],"&"].join(""));b+="jsoncallback=?",$.getJSON(b,this.reply).error(function(){ds.stickers.$activity.html('<a href="http://www.flickr.com/photos/tags/discogsstickers/">View sticker photos</a>')})}return!0},rotateBy:function(){return Math.floor(8*Math.random())-4},reply:function(a){var b=ds.stickers,c=$('<h3><a href="'+a.link+'">View more sticker photos...</a></h3>');b.$activity.toggle(),c.insertAfter(b.$image),$.each(a.items,b.addRotationAndLink)},addRotationAndLink:function(a,b){var c=ds.stickers,d="rotate("+ds.stickers.rotateBy()+"deg)",e='<a href="'+b.link+'" target="_blank">';$("<img />").attr("src",b.media.m).css({transform:d}).appendTo(c.$image).wrap(e)}},ds.subform=ds.subform||{},ds.subform.init=function(){var a=".help_link, .insert_track, .delete_track, .insert_index_track, #show_keyboard_help, .remove_format_description, .site_nav_group > a";return this.formats=ds.datagrab.get("subform/view:format_map"),this.mode=ds.datagrab.get("subform/view:mode"),ds.util.registerDelegate("body",{click:{".add_format_description":this.addFormatDescription,".remove_format_description":this.removeFormatDescription,".anv_toggle":this.toggleANV,".add_extra_artist_role":this.addTrackCredit,".remove_extra_artist_role":this.removeTrackCredit,".add_track_artist":this.addTrackArtist,".remove_track_artist":this.removeTrackArtist,".insert_track":this.insertTrack,".delete_track":this.deleteTrack,".insert_index_track":this.insertIndexTrack,"#auto_number_tracks":this.autoNumberTracks,"#add_artist_per_track":this.addArtistPerTrack,"#add_extra_artist_per_track":this.addExtraArtistPerTrack,"#add_tracks":this.addTracks,"#open_images":this.openImages,".button-set-primary":this.setPrimaryImage,".button-remove-image":this.removeImage,".save_draft":this.saveDraftHandler,".preview":this.preview,".release-preview-close-button":this.closePreview,".help_link":this.helpLink,"#show_keyboard_help":this.showKeyboardHelp,".track_dropdown_origin":this.toggleSubmenu},"mouseenter mouseleave":{".track_dropdown_cell":this.toggleSubmenuOrigin,".track_dropdown_origin":this.toggleSubmenu},"mouseover mouseout":{".remove_extra_artist_role":this.removeTrackCreditHover,".remove_track_artist":this.removeTrackArtistHover},submit:{"#releaseform2":this.unsetModified},keydown:{"#subform input[type=text], #subform select":this.preventFormSubmitOnReturnKey}}),this.changeEventHandlerMap={".format_name_select":this.updateFormatDescriptions,"ul.genres input":this.updateStyles,"#toggle_keyboard_shortcuts":this.toggleKeyboardShortcuts,"input.warning":this.checkWarning,"#subform input, #subform textarea, #subform select":this.setModified},ds.subform.artistField=new ds.subform.DragDropField({$container:"#artists",loadData:"loadArtists",rowTemplate:"add_artist",addButtonLabel:"Add artist",rowDefaults:{name:"",anv:"",join:""},blockRemoveFirst:!0,callback:ds.subform.artistJoinerCallback,renumberCallback:ds.subform.artistJoinerCallback}),ds.subform.entityField=new ds.subform.DragDropField({$container:"#labels",loadData:"loadEntities",rowTemplate:"add_entity",addButtonLabel:"Add label or entity",blockRemoveFirst:!0,rowAppend:{entities:ds.datagrab.get("subform/view:label_entities")},rowDefaults:{entity_type:"",name:"",catno:""}}),ds.subform.idField=new ds.subform.DragDropField({$container:"#identifiers",loadData:"loadIdentifiers",rowTemplate:"add_identifier",addButtonLabel:"Add barcode or identifier",rowAppend:{barcodes:ds.datagrab.get("subform/view:barcodes")},rowDefaults:{type:"",value:"",desc:""}}),ds.subform.creditsField=new ds.subform.DragDropField({$container:"#credits",loadData:"loadCredits",rowTemplate:"add_credit",addButtonLabel:"Add credit",header:['<ul id="credits_field_header" class="clearfix" style="display:none">',"<li>Role</li>","<li>Name</li>","<li>(ANV)</li>","<li>Track Position(s)</li>","</ul>"].join(""),rowAppend:{roles:ds.datagrab.get("subform/view:creditRoles")},rowDefaults:{role:"",name:"",anv:"",tracks:""},canSort:!1,callback:ds.subform.creditsHeaderToggle,renumberCallback:ds.subform.creditsHeaderToggle}),ds.subform.stylesField=new ds.subform.DragDropField({$container:"#styles",loadData:"loadStyles",rowTemplate:"add_style",addButtonLabel:"Add style",rowAppend:{styles:[]},rowDefaults:{style:""},canSort:!1}),ds.subform.formatsField=new ds.subform.DragDropField({$container:"#formats",loadData:"loadFormats",rowTemplate:"add_format",addButtonLabel:"Add format",blockRemoveFirst:!0,rowAppend:{qty:1,name:"",desc:[],text:""},rowDefaults:{formats:ds.datagrab.get("allFormats")}}),$(window).on("beforeunload",ds.subform.checkModified),$("#clear_country_button").click(this.clearCountry),ds.subform.updateStyles(!0),$("a").not(a).click(function(){return window.open($(this).attr("href")),!1}),ds.subform.bindCreditRoleAutocomplete(),ds.subform.modified=!1,this.bindChangeHandlers(),ds.util.initComponent(ds,"lookup"),!0},ds.subform.bindChangeHandlers=function(a){var b,c,d,e,f,g,h,i=ds.subform.changeEventHandlerMap;for(d in i)if(_.has(i,d))for(h=i[d],e=$(d,a||document.body).toArray(),b=0,c=e.length;c>b;b++)f=$(e[b]),g=f.data("change-handlers")||[],-1===_.indexOf(g,d)&&(g.push(d),f.on("change",h).data("change-handlers",g))},ds.subform.split=function(a){return a.split(/,\s*/)},ds.subform.extractLast=function(a){return ds.subform.split(a).pop()},ds.subform.bindCreditRoleAutocomplete=function(){function a(a){a.data("uiAutocomplete")&&a.autocomplete("destroy")}var b=function(a){a.autocomplete({minLength:1,source:function(a,b){b($.ui.autocomplete.filter(ds.datagrab.get("subform/view:available_credit_roles"),ds.subform.extractLast(a.term)))},focus:function(){return!1},select:function(a,b){var c=ds.subform.split(this.value);return c.pop(),c.push(b.item.value),this.value=c.join(", "),!1},open:function(){var a=$(this).data("uiAutocomplete").menu.element.children(),b=$(a.first()).children(),c=this.value.split(", "),d=_.map(b,function(a){return $(a).html()});_.intersection(d,c).length&&$(this).data("uiAutocomplete").close()}}),_.defer(function(){a.autocomplete("search",a.val())})},c=function(){var a=$(this);a.data("uiAutocomplete")||_.defer(b,a)},d=function(){var b=$(this);b.data("uiAutocomplete")&&_.delay(function(){document.activeElement!=b.get(0)&&a(b)},500)};$("#subform").on("focus",".credit_role_autocomplete",c).on("blur",".credit_role_autocomplete",d)},ds.subform.notifyRemovalWithHighlight=function(a,b){"mouseover"===b.type?a.css("background","#f77"):a.css("background","#fff")},ds.subform.updateFormatDescriptions=function(){var a=$(this).next();a.children("li").length>1&&ds.util.confirm("Are you certain you wish to change the format? Any descriptions in the row will be removed.",function(){a.children("li:not(:last)").remove()})},ds.subform.addFormatDescription=function(){var a=$(this),b=a.parents("ul.formats_descriptions_list"),c=b.parents("li"),d=c.find(".format_name_select").val(),e={desc:!1,descIndex:b.children("li").length-1,index:c.index(),availableDesc:ds.datagrab.get("allFormats")[d]};b.children("li").last().before(ds.templates.addFormatLine(e))},ds.subform.removeFormatDescription=function(){var a=$(this),b=a.parent("li"),c=a.parents("ul.formats_descriptions_list");return b.remove(),c.children("li").each(function(a){var b,c=$(this).children(".format_description");c.length&&(b=c.attr("name").split("-"),b.pop(),b.push(a),b=b.join("-"),c.attr("name",b))}),!1},ds.subform.updateStyles=function(a){var b=ds.datagrab.get("subform/view:style_map"),c=[],d=[],e=$("ul.genres input[type=checkbox]:checked");$("#styles_wrapper").toggle(!!e.length),$.each(e,function(a,d){c=c.concat(b[$(d).val()])}),c=c.sort(),ds.subform.stylesField.params.rowAppend={styles:c},_.isBoolean(a)||($("#styles ul.drag_drop_field_list select").each(function(){var a=$(this).val();d.push({style:a})}),ds.subform.stylesField.params.loadData=d),$("#styles ul.drag_drop_field_list").html(ds.subform.stylesField.createRows(ds.subform.stylesField.params.loadData))},ds.subform.toggleANV=function(){var a=$(this).parent(".anv_expander"),b=!a.hasClass("anv_editable"),c=a.find("input[type=text]");return a.toggleClass("anv_editable",b),c.prop("disabled",!b),(b?c:a.find("button")).focus(),!1},ds.subform.artistJoinerCallback=function(){var a=$("#artists ul.drag_drop_field_list > li");a.each(function(b){var c=b<a.length-1;$(this).find(".artists_join").toggle(c).prop("disabled",!c)})},ds.subform.addTrackArtist=function(){var a=$(this),b=a.next(),c=a.parents("tr"),d=c.find(".track_artists"),e='<input type="text" name="tracks-'+c.data("index")+"-artists-"+(d.find("div").length-1)+'-join" size="5" placeholder="Join" />';
d.append(ds.templates.addTrackArtist({index:c.data("index"),artist_index:d.find("div").length})),d.find("div").length>1&&(a.parent().siblings("span.small").show(),d.find("div").last().prev().append(e)),d.last().find("input[name$=name]").last().focus(),b.show()},ds.subform.removeTrackArtist=function(){var a=$(this),b=a.parents("td").find(".track_artists");b.find("div").last().remove(),b=a.parents("td").find(".track_artists"),b.find("input").last().remove(),b.find("div").length<=1&&a.parent().siblings("span.small").hide(),b.find("div").length<1&&a.hide()},ds.subform.removeTrackArtistHover=function(a){var b=$(this),c=b.parents("td").find(".track_artists div").last();ds.subform.notifyRemovalWithHighlight(c,a)},ds.subform.addTrackCredit=function(){var a=$(this),b=a.next(),c=a.parents("td").find(".track_credits"),d=a.parents("tr.track_index");c.append(ds.templates.addTrackCredit({index:d.data("index"),ea_index:c.find("div").length})),b.show(),c.siblings("span.small").show(),c.find("div:last input").first().focus()},ds.subform.removeTrackCredit=function(){var a=$(this),b=a.parents("td").find(".track_credits");b.find("div").last().remove(),b=a.parents("td").find(".track_credits"),b.find("div").length<=0&&(a.hide(),a.parent().siblings("span.small").hide())},ds.subform.removeTrackCreditHover=function(a){var b=$(this),c=b.parents("td").find(".track_credits div").last();ds.subform.notifyRemovalWithHighlight(c,a)},ds.subform.creditsHeaderToggle=function(){var a=$("#credits ul.drag_drop_field_list li");$("#credits_field_header").toggle(!!a.length)},ds.subform.renumberTrackIndexes=function(){$("#tracklist tbody tr").each(function(a){var b=$(this);b.data("index",a),b.find("input[type=text], input[type=hidden], select, textarea").each(function(){var b=$(this),c=b.attr("name");c=c.replace(/\-\d+/,["-",a].join("")),b.attr("name",c)})})},ds.subform.insertTrack=function(){var a=$(ds.templates.insertTrack({index:ds.subform.maxIndex()+1,static_server:""}));$(this).parents("tr.track_index").before(a),a.find("input:text:first").focus(),ds.subform.renumberTrackIndexes()},ds.subform.deleteTrack=function(){$(this).parents("tr.track_index").remove(),ds.subform.renumberTrackIndexes()},ds.subform.insertIndexTrack=function(){var a=$(ds.templates.insertIndexTrack({index:ds.subform.maxIndex()+1,static_server:""}));$(this).parents("tr.track_index").before(a),ds.subform.renumberTrackIndexes(),a.find("input:text:first").focus()},ds.subform.maxIndex=function(){var a=$("tr.track_index").map(function(){return $(this).data("index")});return _.max(a)},ds.subform.autoNumberTracks=function(){var a="This operation will overwrite all track positions with 1, 2, 3, etc. Are you sure you want to do this?";ds.util.confirm(a,function(){$.each($("td.track_pos input"),function(a){$(this).val(a+1)})})},ds.subform.addArtistPerTrack=function(){$(".add_track_artist").click()},ds.subform.addExtraArtistPerTrack=function(){$(".add_extra_artist_role").click()},ds.subform.addTracks=function(){var a,b,c=null,d=$("form#subform tr.track_index");for($.each(d,function(){var a;a=$(this).data("index"),c=a>c?a:c}),a=parseInt($("select[name=tracks_to_add]").val(),10),b=c;a+c>b;b++)$("form#subform #tracklist tbody").append(ds.templates.insertTrack({index:b+1,static_server:""}));d.last().next().find("td.track_pos input").focus()},ds.subform.openImages=function(){return ds.subform.saveDraft().done(function(){window.open("/release/image_popup/"+ds.subform.releaseId,"upload","status=0,height=420,width=400")})},ds.subform.refreshImages=function(){$.get("/release/images/"+$("input[name=release_id]").val(),function(a){$("#images").html(a)})},ds.subform.setPrimaryImage=function(){$("#images_working").toggle();var a=$.ajax({url:"/release/primary_image/"+$(this).data("image-id"),type:"POST"});a.done(function(){ds.subform.refreshImages(),$("#images_working").toggle()}),a.fail(function(){ds.util.alert("Failed to set primary image."),$("#images_working").toggle()})},ds.subform.removeImage=function(){var a=$(this);ds.util.confirm("Are you sure you want to delete this image?",function(){$("#images_working").toggle();var b="/release/remove_image/"+a.data("image-id"),c=$.ajax({url:b,type:"POST"});c.done(function(){ds.subform.refreshImages(),$("#images_working").toggle()}),c.fail(function(){ds.util.alert("Failed to remove image."),$("#images_working").toggle()})})},ds.subform.autoSaveDelay=1e4,ds.subform.makeDelayedAutoSave=function(){return setTimeout(function(){var a=$("#subform").serialize();(ds.subform.modified||ds.subform.lastSavedData!=a)&&ds.subform.saveDraft({mode:"auto",data:a})},ds.subform.autoSaveDelay)},ds.subform.saveDraftHandler=function(){clearTimeout(ds.subform.pendingAutoSave),ds.subform.saveDraft()},ds.subform.saveDraft=function(a){a=a||{};var b=$("input[name=release_id]").val(),c=a.mode,d=b?"/release/savedraft/"+b:"/release/savedraft",e=a.data||$("#subform").serialize(),f=$.ajax({url:d,type:"POST",data:e});return f.done(function(a){var b=$("input[name=release_id]"),d=b.val()?"Saved":"Created";"auto"===c&&(d="Auto-saved"),ds.subform.releaseId=a,b.val(a),$(".save_info").html(d+' draft #<a href="/release/'+a+'">'+a+"</a> at "+ds.subform.nowMinutes()),ds.subform.modified=!1,ds.subform.lastSavedData=e}),f.fail(function(){ds.util.alert("Failed to save draft.")}),f},ds.subform.preview=function(){$("#preview").html('<p><img src="/images/spinner.gif" /> generating preview...<p>').show();var a=$.ajax({url:"/release/preview",type:"POST",dataType:"html",data:$("#subform").serialize()+"&require_modnotes=1"});a.done(function(a){var b=$("#preview");b.html(a),$("a",b).attr("target","_blank"),ds.util.initComponent(ds,"rollover"),ds.subform.bindChangeHandlers(b)}),a.fail(function(){ds.util.alert("Failed to generate preview.")}),$("html, body").animate({scrollTop:$("#preview").offset().top},"fast")},ds.subform.checkWarning=function(){var a=function(a){return a.checked},b=_($("input.warning").toArray()).all(a);$("#submitbutton").prop("disabled",!b)},ds.subform.closePreview=function(){$("#preview").slideUp(function(){$(this).html("")})},ds.subform.setModified=function(){ds.subform.modified=!0,"add"==ds.subform.mode&&(clearTimeout(ds.subform.pendingAutoSave),ds.subform.pendingAutoSave=ds.subform.makeDelayedAutoSave())},ds.subform.unsetModified=function(){ds.subform.modified=!1,"add"==ds.subform.mode&&clearTimeout(ds.subform.pendingAutoSave)},ds.subform.checkModified=function(){return ds.subform.modified?"WARNING: You have made changes since loading this page.":void 0},ds.subform.helpLink=function(){return window.open($(this).attr("href"),"helppopup","width=400,height=500,scrollbars=yes,resizable=yes"),!1},ds.subform.showKeyboardHelp=function(){return $("#keyboard_help_modal").discogsDialog({title:"Keyboard Shortcuts Help",modal:!1,draggable:!0}),!1},ds.subform.toggleKeyboardShortcuts=function(){var a=$(this).prop("checked");$(document)[a?"on":"off"]("keyup.subform",ds.subform.keyHandler)},ds.subform.keyHandler=function(a){var b,c=[65,67,76,80,83,84];_.indexOf(c,a.which)<0||a.shiftKey&&a.ctrlKey&&(b={80:function(){$(".preview").click()},83:function(){$(".save_draft").click()},76:function(){$("html, body").animate({scrollTop:$("#labels").offset().top-50},"fast"),$("#add_entity").click()},65:function(){$("html, body").animate({scrollTop:$("#add_artist").offset().top-50},"fast"),$("#add_artist").click()},84:function(){$("html, body").animate({scrollTop:$(".track_index:last").offset().top-50},"fast"),$("#tracks_to_add").val(1),$("#add_tracks").click()},67:function(){$("html, body").animate({scrollTop:$("#add_credit").offset().top-50},"fast"),$("#add_credit").click()}},ds.util.switchMap(a.which.toString(),b),a.stopPropagation())},ds.subform.nowMinutes=function(){var a=new Date,b=a.getHours(),c=a.getMinutes(),d="am";return b>=12&&(d=" pm"),b>12&&(b-=12),0===b&&(b=12),10>c&&(c="0"+c),b+":"+c+d},ds.subform.clearCountry=function(){var a=$(this).prev(),b=a.prev();a.val(""),b.val("")},ds.subform.DragDropField=function(a){return this.params=$.extend(!0,{},this.defaults,a),this.params.$container.length||this.params.rowTemplate?(_.isString(this.params.rowTemplate)&&(this.params.rowTemplate=ds.templates[_.str.camelize(this.params.rowTemplate)]),_.isString(this.params.$container)&&(this.params.$container=$(this.params.$container)),_.isString(this.params.loadData)&&(this.params.loadData=ds.datagrab.get(this.params.loadData)),_.isArray(this.params.loadData)||(this.params.loadData=[]),this.params.$container.addClass("drag_drop_field"),this.params.$container.html([this.params.header||"",'<ul class="drag_drop_field_list">',this.createRows(this.params.loadData),"</ul>",'<button type="button" class="drag_drop_field_add_row">',this.params.addButtonLabel,"</button>"].join("")),this.params.$list=this.params.$container.children("ul.drag_drop_field_list"),this.params.canSort&&(this.params.$list.sortable(this.params.sortable),this.params.$list.on("sortupdate.drag_drop_field_update",this,this.renumber)),this.toggleHandles(),this.params.$container.on("click.drag_drop_field_add",".drag_drop_field_add_row",this,this.addRow),this.params.$container.on("click.drag_drop_field_remove",".drag_drop_field_remove_row",this,this.removeRow),_.isFunction(this.params.callback)&&this.params.callback(),ds.subform.bindChangeHandlers(this.params.$container),this):void 0},ds.subform.DragDropField.prototype.defaults={$container:!1,rowTemplate:!1,loadData:[],header:!1,addButtonLabel:"Add row",removeRowLabel:"&times; Remove",rowAppend:!1,rowDefaults:{},canSort:!0,blockRemoveFirst:!1,sortable:{axis:"y",forcePlaceholderSize:!0,handle:".drag_drop_field_row_handle",items:"> li"},callback:!1,renumberCallback:!1},ds.subform.DragDropField.prototype.createRow=function(a){a=_.isObject(this.params.rowAppend)?$.extend(!0,{},this.params.rowDefaults,this.params.rowAppend,a):$.extend(!0,{},this.params.rowDefaults,a);var b=['<li class="clearfix">'];return b.push(this.params.rowTemplate(a)),b.push('<button type="button" class="drag_drop_field_remove_row">',this.params.removeRowLabel,"</button>"),this.params.canSort&&b.push('<span class="drag_drop_field_row_handle">',"&#8597; Move","</span>"),b.push("</li>"),b.join("")},ds.subform.DragDropField.prototype.createRows=function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b],c.index=b,d.push(this.createRow(c));return d.join("")},ds.subform.DragDropField.prototype.addRow=function(a){var b=a.data,c=b.params.$list;c.append(b.createRow({index:c.children("li").length})),b.renumber({data:b}),ds.subform.bindChangeHandlers(c),c.children("li").last().find("input:text").first().focus()},ds.subform.DragDropField.prototype.removeRow=function(a){var b=a.data,c=$(this);c.parents("li").remove(),b.renumber({data:b})},ds.subform.DragDropField.prototype.renumber=function(a){var b=a.data,c=b.params.$list;c.children("li").each(function(a){var b=this;$(this).find("input, select, textarea").each(function(){var c=$(this),d=c.attr("name"),e=c.attr("id");if(d=d.replace(/\-\d+/,["-",a].join("")),c.attr("name",d),e){var f=e.replace(/\-\d+/,["-",a].join(""));c.attr("id",f),$(b).find("[data-for="+e+"]").attr("data-for",f)}})}),b.toggleHandles(),_.isFunction(b.params.renumberCallback)&&b.params.renumberCallback()},ds.subform.DragDropField.prototype.toggleHandles=function(){var a=this.params.$list,b=a.find(".drag_drop_field_row_handle"),c=a.find(".drag_drop_field_remove_row");this.params.blockRemoveFirst||(c=$({}));var d=a.children("li").length>1;b.toggle(d),c.toggle(d)},ds.subform.toggleSubmenuOrigin=function(a){var b=$(this),c=$(".track_dropdown_origin",b);c.length&&"mouseleave"==a.type?c.remove():0===c.length&&"mouseenter"==a.type&&b.append(ds.templates.trackDropdownSubmenu())},ds.subform.toggleSubmenu=function(){$(".track_dropdown",this).toggleClass("visible")},ds.subform.preventFormSubmitOnReturnKey=function(a){13===a.which&&a.preventDefault()},ds.support=ds.support||{},ds.support.init=function(){return this.closeMsg="Discogs Support has closed this request.",this.$templatePanel=null,this.templateLoaded=0,ds.util.registerDelegate("body",{click:{".support-template-panel-hide":ds.support.hidePanel,".support-save-template-2":ds.support.saveTemplate2,".support-delete-template":ds.support.deleteTemplate,".support-load-choose":ds.support.loadChoose,".support-page-event":ds.support.clickSupportPage,"#resolve":ds.support.alertResolve},keyup:{".on-key-up-support-nav-event":ds.support.nav}}),!0},ds.support.clickSupportPage=function(a){ds.support.page(a,$(this).data("support-page"))},ds.support.alertResolve=function(){$("#resolve").is(":checked")?$("#resolved-alert-message").show():$("#resolved-alert-message").hide()},ds.support.hidePanel=function(){ds.support.$templatePanel.hide().dialog("close")},ds.support.checkNew=function(){return $("#radios_hl input:checked").length<1?($("#radios_hl").effect("highlight",{},3e3),!1):$.trim($("#subject").val())?$.trim($("#request").val())?!0:($("#request").effect("highlight",{},3e3),!1):($("#subject").effect("highlight",{},3e3),!1)},ds.support.checkTalk=function(){var a=$.trim($("#message").val()),b=$("#close:checked").length,c=$("#resolve:checked").length;return a||b||c?!0:($("#message").effect("highlight",{},3e3),!1)},ds.support.area=function(a,b){var c=$(a.target).val();$.post("/support/area",{id:b,area:c}).done(function(){window.location="/support/requests?queue="+$("#current_queue").val()+"&status=New"})},ds.support.changeOwner=function(a,b){var c=$(a.target).val();$.post("/support/change_owner",{id:b,owner_uid:c}).done(function(){window.location.reload()})},ds.support.closeClick=function(){var a=$("#message");$("#close:checked").length>0&&!$.trim(a.val())?(a.val(ds.support.closeMsg),$("#sig").prop("checked",!1)):a.val()===ds.support.closeMsg&&a.val("")},ds.support.page=function(a,b){var c=$(a.target).parents("div").attr("id"),d=c.match(/support_(.+)/)[1];$.get("/support/table",{what:d,p:b}).done(function(a){$("#"+c).html($.trim(a))})},ds.support.nav=function(a){var b=$(a.target).val();13===a.keyCode&&b.match(/\w+-\w+/)&&(window.location.pathname="/support/view/"+this.value)},ds.support.initTemplatePanel=function(){_.isArray(ds.support.$templatePanel)&&ds.support.$templatePanel.length>0||(ds.support.$templatePanel=$("<div />").appendTo("body"),ds.support.$templatePanel.discogsDialog({width:900,zindex:777}),ds.support.hidePanel())},ds.support.loadTemplate=function(a){ds.support.initTemplatePanel(),ds.support.$templatePanel.dialog("option","title","Load Template"),$.get("/support/templates",{area:a}).done(ds.support.setAndShowTemplatePanel)},ds.support.setAndShowTemplatePanel=function(a){ds.support.$templatePanel.html(a).show().dialog("open")},ds.support.checkedTemplate=function(){var a=0;return $("#templates input.radio").each(function(){return $(this).prop("checked")?(a=this.id.match(/template_(\d+)/)[1],!1):void 0}),a},ds.support.loadChoose=function(){var a=ds.support.checkedTemplate();ds.support.hidePanel(),$.get("/support/template",{id:a}).done(function(b){var c=$("#message");c.val(b+"\n\n"+c.val()),ds.support.templateLoaded=a,$("#template_replace").removeClass("hidden")})},ds.support.saveTemplate=function(){var a=$("#message"),b={};return $.trim(a.val())?(ds.support.initTemplatePanel(),ds.support.$templatePanel.dialog("option","title","Save Template"),ds.support.templateLoaded&&(b.replace=ds.support.templateLoaded),$.get("/support/template_save",b).done(ds.support.setAndShowTemplatePanel),void 0):(a.effect("highlight",{},3e3),void 0)},ds.support.checkTemplate=function(a,b,c){return a?b?c?!0:($("#area").effect("highlight",{},3e3),!1):($("#description").effect("highlight",{},3e3),!1):($("#name").effect("highlight",{},3e3),!1)},ds.support.saveTemplate2=function(){var a=$.trim($("#name").val()),b=$.trim($("#description").val()),c=$.trim($("#area").val()),d=$.trim($("#message").val());ds.support.checkTemplate(a,b,c)&&$.post("/support/template_submit",{name:a,description:b,area:c,body:d,replace:$("#replace").val()}).done(ds.support.hidePanel)},ds.support.deleteTemplate=function(){var a=ds.support.checkedTemplate();if(a)return ds.util.confirm("Are you sure you want to delete this template?",function(){$.post("/support/template_delete",{id:a}).done(ds.support.hidePanel)}),!1},ds.supportNew=ds.supportNew||{},ds.supportNew.init=function(){this.formSelector="#new-support-request-form";var a="#request_areas input[type=radio]",b=$("#request_areas");return b.length||this.updateAreaFAQ(),$(a).on("change",_.bind(this.areaChanged,this)),$(this.formSelector+" select#category").on("change",_.bind(this.categoryChanged,this)),$(this.formSelector).on("submit",_.bind(this.doctorForm,this)),$.get("/support/new_json",{},_.bind(this.getData,this)),ds.supportNew.alreadyCancelledThrown()&&ds.util.track("support","NPB order already cancelled"),!0},ds.supportNew.alreadyCancelledThrown=function(){var a,b=ds.datagrab.get("form_errors"),c=!1,d=/already been cancelled.+new invoice.+fee credit/;return b&&(a=b.global_error,c=!!(a&&a[0]&&a[0].match(d))),c},ds.supportNew.doctorForm=function(a){this.formDoctored||(a.preventDefault(),this.embedAction(this.formSelector,{action:"Action.SubmitRequest"}),this.updateSubject(),this.formDoctored=!0,$(this.formSelector).submit())},ds.supportNew.embedAction=function(a,b){a=a||this.formSelector,b=b||{};var c="js-hidden-action-embed",d=$(a),e=b.action||"Action.SubmitRequest";if(d.length&&e&&!$(a+" #"+c).length){var f=$("<input>").attr("type","hidden").attr("name",e).attr("id",c).val("");d.find("fieldset").first().append(f)}},ds.supportNew.getData=function(a){this.areasMap=a.areas_map,this.userOrders=a.user_orders,this.areaChanged()},ds.supportNew.getSelectedArea=function(){return $("#request_areas input:checked").val()},ds.supportNew.getSelectedCategory=function(){return $("#category").val()},ds.supportNew.updateSubject=function(a){a=a||{};var b=this.selectedCategory,c=$("#order_id").val()||"N/A",d=/\(\((.+): (.*)\)\)(.*)/,e=$("#subject"),f=e.val();if(a.subject||""===a.subject)f=a.subject,e.val(f);else if(b&&this.availableCategories){var g=["((",b,": ",c,"))"].join(""),h=d.exec(f)||[];h.length&&(f=_.string.trim(h[3])),a.subjectOnly||(f="Other"==b?[g," ",f].join(""):g),e.val(f)}},ds.supportNew.areaChanged=function(){this.selectedArea=this.getSelectedArea(),this.selectedArea&&(this.availableCategories=this.areasMap[this.selectedArea].categories,this.updateCategorySelect(),this.categoryChanged(),this.updateCategoryContainer(),this.updateAreaFAQ())},ds.supportNew.categoryChanged=function(){this.previousCategory=this.selectedCategory,this.selectedCategory=this.getSelectedCategory(),this.selectedCategory&&this.updateOrderSelect(this.selectedCategory),this.updateSubject({subjectOnly:!0}),$("#subject-container").toggle("Other"==this.selectedCategory||!this.selectedCategory)},ds.supportNew.updateAreaFAQ=function(){var a=$("#new-support-faq"),b=this.selectedArea||"uu";b&&(a.attr("data-tags",b),a.data("inline-help").update())},ds.supportNew.updateCategoryContainer=function(){var a=$("#category-container"),b=this.availableCategories||{},c=!$.isEmptyObject(b);a.toggle(c),c||$("#category").val("")},ds.supportNew.updateCategorySelect=function(){var a=this.availableCategories,b=$("#category"),c=this.previousCategory||b.val(),d="<option value=''></option>";a&&(d=_.map(a,function(a,b){var d=b==c?"selected='selected'":"";return["<option value='",b,"' ",d,">",b,"</option>"].join("")}).join("")),b.html(d)},ds.supportNew.buildOrderList=function(a,b){var c=[];return a&&_.each(b,function(b,d){if(_.contains(a,d)){var e=[];_.each(b,function(a,b){var c=b;e.push({value:b,label:c,description:a,category:d})}),c=c.concat(_.sortBy(e,"description").reverse())}}),c},ds.supportNew.updateOrderSelect=function(a){a=a||this.getSelectedCategory();var b=this.availableCategories[a],c=$("#order_id"),d=this.buildOrderList(b,this.userOrders);this.destroyFieldAutocomplete(c),this.bindFieldToAutocomplete(c,d)},ds.supportNew.destroyFieldAutocomplete=function(a,b){var c=b?"on":"off";a.data("uiAutocomplete")&&a.autocomplete("destroy"),a.attr("autocomplete",c)},ds.supportNew.bindFieldToAutocomplete=function(a,b,c){var d=function(a){return _.map(a.split(","),$.trim)};c=c||{};var e={minLength:0,source:function(a,c){var e=d(a.term),f=e.pop(),g=_.filter(b,function(a){return!_.contains(e,a.value)});c($.ui.autocomplete.filter(g,f))},focus:function(){return!1},select:function(a,b){var c=d(this.value);return c.pop(),c.push(b.item.value),c.push(""),this.value=c.join(", "),!1}};c=$.extend(e,c),!a.data("uiAutocomplete")&&b.length>0?(a.autocomplete(c),a.data("uiAutocomplete")._renderItem=this.fieldRenderItem,a.data("uiAutocomplete")._renderMenu=this.fieldRenderMenu,a.focus(function(){$(this).data("uiAutocomplete").search($(this).val()||"")})):a.off("focus")},ds.supportNew.fieldRenderItem=function(a,b){var c,d,e;return c=['<span class="label with-sublabel" style="font-size: 12px;">',b.label,"</span>"].join(""),d=['<span class="sublabel" style="font-size: 11px; color: gray;">',b.description,"</span>"].join(""),e=["<a>",c,d,"</a>"].join(""),$("<li />").data("ui-autocomplete-item",b).append(e).appendTo(a)},ds.supportNew.fieldRenderMenu=function(a,b){var c,d=this;a.attr("style","max-height: 300px; overflow-y: auto; overflow-x: hidden;"),$.each(b,function(b,e){e.category!==c&&(a.append(["<li class='ui-autocomplete-category'>",_.string.capitalize(e.category),"</li>"].join("")),c=e.category),d._renderItem(a,e)})},ds.supportTags={init:function(){this.tagCount=0,this.container=$("#manage_support_request_tags"),this.tagInputSelector="input[type=text]#tag",this.refreshData().done(_.bind(this.renderForm,this)).done(_.bind(this.renderTags,this))},renderForm:function(){var a=this.urls["new"];return this.container.html(ds.templates.manageSupportRequestTags()),ds.inputCounter.init(),this.styleClickables(),this.container.find("i#add_tag").on("click",_.bind(this.createTag,this)),this.container.find("input#tag").on("keypress",_.bind(function(a){if(a.charCode==$.ui.keyCode.ENTER){a.preventDefault();var b=a.target;this.createTag().done(function(){$(b).focus()})}},this)),$.get(a).done(_.bind(function(a){this.suggestedTags=a.suggested_tags,this.registerAutocompleter()},this))},refreshData:function(){var a=location.pathname+"/tags";return $.get(a).done(_.bind(function(a){this.tags=a.tags,this.urls=a.urls},this))},renderTags:function(){var a=this.container.find("#tag_list");a.html(""),_.each(this.tags,_.bind(function(a){this.renderTag(a)},this))},renderTag:function(a,b,c){c=c||this.container.find("#tag_list"),b=b||this.tagCount++;var d=ds.templates.supportRequestTagRow({tag:a,index:b});c.append(d);var e=this.container.find("#tag_"+b);this.styleClickables(e),e.find("i.remove_tag").on("click",_.bind(this.destroyTag,this))},clearInput:function(){this.container.find("input#tag").val("")},registerAutocompleter:function(){var a=this.container.find(this.tagInputSelector),b={minLength:0,source:_.sortBy(_.compact(_.map(this.suggestedTags,_.bind(function(a){return _.include(this.tags,a.value)?!1:a},this))),function(a){return a.order}),select:_.bind(function(b,c){return a.val(c.item.value),!1},this)};a.data("uiAutocomplete")&&a.data("uiAutocomplete").destroy(),a.autocomplete(b),a.data("uiAutocomplete")._renderItem=this._renderSuggestedTag,a.data("uiAutocomplete")._renderMenu=this._renderSuggestedTagCategory,a.on("focus",function(){$(this).data("uiAutocomplete").search($(this).val()||"")})},_renderSuggestedTagCategory:function(a,b){var c,d=this;a.attr("style","max-height: 600px; overflow-y: auto; overflow-x: hidden;"),$.each(b,function(b,e){e.category&&e.category!==c&&!_.include(this.currentTags,e.value)&&(a.append(["<li class='ui-autocomplete-category'>",_.string.capitalize(e.category),"</li>"].join("")),c=e.category),d._renderItem(a,e)})},_renderSuggestedTag:function(a,b){if(_.include(this.currentTags,b.value))return!1;var c,d,e;return c=['<span class="label with-sublabel">',b.label,"</span>"].join(""),d=['<span class="sublabel">',b.sublabel,"</span>"].join(""),e=["<a>",c,d,"</a>"].join(""),$("<li />").data("ui-autocomplete-item",b).append(e).appendTo(a)},styleClickables:function(a){a=a||this.container,a.find("i.clickable").css("cursor","pointer"),a.find("[rel=tooltip]").tooltip()},createTag:function(){var a=this.urls.create,b=this.container.find(this.tagInputSelector).val().trim();return this.addTag(b),$.post(a,{tag:b}).done(_.bind(this.clearInput,this))},addTag:function(a){a.length&&!_.include(this.tags,a)&&(this.tags.push(a),this.renderTag(a),this.registerAutocompleter())},destroyTag:function(a){var b=this.urls.destroy,c=$(a.target),d=c.data("tag"),e=c.data("tag-row-id");return $.post(b,{tag:d}).done(_.bind(this.removeTag,this,e,d))},removeTag:function(a,b){this.tags=_.without(this.tags,b),this.container.find("#tag_"+a).remove(),this.registerAutocompleter()}},ds.update=ds.update||{},ds.update.videos=ds.update.videos||{},ds.update.images=ds.update.images||{},ds.update.preview=ds.update.preview||{},ds.update.list=ds.update.list||{},ds.update.init=function(){return ds.util.initComponent(ds.update,["images","videos","preview","list"]),location.pathname.match(/^\/update\/(artist|label)/)&&ds.update.setupArtistLabelForm(),!0},ds.update.setupArtistLabelForm=function(){var a=$("#is_invalid");if(0!==a.length){var b=$(".alt_name_field"),c=$(".valid_field"),d=$("#profile"),e=$("#alt_name"),f=function(){return!a.is(":checked")},g=function(a){b.toggle(!a),c.toggle(a)},h=function(){var a=f();g(a),a?c.find("textarea, input").val(""):(d.val("[b]DO NOT USE.[/b]"),e.val("").focus())};g(f()),a.on("click",h)}},ds.user=ds.user||{},ds.user.collection={},ds.user.create={},ds.user.expor={},ds.user.login={},ds.user.init=function(){var a,b=["collection","create","expor","login"];for(a in b)b.hasOwnProperty(a)&&ds.util.inUrl(b[a])&&ds.user[b[a]].init();return $(".select-type-change-td select").change(ds.user.collection.typeChange),!0},ds.user.collection.init=function(){return $(".user-collection-pref-add-field").click(this.addField),ds.user.collection.bindUpDown($(".up_down")),!0},ds.user.collection.bindUpDown=function(a){a.find("a:first").click(ds.user.collection.moveUp),a.find("a:last").click(ds.user.collection.moveDown)},ds.user.collection.typeChange=function(){var a=$(this).parents("tr"),b=$(this).val();a.hasClass(b)||("dropdown"===b?a.removeClass("textarea").addClass("dropdown"):a.removeClass("dropdown").addClass("textarea"))},ds.user.collection.moveUp=function(){var a=$(this).parents("tr");ds.user.collection.moveSwap(a.prev(),a)},ds.user.collection.moveDown=function(){var a=$(this).parents("tr");ds.user.collection.moveSwap(a,a.next())},ds.user.collection.posField=function(a){return a.find('input[id^="pos"]').first()},ds.user.collection.posSpan=function(a){return a.find("span.value").first()},ds.user.collection.moveSwap=function(a,b){var c,d,e;a.hasClass("field")&&b.hasClass("field")&&(b.after(a),c=ds.user.collection.posField(a),d=ds.user.collection.posField(b),e=c.val(),c.val(d.val()),d.val(e),ds.user.collection.posSpan(a).html(c.val()),ds.user.collection.posSpan(b).html(d.val()))},ds.user.collection.addField=function(){var a,b,c,d,e,f,g,h,i,j;return a=$("<tr/>"),b=$("#field_0"),f=b.attr("class"),d=ds.datagrab.get("user/collection_pref:nextFieldIds"),c=d.shift(),a.attr("id","field_"+c),f&&a.addClass(f),e=$("table.user_fields"),e.append(a),g=b.children(),g.each(function(b){h=$("<td>"+b+"</td>"),f=g.eq(b).attr("class"),f&&h.addClass(f),j=$(this).html(),j=j.replace(/0/g,c),h.html(j),a.append(h)}),i=e.find("tr.field").length,$("#pos-"+c).val(i),a.find("td.position").first().find("span.value").first().html(i),$("#name-"+c).focus(),ds.user.collection.bindUpDown(a.find(".up_down")),!1},ds.user.create.init=function(){var a=_.throttle(ds.user.create.checkName,1e3,!0);$("#username").on("keyup blur",a)},ds.user.create.sayChecking=function(){$("#namecheckmsg").show().removeClass("avail not_avail").html('<i class="icon-refresh"></i> Checking...')},ds.user.create.checkName=function(){var a=$("#username").val();ds.user.create.lastCheckedUsername!=a&&(ds.user.create.lastCheckedUsername=a,$.get("/users/namecheck",{username:a},ds.user.create.nameCheckFinish),ds.user.create.sayChecking())},ds.user.create.nameCheckFinish=function(a){var b=$("#namecheckmsg"),c=a.indexOf("is available")>-1,d="thumbs-"+(c?"up":"down");b.toggleClass("avail",c).toggleClass("not_avail",!c),a="<i class='icon-"+d+"'></i> "+a,b.html(a)},ds.user.expor.init=function(){this.updateFormats(),$('input[name="what"]').change(this.updateFormats)},ds.user.expor.updateFormats=function(){var a=$('input[name="what"]:checked').val(),b=$('input[name="format"]'),c=b.first(),d=b.last(),e="orders"===a||"inventory"===a;d.prop("disabled",e).parent().toggleClass("disabled",e),e&&c.click()},ds.user.login.init=function(){this.findFocus()},ds.user.login.findFocus=function(){ds.datagrab.get("user/login:focusOnUsername")?$("#username").focus():$("#password").focus()},ds.discuss=ds.discuss||{},ds.discuss.thread=ds.discuss.thread||{},ds.discuss.thread.init=function(){this.$form=$("#topic_reply"),this.$form.length>0&&this.$form.find('input[name="Action.Post"]').click(this.submitWrapper),(ds.util.inUrl("post")||ds.util.inUrl("topic"))&&ds.discuss.thread.addResizeMessage(),(ds.util.inUrl("topic")||ds.util.inUrl("board"))&&($(".quote_user").click(ds.discuss.thread.quoteUser),this.$groupSelector=$("#group_id"),this.$groupSelector.length>0&&this.$groupSelector.change(this.goToSelectorUrl));var a=$("body");return a.on("click",".savetopic",ds.discuss.thread.clickSaveTopic),a.on("click",".notifying",ds.discuss.thread.clickNotifying),!0},ds.discuss.thread.submitWrapper=function(){var a=ds.discuss.thread.$form,b=$(this);b.prop("disabled",!0),$('<input type="hidden" name="Action.Post" value="Post" />').appendTo(a),a.submit()},ds.discuss.thread.quoteUser=function(){var a,b,c=$("#msg");return b=$(this).data("mess-username"),c.length<1?ds.util.alert("Sorry, this function can only be used on the last page of a topic."):(a="\n[quote="+b+"]"+ds.discuss.thread.getSelection()+"[/quote]\n",ds.discuss.thread.insertAtCursor(c,a.toString()),c.focus(),ds.util.scrollTo(c)),!1},ds.discuss.thread.getSelection=function(){var a="";return window.getSelection?a=window.getSelection():document.getSelection?a=document.getSelection():document.selection&&(a=document.selection.createRange().text),a},ds.discuss.thread.insertAtCursor=function(a,b){var c,d,e;document.selection?(a.focus(),e=document.selection.createRange(),e.text=b):a.selectionStart||"0"===a.selectionStart||0===a.selectionStart?(c=a.selectionStart,d=a.selectionEnd,a.val([a.value.substring(0,c),b,a.value.substring(d,a.value.length)].join(""))):a.val(a.val()+b)},ds.discuss.thread.clickSaveTopic=function(a){var b=$(this),c=b.data("topic-id"),d=b.data("save"),e=d?"/groups/save":"/groups/unsave";$.post(e,{topic:c},function(a){b.replaceWith(a[0].html)}),a.preventDefault()},ds.discuss.thread.clickNotifying=function(a){var b=$(this),c=$(this).data("topic-id"),d=$(this).data("notify");$.post("/groups/notify",{topic:c,on:d},function(a){b.replaceWith(a[0].html)}),a.preventDefault()},ds.discuss.thread.addResizeMessage=function(){$("body").hasClass("msie")&&$("#message").resizable()},ds.discuss.thread.goToSelectorUrl=function(){window.location="/groups/board/"+this.value},ds.history=ds.history||{},ds.history.form=ds.history.form||{},ds.history.form.init=function(){if($("#save_link, #unsave_link, #deleteLink").length<1)return!1;var a=$("body");return this.$postBtn=$("#postBtn"),this.$previewBtn=$("#previewBtn"),this.$voteSelect=$("#voteSelect"),this.$comment=$("#comment"),this.$voteOptions=$("#vote_options"),this.$commentPreview=$("#commentPreview"),this.$voteSelect=$("#voteSelect"),this.$qsval=$("#qsval"),this.$rating=$("#rating"),this.$jumpnext=$("#jumpnext"),this.$deleteForm=$("#deleteForm"),this.$deleteLink=$("#deleteLink"),this.$deleteReason=$("#delete_reason"),this.$proceedDelete=$("#proceedDelete"),this.$cancelDelete=$("#cancelDelete"),this.$postBtn.click(this.post),this.$previewBtn.click(this.preview),this.$voteSelect.change(this.updateButtons),this.$proceedDelete.click(this.proceedDelete),this.$cancelDelete.click(this.cancelDelete),a.off("click.saveUnsaveLink"),a.on("click.saveUnsaveLink","#save_link, #unsave_link",this.toggleSave),$("#deleteLink a").click(this.openDelete),this.updateButtons(),!0
},ds.history.form.disable=function(){var a=ds.history.form;a.$postBtn.prop("disabled",!0),a.$previewBtn.prop("disabled",!0),a.$comment.prop("disabled",!0)},ds.history.form.enable=function(){var a=ds.history.form;a.$postBtn.prop("disabled",!1),a.$previewBtn.prop("disabled",!1),a.$comment.prop("disabled",!1)},ds.history.form.post=function(){var a,b=ds.history.form,c=b.$comment.val(),d=parseInt(b.$voteSelect.val(),10),e={};4>d>0&&!c?ds.util.alert("You must post a comment with this type of vote"):(c||d>0)&&(e.comment=c,e.vote=d,a=b.$qsval.val(),$.post("/history/post?"+a,e,b.addCallback),ds.history.form.disable())},ds.history.form.preview=function(){var a=ds.history.form,b={},c=ds.history.form.$comment.val();""!==c&&(b.comment=c,$.post("/history/preview",b,ds.history.form.previewCallback),a.$commentPreview.html("Previewing..."),a.$commentPreview.show(),ds.history.form.disable())},ds.history.form.updateButtons=function(){var a=ds.history.form;a.$postBtn.length<1||(a.$voteSelect.val()>0?a.$postBtn.val("Vote and Post Comment"):a.$postBtn.val("Post Comment"))},ds.history.form.addCallback=function(a){var b,c,d,e=ds.history.form;if(a.col0){for(c=['<tr class="datarow">'],b=0;5>b;b++)c.push("<td>"),c.push(a["col"+b]),c.push("</td>");c.push("</tr>"),d=$(c.join("")),$("#hist").append(d),d.effect("highlight",{},3e3)}a.rating&&e.$rating.html(a.rating),a.saved&&ds.history.form.toggleSave(),e.$jumpnext.length>0&&e.$jumpnext.is(":checked")&&ds.history.submissions.nextSub(),e.$comment.val(""),e.$commentPreview.hide(),ds.history.form.enable(),ds.history.form.removeVoteOptions()},ds.history.form.previewCallback=function(a){var b=ds.history.form;b.$commentPreview.html(a),ds.history.form.enable()},ds.history.form.removeVoteOptions=function(){var a=ds.history.form;a.$voteOptions.hide(),ds.history.form.updateButtons()},ds.history.form.saveStatus=function(){var a=ds.history.form;return a.$saveLink=$("#save_link"),a.$unsaveLink=$("#unsave_link"),a.$saveLink.is(":hidden")&&a.$unsaveLink.is(":not(:hidden)")},ds.history.form.toggleSave=function(){var a=ds.history.form,b=a.$qsval.val(),c=ds.history.form.saveStatus(),d=c?"off":"on";ds.history.form.toggleSaveWords(d),$.get("/history/toggle_save?"+b,{save:d})},ds.history.form.toggleSaveWords=function(a){var b=ds.history.form;b.$saveLink=$("#save_link"),b.$unsaveLink=$("#unsave_link"),"on"===a?(b.$saveLink.hide(),b.$unsaveLink.show()):(b.$unsaveLink.hide(),b.$saveLink.show())},ds.history.form.openDelete=function(){var a=ds.history.form;a.$deleteForm.show(),a.$deleteLink.hide()},ds.history.form.cancelDelete=function(){var a=ds.history.form;a.$deleteForm.hide(),a.$deleteLink.show()},ds.history.form.proceedDelete=function(){var a=ds.history.form,b=a.$deleteReason.val(),c={};b?(c.comment=b,$.post("/history/delete_release?"+a.$qsval.val(),c,ds.history.form.addCallback),ds.history.form.disable(),a.$proceedDelete.prop("disabled",!0),a.$cancelDelete.prop("disabled",!0)):ds.util.alert("You must provide a reason for removing this release.")},ds.history=ds.history||{},ds.history.submissions=ds.history.submissions||{},ds.history.submissions.init=function(){return $(".sublink").length<1?!1:(this.currentSub=-1,this.savedInitialState="",this.menuIds=ds.datagrab.get("history/browser:menuIds"),this.items=$.parseJSON(ds.datagrab.get("history/browser:items")),this.numItems=ds.datagrab.get("history/browser:numItems"),$(".sublink").click(function(){var a=$(this).data("sublink-id");ds.history.submissions.loadID(a)}),ds.history.submissions.initializeTracking(),ds.history.submissions.resize(),ds.history.submissions.initEvents(),$(window).resize(ds.history.submissions.resize),$("body").on("click",".sb-navigate",function(){var a=$(this).data("sb-navigate"),b="/history?";a=a.replace(/\\/g,""),a=a.substring(a.indexOf(b)+b.length),ds.history.submissions.navigate(a)}),!0)},ds.history.submissions.initializeTracking=function(){ds.history.submissions.savedInitialState=$("#historyData").html(),$(window).bind("hashchange",function(){var a=$.bbq.getState("item")||"init";ds.history.submissions.loadHist(a)}).trigger("hashchange")},ds.history.submissions.navigate=function(a){$.bbq.pushState({item:a})},ds.history.submissions.bindKeyEvents=function(){$(document).unbind("keyup.historySubmissions"),$(document).bind("keyup.historySubmissions",ds.history.submissions.keyHandler)},ds.history.submissions.unbindKeyEvents=function(){$(document).unbind("keyup.historySubmissions")},ds.history.submissions.initEvents=function(){var a=$("#comment, #search_q, #delete_reason, #searchq"),b=ds.history.submissions;a.focus(b.unbindKeyEvents).blur(b.bindKeyEvents),b.bindKeyEvents()},ds.history.submissions.loadID=function(a){var b=ds.history.submissions.items[a];b&&ds.history.submissions.navigate(b)},ds.history.submissions.loadHist=function(a){var b,c,d=$("#sub_"+ds.history.submissions.currentSub);!d.hasClass("on")||_(a).includeString("rev")||_(a).includeString("div")||d.removeAttr("class"),"init"===a?(b=$("#historyData"),b.html(ds.history.submissions.savedInitialState)):(c=_.indexOf(ds.history.submissions.items,a),c>-1&&(ds.history.submissions.currentSub=c,d=$("#sub_"+ds.history.submissions.currentSub),d.addClass("on")),a=a.replace(/^(artist|release|label|master)\//,"$1="),a=a.replace(/\-(rev|diff)\//,"&$1="),$.get("/history?"+a+"&browser_mode=1",ds.history.submissions.callback),ds.history.submissions.unbindKeyEvents())},ds.history.submissions.callback=function(a){var b=$("#historyData"),c=$("#hist_last_row");b.html(a),ds.util.initComponent(ds.history,"form"),ds.util.initComponent(ds,"rollover"),c.length>0&&(window.location.hash="hist_last_row"),ds.history.submissions.bindKeyEvents(),ds.history.submissions.initEvents()},ds.history.submissions.resize=function(){var a=$(window).height(),b=$(window).width();$("#items").css("height",a),$("#hpane_wrap").css({height:a,width:b-200})},ds.history.submissions.prevSub=function(){var a=ds.history.submissions.currentSub-1;a>=0&&ds.history.submissions.loadID(a)},ds.history.submissions.nextSub=function(){var a=ds.history.submissions.currentSub+1;a<=ds.history.submissions.numItems&&ds.history.submissions.loadID(a)},ds.history.submissions.selectVote=function(a){var b=$("#voteSelect"),c=48===a?0:5-(a-49);b.get(0).selectedIndex=c,ds.history.form.updateButtons()},ds.history.submissions.keyHandler=function(a){var b,c=[78,80,84,70,83,48,49,50,51,52,53];_.indexOf(c,a.which)<0||(b={78:ds.history.submissions.nextSub,80:ds.history.submissions.prevSub,83:ds.history.form.toggleSave,84:function(){var a,b=$("#historyData");b.length>0&&(a=b.offset(),a.hasOwnProperty("top")&&$("#hpane_wrap").scrollTop(a.top))},70:function(){var a,b=$(".history_form");b.length>0&&(a=b.offset(),a.hasOwnProperty("top")&&$("#hpane_wrap").scrollTop(a.top))},_default:function(){ds.history.submissions.selectVote(a.which)}},ds.util.switchMap(a.which.toString(),b),a.stopPropagation())},ds.marketplace=ds.marketplace||{},ds.marketplace.cart=ds.marketplace.cart||{},ds.marketplace.cart.init=function(){var a=$("body");this.myAbbr=ds.datagrab.get("m/cart:myCurrencyAbbr"),this.myPrefix=ds.datagrab.get("m:currencyPrefixes")[this.myAbbr];var b=$("#shipping_address_dialog");return ds.marketplace.$addressDialog=b,ds.marketplace.$termsDialog=$("#order_terms_dialog"),ds.marketplace.endpoints=ds.datagrab.get("m/cart:endpoints"),ds.marketplace.hasShippingAddress=ds.datagrab.get("m/cart:hasShippingAddress"),ds.marketplace.$interruptedOrder=null,a.on("click",".success_dismiss",ds.marketplace.dismissSuccessBlock),a.on("submit",".orders form",ds.marketplace.placeOrder),a.on("click",".edit_shipping_address",this.clickEditShippingAddress),$(".added_to_mp_cart").effect("highlight",{},3e3),$(".modified-cart-ignore").click(this.clickModifiedCartIgnore),$("#modified-cart-ignore-all").click(this.clickModifiedCartIgnoreAll),$(".modified-cart-wantlist").click(this.clickModifiedCartWantlist),$("#modified-cart-wantlist-all").click(this.clickModifiedCartWantlistAll),$(".shipping_method").bind("change keyup",this.changeShippingMethod).trigger("change"),$(".payment_method").bind("change",this.changePaymentMethod).trigger("change"),$(".order_container").each(function(){var a=ds.marketplace.cart;$(this).find(".shipping_method").length<1&&ds.marketplace.updateOrderPrices.call($(this),a.myAbbr,a.myPrefix)}),$(".show_terms").bind("click",this.clickShowTerms),b.on("submit","form",_.bind(ds.marketplace.saveShippingAddress,b)),b.on("click","#close_shipping_dialog_button",function(){b.dialog("close")}),b.discogsDialog({autoOpen:!1,open:function(){ds.marketplace.hasShippingAddress?($(".shipping_address_save").html("Save Changes"),$(".shipping_address_force").hide()):$(".shipping_address_save").html("Save and Continue")}}),ds.marketplace.$termsDialog.discogsDialog({autoOpen:!1,height:500}),!0},ds.marketplace.placeOrder=function(a){var b=$(this),c=null,d=$(this).find(".order_container"),e=d.find(".order_button"),f=d.find(".order_summary_terms_container"),g=f.find(".agree_terms"),h=f.find(".order_summary_errors"),i=d.find(":selected"),j=d.data("currency-abbr"),k=d.data("currency-prefix"),l=parseFloat(d.data("subtotal"),10),m=parseFloat(i.data("amount"),10),n=m+l;if(a.preventDefault(),!e.hasClass("disabled")){if(!g.is(":checked"))return h.html("You must agree to the order terms to continue"),f.effect("highlight",{},3e3),void 0;if(!ds.marketplace.hasShippingAddress)return ds.marketplace.$interruptedOrder=$(this),ds.marketplace.$addressDialog.dialog("open"),void 0;b.find(".order_summary_errors").empty(),e.addClass("disabled"),e.data("lastLabel",e.html()),e.html("Placing order..."),$.ajax({url:ds.marketplace.endpoints.placeOrder,type:"POST",dataType:"json",data:b.serialize(),success:function(a){window._gaq.push.apply(window._gaq,a.analytics),ds.marketplace.cart.trackOrder(a),c=$(ds.templates.orderSuccess({seller:b.find(".order_container").data("seller"),orderId:a.id,paymentUrl:a.payment_url,prefix:k,abbr:j,amount:n})),b.replaceWith(c),ds.util.scrollTo(c),ds.marketplace.modifyCartItemsTotal(-1*a.items.length)},error:function(a){e.removeClass("disabled"),e.html(e.data("lastLabel")),ds.util._alertInterior(ds.util.errorMessageFromXHR(a)).discogsDialog({buttons:{Close:function(){window.location.reload()}},title:"Discogs Alert"})}})}},ds.marketplace.dismissSuccessBlock=function(a){$(this).parents(".order_success").fadeOut(400,function(){$(this).remove()}),a.preventDefault()},ds.marketplace.saveShippingAddress=function(){var a=$(this);return $.ajax({url:ds.marketplace.endpoints.updateAddress,type:"POST",dataType:"json",data:a.find("form").serialize(),success:function(){window.location.reload()},error:function(a){ds.util.alert(ds.util.errorMessageFromXHR(a))}}),!1},ds.marketplace.updateOrderPrices=function(a,b){var c=$(this).find(":selected"),d=$(this).data("currency-abbr"),e=$(this).data("currency-prefix"),f=parseFloat($(this).data("subtotal"),10),g=parseFloat(c.data("amount"),10),h=g+f,i=ds.templates.price(ds.marketplace.priceContext(e,f,d,a,b)),j=ds.templates.price(ds.marketplace.priceContext(e,g,d,a,b)),k=ds.templates.price(ds.marketplace.priceContext(e,h,d,a,b,!0));$(this).find(".order_shipping_amount").html(j),$(this).find(".order_subtotal .order_summary_value").html(i),$(this).find(".order_total .order_summary_value").html(k)},ds.marketplace.priceContext=function(a,b,c,d,e,f){var g={prefix:a,amount:b,abbr:c,converted:c!==d};return g.converted&&(g.myAmount=ds.marketplace.cart.convertCurrency(b,c,d),g.myAbbr=d,g.myPrefix=e,g.about=!!f),g},ds.marketplace.cart.clickModifiedCartIgnore=function(){$.ajax({type:"POST",dataType:"json",url:"/sell/modified-cart/remove/"+$(this).data("release-id")}),$(this).html("ok"),$("#modified-cart li:visible").length<=1?$("#modified-cart").fadeOut(3e3):$(this).parent().fadeOut(3e3)},ds.marketplace.cart.clickModifiedCartIgnoreAll=function(){$.ajax({type:"POST",dataType:"json",url:"/sell/modified-cart/remove/all"}),$(this).html("ok"),$(".modified-cart-ignore").html("ok"),$("#modified-cart").fadeOut(3e3)},ds.marketplace.cart.clickModifiedCartWantlist=function(){$.ajax({type:"POST",dataType:"json",url:"/list/want_add",data:{release_id:$(this).data("release-id"),styleVersion:!0}}),$.ajax({type:"POST",dataType:"json",url:"/sell/modified-cart/remove/"+$(this).data("release-id")}),$(this).html("ok"),$("#modified-cart li:visible").length<=1?$("#modified-cart").fadeOut(3e3):$(this).parent().fadeOut(3e3)},ds.marketplace.cart.clickModifiedCartWantlistAll=function(){$(".modified-cart-wantlist:visible").click(),$.ajax({type:"POST",dataType:"json",url:"/sell/modified-cart/remove/all"}),$(this).html("ok"),$("#modified-cart").fadeOut(3e3)},ds.marketplace.cart.changeShippingMethod=function(){var a=ds.marketplace.cart,b=$(this).parents(".order_container"),c=$(this).find(":selected"),d=b.find(".order_shipping_hint_container"),e=b.data("seller"),f=b.data("currency-abbr"),g=b.data("currency-prefix"),h=c.data("range-type"),i=c.data("space"),j=c.data("subtotal-space"),k="Delivery in "+c.data("delivery-label");b.find(".order_shipping_time").html(k),"quantity"===h&&i?d.html(ds.templates.shippingHint({seller:e,space:i,subtotalSpace:j,abbr:f,prefix:g})):d.empty(),ds.marketplace.updateOrderPrices.call(b,a.myAbbr,a.myPrefix)},ds.marketplace.cart.changePaymentMethod=function(){var a="Place order",b=$(this).parents(".order_container"),c=b.find(".payment_method:checked");"paypal"===c.val()&&(a="Place order and pay now"),b.find(".order_button").html(a)},ds.marketplace.cart.clickShowTerms=function(a){ds.marketplace.$termsDialog.dialog("open"),a.preventDefault()},ds.marketplace.cart.clickEditShippingAddress=function(a){ds.marketplace.$addressDialog.dialog("open"),a.preventDefault()},ds.marketplace.cart.convertCurrency=function(a,b,c){var d=ds.datagrab.get("m:currencyRates");return a*d[b]/d[c]},ds.marketplace.cart.trackOrder=function(a){ga("send","event","Marketplace","Order Placed"),ga("require","ecommerce","ecommerce.js"),ga("ecommerce:addTransaction",{id:a.id,affiliation:a.seller,revenue:a.subtotal}),_(a.items).each(function(b){ga("ecommerce:addItem",{id:a.id,name:b.format,sku:b.sku,category:b.category,price:b.price,quantity:b.quantity})}),ga("ecommerce:send")},ds.marketplace=ds.marketplace||{},ds.marketplace.digital=ds.marketplace.digital||{},ds.marketplace.digital.init=function(){return this.$addToCart=$(".addToDigitalCart"),this.$changeFormat=$(".changeDigitalFormat"),this.$moreGenres=$("#moreGenres"),this.$moreGenresList=$("ul.digitalMoreGenres"),this.$addToCart.one("click",this.addToCart),this.$changeFormat.change(this.changeFormat),this.$moreGenres.click(this.toggleMoreGenres),!0},ds.marketplace.digital.addToCart=function(a){a.preventDefault();var b,c=$(this),d=c.parents(".digital_bundle_details"),e=c.data("id");return ds.datagrab.get("loggedIn")?(c.removeClass("button_green").html('<img src="/images/throbber.gif" />'),$.ajax({url:"/digital/cart",data:{add:e,f:"2"},success:function(a){var b,e='<i class="icon-shopping-cart"></i> In cart';a.redirect?window.location.href=a.redirect:(c.hasClass("bundleTrack")||(b=d.parent().next().find(".addToDigitalCart"),b.html(e),b.removeClass("addToDigitalCart button_green").unbind()),c.html(e).removeClass("button_green"))}}),ds.marketplace.modifyCartItemsTotal(1),void 0):(b=encodeURIComponent([window.location.pathname,window.location.search,"#",e].join("")),ds.util.redirect("/login?nologin=1&return="+b),void 0)},ds.marketplace.digital.changeFormat=function(){var a=$(this);$.ajax({url:"/digital/cart",data:{replace:this.id,f:a.val()},success:function(){window.location.reload()}})},ds.marketplace.digital.toggleMoreGenres=function(){var a=$(this);return ds.marketplace.digital.$moreGenresList.slideToggle(),_(a.html()).includeString("ore")?a.html("Hide"):a.html("More"),!1},ds.marketplace=ds.marketplace||{},ds.marketplace.feedback=ds.marketplace.feedback||{},ds.marketplace.feedback.init=function(){return $(".submit_feedback_button").on("click",this.submit),this.$el="",$("body").on("click",".feedback_archive_json, .feedback_unarchive_json",this.archiver),$("body").on("click",".feedback_bulk_update",this.bulkUpdate),$('input[name="reason"]').on("click",function(){$("#other_reason_label").toggle("reason-5"==this.id)}),!0},ds.marketplace.feedback.submit=function(){var a,b,c=this.id.split(".")[1],d={order_id:c};return ds.marketplace.feedback.$el=$('[id="ordercontents.'+c+'"]'),a=$('input[name="rating.'+c+'"]:checked').val(),a&&(d.rating=a.substring(0,3).toLowerCase()),d.rating?(d.comment=$.trim($('[id="comments.'+c+'"]').val()),d.comment?(b='input[name="rating.'+c+'"], '+'[id="comments.'+c+'"], .submit_feedback_button',$(b).prop("disabled",!0),$.post("/sell/save_feedback",d,ds.marketplace.feedback.submitReply),void 0):(ds.util.alert("You did not enter a comment."),!1)):(ds.util.alert("You did not choose a rating."),!1)},ds.marketplace.feedback.submitReply=function(a){var b=$.trim(a);$("#act").hide(),ds.marketplace.feedback.$el.html(b);var c=$(b).find(".feedback_view_items").data("order-id");$('button[data-order-id="'+c+'"]').on("click",function(){$(this).parent().parent().toggle(),$('div[id="line_items.'+$(this).data("order-id")+'"]').toggle()}),$(".submit_feedback_form input, .submit_feedback_form button").attr("disabled",!1)},ds.marketplace.feedback.archiver=function(){var a=$(this),b=a.parents(".outset_box"),c=a.data("mode"),d=a.data("action"),e=a.data("order-id");return $.post("/sell/archive",{mode:c,action:d,orderID:e},function(c){_.has(c,"success")&&c.success&&(a.hide(),"archive"===d?b.find(".feedback_unarchive_json").show():b.find(".feedback_archive_json").show())}),!1},ds.marketplace.feedback.bulkUpdate=function(){var a=this.id.split(".")[1],b={order_id:a};ds.marketplace.feedback.$el=$('[id="order_content.'+a+'"]'),$.post("/sell/bulk_update",b,function(b){var c=$.trim(b);ds.marketplace.feedback.$el.html(c),$('div[id="line_items.'+a+'"]').toggle()})},ds.marketplace=ds.marketplace||{},ds.marketplace.itemconditions=ds.marketplace.itemconditions||{},ds.marketplace.itemconditions.init=function(){var a,b=' (<a href="/help/mp-grading.html" target="_blank">full details</a>)';this.map={0:"","Mint (M)":"Absolutely perfect in every way. Certainly never been played. Should be used sparingly as a grade, If at all.","Near Mint (NM or M-)":"A nearly perfect record. The record should show no obvious signs of wear.","Very Good Plus (VG+)":"Will show some signs that it was played and otherwise handled by a previous owner who took good care of it.","Very Good (VG)":"Surface noise will be evident upon playing...but will not overpower the music. Groove wear will start to be noticeable, as will light scratches.","Good (G)":"Can be put onto a turntable and will play through without skipping. Significant surface noise, scratches and visible groove wear.","Good Plus (G+)":"Can be put onto a turntable and will play through without skipping. Significant surface noise, scratches and visible groove wear.","Poor (P)":"Record is cracked, badly warped, or won't play through without skipping or repeating.","Fair (F)":"Record is cracked, badly warped, or won't play through without skipping or repeating."};for(a in this.map)this.map.hasOwnProperty(a)&&"0"!==a&&(this.map[a]+=b);return this.$comments=$("#comments"),this.$commentsNotice=$("#comment_notice"),this.$descriptions=$("#descriptions"),$("#condition").change(this.displayCondition),this.$comments.keyup(this.checkWords),$("#show_m_post_seller_policy").click(function(){var a=$("#m_post_seller_policy");return a.show(),!1}),ds.priceSuggester.create($("#suggested_price"),$("#price"),$("#media_condition"),dsdata()["post:suggestedPrices"]),!0},ds.marketplace.itemconditions.displayCondition=function(){var a=ds.marketplace.itemconditions,b=a.map[this.value];a.$descriptions.html(b),_.isBlank(b)?a.$descriptions.removeClass("condesc").addClass("condesc_off"):a.$descriptions.removeClass("condesc_off").addClass("condesc")},ds.marketplace.itemconditions.checkWords=function(){var a=ds.marketplace.itemconditions,b=["promo","white label","version","reissue","repress","different catalogue","same (tracklist|tracks)","not same","not the (CD|LP|cassette|vinyl)","not listed on discogs","not on discogs","different (label|pressing|artwork)","i sell","i am selling","attention!","my copy has","minimum (order|purchase)","ebay","\\w+ (pressing|press)"],c=new RegExp(b.join("|"),"i"),d=a.$comments.val();-1!==d.search(c)?a.$commentsNotice.removeClass("condesc_off").addClass("condesc"):a.$commentsNotice.removeClass("condesc").addClass("condesc_off")},ds.marketplace=ds.marketplace||{},ds.marketplace.list=ds.marketplace.list||{},ds.marketplace.list.init=function(){return ds.util.inUrl("list_release")||ds.util.inUrl("list?release_id")||location.pathname.match(/^\/buy\//)?$("body").on("click","#toggle_tracklist",this.slideToggleTracklist):(this.$terms=$(".terms"),this.$sellerShipping=$("#seller_shipping"),this.$terms.click(this.showSellerShippingTerms),"#terms"===window.location.hash&&this.$terms.click()),this.setupAudioPlayers(),!0},ds.marketplace.list.showSellerShippingTerms=function(){var a={beforeClose:function(){window.location.hash=""},open:function(){$(this).find("a").blur(),$(this).scrollTop(0)},title:"Shipping and Payment Terms",width:800,height:600};return ds.marketplace.list.$sellerShipping.discogsDialog(a),"#terms"!==window.location.hash&&(window.location.hash="#terms"),!1},ds.marketplace.list.setupAudioPlayers=function(){var a,b,c,d=ds.datagrab.get("staticServer")||"",e=window.SWFObject||window.swfobject||!1,f={},g=ds.datagrab.get("m/list:releasesWithAudio");if(e&&g)for(b in g)g.hasOwnProperty(b)&&(c=g[b],_.has(c,"doc_id")&&_.has(c,"file")&&_.has(c,"release_id")&&(e.embedSWF(d+"/embed/mp3player.swf","player_"+c.doc_id,"100","18","7","",{file:c.file,height:"18",width:"100",showvolume:"false"}),f[c.release_id]=a))},ds.marketplace.list.slideToggleTracklist=function(){$("#tracklist").slideToggle()},ds.marketplace=ds.marketplace||{},ds.marketplace.manage=ds.marketplace.manage||{},ds.marketplace.manage.init=function(){return ds.util.inUrl("manage_edit")?this.manageEditInit():(this.$itemCheckboxes=$("input[type=checkbox][name=item]"),this.$editInventory=$(".edit-inventory"),this.$toggleBulkActions=$(".toggle_bulk_actions"),this.$bulkActionInputs=$(".bulk_action_header input"),this.$elIds=$("[name=ids]"),this.$status=$("#status"),this.bulkActionsVisible=!1,this.$itemCheckboxes.on("change",this.checkboxChangedHandler),this.$editInventory.on("click",this.editInventoryHandler),this.$toggleBulkActions.on("click",_.bind(this.toggleBulkActions,this)),this.$bulkActionInputs.change(this.updateBulkActionLabels),this.$status.change(this.changeStatus),$("body").on("click",".delete_items",this.deleteItems),_(this.$itemCheckboxes.get()).each(ds.marketplace.manage.renderRow),this.$bulkActionInputs.trigger("change")),!0},ds.marketplace.manage.checkboxChangedHandler=function(a){ds.marketplace.manage.renderRow(a.target)},ds.marketplace.manage.renderRow=function(a){var b=$(a).parents("tr"),c=a.checked;$(b).toggleClass("selected",c).toggleClass("normal",!c)},ds.marketplace.manage.toggleBulkActions=function(a){this[this.bulkActionsVisible?"hideBulkActions":"showBulkActions"](a.target),this.bulkActionsVisible=!this.bulkActionsVisible,a.preventDefault()},ds.marketplace.manage.showBulkActions=function(a){$(".bulk_actions").slideDown(),$(a).html("Hide actions &laquo;")},ds.marketplace.manage.hideBulkActions=function(a){$(".bulk_actions").slideUp(),$(a).html("Show actions &raquo;")},ds.marketplace.manage.updateBulkActionLabels=function(){ds.marketplace.manage.$bulkActionInputs.each(function(){$(this).parent().toggleClass("bulk_action_checked",this.checked)})},ds.marketplace.manage.editInventoryHandler=function(){$("#items").attr("action","/sell/manage_edit");var a=_(ds.marketplace.manage.$itemCheckboxes.filter(":checked").get()).pluck("value").join(",");return!!ds.marketplace.manage.$elIds.val(a).val()},ds.marketplace.manage.changeStatus=function(){$(this).attr("method","get").submit()},ds.marketplace.manage.manageEditInit=function(){this.$allowOffers=$(".allow_offers"),this.$copyPrice=$(".copy_price"),this.$audioReplaceRemove=$(".audio-replace, .audio-remove"),this.$audioReplace=this.$audioReplaceRemove.filter(".audio-replace"),this.$audioRemove=this.$audioReplaceRemove.filter(".audio-remove"),this.$audioCancel=$(".audio-replace-cancel, .audio-remove-cancel"),this.$priceSummaryExplain=$(".pricing_summary_explain"),this.$allAllowOffers=$(".all_allow_offers"),this.$allDisableOffers=$(".all_disable_offers"),this.$estimateButtons=$(".estimate_button"),this.$copyPrice.click(this.copyPrice),this.$audioReplace.click(this.audioReplace),this.$audioRemove.click(this.audioRemove),this.$audioReplaceRemove.click(this.audioReplaceRemove),this.$audioCancel.click(this.audioCancel),this.$priceSummaryExplain.click(this.suggest),this.$allAllowOffers.click(this.allAllowOffers),this.$allDisableOffers.click(this.allDisableOffers),this.$estimateButtons.click(this.estimate)},ds.marketplace.manage.copyPrice=function(a){$(this).parents(".item").find(".item_price").val($(this).data("price")).effect("highlight",{},1500),a.preventDefault()},ds.marketplace.manage.audioReplace=function(){var a=$(this).parent();a.find(".audio-replace, .audio-remove, .audio-separator").hide(),a.find(".audio-replacement, .audio-replace-cancel").show(),a.find(".audio-action").val("replace"),a.parent().find(".audio-player").hide()},ds.marketplace.manage.audioRemove=function(){var a=$(this).parent();a.find(".audio-replace, .audio-remove, .audio-separator").hide(),a.find(".audio-player-removed, .audio-remove-cancel").show(),a.find(".audio-action").val("remove"),a.parent().find(".audio-player").hide()},ds.marketplace.manage.audioReplaceRemove=function(a){var b=$(this).parent().parent().find(".audio-player a");b.trigger("pauseTrack",[b.attr("id")]),a.preventDefault()},ds.marketplace.manage.audioCancel=function(a){var b=$(this).parent();b.find(".audio-replace, .audio-remove, .audio-separator").show(),b.find(".audio-replacement, .audio-replace-cancel, .audio-remove-cancel, .audio-player-removed").hide(),b.find(".audio-action").val(""),b.parent().find(".audio-player").show(),a.preventDefault()},ds.marketplace.manage.suggest=function(){var a=$(this).data("release-id"),b=$(this).parent();$.get("/sell/pricing_summary/"+a,function(a){$("#act").hide(),b.html($.trim(a))})},ds.marketplace.manage.allAllowOffers=function(a){ds.marketplace.manage.$allowOffers.prop("checked",!0).parents("tr").effect("highlight",{},1500),a.preventDefault()},ds.marketplace.manage.allDisableOffers=function(a){ds.marketplace.manage.$allowOffers.prop("checked",!1).parents("tr").effect("highlight",{},1500),a.preventDefault()},ds.marketplace.manage.estimate=function(a){var b=$(this),c={action:b.data("field"),id:b.data("release-id")};$.ajax({url:"/sell/manage_edit_ajax",dataType:"json",data:c,success:function(a){ds.marketplace.manage.populateEstimation.call(b,a)},error:function(a){ds.util.alert(ds.util.errorMessageFromXHR(a))}}),a.preventDefault()},ds.marketplace.manage.populateEstimation=function(a){var b=$(this),c=b.data("field");a[c]?b.siblings(".item_"+c).val(a[c]).effect("highlight",{},1500):b.html("?").prop("disabled",!0).attr("title","Unable to estimate from release data")},ds.marketplace.manage.deleteItems=function(a){a.preventDefault(),ds.util.confirm("Are you sure you want to DELETE the items?",function(){$("#items").append('<input type="hidden" name="Action.Delete" value="Delete" />').submit()})},ds.marketplace=ds.marketplace||{},ds.marketplace.order=ds.marketplace.order||{},ds.marketplace.order.init=function(){$("body").hasClass("msie")&&$("#message").resizable(),$("#message").one("focus",function(){$("#order_latest_message").fadeIn(150)});var a=ds.datagrab.get("m/orders:mergeID");return ds.datagrab.get("m/orders:mergeID")&&$("#order"+a).effect("highlight",{},3e3),$(".toggle_conditions").click(this.toggleConditions),ds.marketplace.order.bindOrderDialog(".selected_leave_feedback","#feedback_dialog"),ds.marketplace.order.bindOrderDialog(".selected_reply_feedback","#reply_feedback_dialog"),ds.marketplace.order.bindOrderDialog(".selected_send_message","#send_message_dialog"),ds.marketplace.order.bindOrderDialog(".selected_change_status","#change_status_dialog"),!0},ds.marketplace.order.bindOrderDialog=function(a,b){$(a).on("click",function(a){var c=$(b).clone();c.saveDialog({saveClickHandler:function(){c.find("form").submit()}}),ds.marketplace.order.setupOrderDialog(c),a.preventDefault()})},ds.marketplace.order.setupOrderDialog=function(a){var b=a.find("form");$("input[name=order]:checked").each(function(){$(this).clone().attr("type","hidden").appendTo(b)}),b[0].reset()},ds.marketplace.order.toggleConditions=function(){return ds.persist.updateAt("orderPageItemConditions",$(".order_item_conditions:visible").length?"hide":"show"),$(".order_item_conditions").toggle(),!1},ds.marketplace=ds.marketplace||{},ds.marketplace.payment=ds.marketplace.payment||{},ds.marketplace.payment.init=function(){return this.$toggleSetting=$(".toggleSetting"),this.$toggleSetting.length>0&&this.$toggleSetting.each(this.toggleSetting),this.$shipsFrom=$("#pmt-cmo-useshipsfrom_n, #pmt-cmo-useshipsfrom_y"),this.$checkShipping=$("#check-shipping"),this.$shipsFrom.length>0&&this.$shipsFrom.change(this.changeShipsFrom),$("#seller_shipping").change(this.changeSellerShippingTerms),!0},ds.marketplace.payment.toggleSetting=function(){ds.marketplace.payment.doToggle(this),$(this).on("change",{obj:this},ds.marketplace.payment.doToggle)},ds.marketplace.payment.changeShipsFrom=function(){var a=this,b=ds.marketplace.payment.$checkShipping;"pmt-cmo-useshipsfrom_n"===a.id?(b.slideDown(),b.find("input, select").prop("disabled",!1)):(b.slideUp(),b.find("input, select").prop("disabled",!0))},ds.marketplace.payment.doToggle=function(a){var b=a.data?a.data.obj:a,c=$(b),d=$("."+b.id+"-fields"),e=c.parent().find("input[type=checkbox]:checked"),f=c.prop("checked")||e.length>0;d.prop("disabled",!f),d.nextAll().find("input, select").prop("disabled",!f)},ds.marketplace.payment.changeSellerShippingTerms=function(){var a=$(this);a.next().toggle(!!$.trim(a.val()).length)},ds.marketplace=ds.marketplace||{},ds.marketplace.upload=ds.marketplace.upload||{},ds.marketplace.upload.init=function(){return this.$submits=$(':submit[name="Action.Upload"]'),this.$inputs=$("#uploadTypes input"),this.$submits.click(this.clickSubmit),this.$inputs.change(this.changeInput).change(),!0},ds.marketplace.upload.clickSubmit=function(){ds.util.disableFieldButSendData.call($(this))},ds.marketplace.upload.changeInput=function(){var a,b=$(this);$("#uploadWarning").toggle("change"===b.val()),b.is(":checked")&&($("#uploadTypes").children().removeClass("selected"),$("#uploadFile").fadeIn("slow"),b.parent().addClass("selected"),a="#"+b.val()+"Help",$(".uploadHelp").hide(),$(a).fadeIn("slow"))},ds.release.events=ds.release.events||{},ds.release.events.init=function(){function a(){var a=$("body");_.each(b,function(b,c){_.each(b,function(b,d){var e={sectionName:c,actionName:d};a.on("click.tracking_events",b.selector,e,ds.release.events.track)})})}var b={Information:{"Click a track":{selector:"#tracklist tr"},"Play audio":{selector:".section.major:not(.other_versions):not(.m_versions) .dl_previewb"},"Toggle section":{selector:".toggle_section_control"}},Versions:{"Add version to collection":{selector:".section.major.other_versions .ru_coll_add, .section.major.m_versions .ru_coll_add"},"Add version to wantlist":{selector:".section.major.other_versions .ru_want_add, .section.major.m_versions .ru_want_add"},"Add version to list":{selector:".section.major.other_versions .lists-list-add, .section.major.m_versions .lists-list-add"}},Social:{"Post a review":{selector:".reviews-section-add"},"Post a reply":{selector:".review .review_action1"},"Share on Facebook":{selector:".at_facebook"},"Share on Twitter":{selector:".at_twitter"},"Select DS code":{selector:".copy_shortcut"}},"Collection and Wantlist":{"Add to collection":{selector:".coll_add_button"},"Add to wantlist":{selector:".want_add_button"}},Ratings:{"Rate release":{selector:".rating"}},Lists:{"Add to a list":{selector:".lists-list-add"}}};
return ds.initialized.then(a),!0},ds.release.events.track=function(a){var b=a.data.sectionName+": "+a.data.actionName;return ds.util.track("release_page_event",b)},ds=window.ds||{},ds.release=ds.release||{},ds.release.merge={},ds.release.merge.init=function(){if(!ds.util.inUrl("release/merge"))return!1;var a=ds.release.merge;return a.apiReleasesUri=ds.datagrab.get("apiServer")+"/releases/",a.params=$.deparam.querystring(),a.$id=$("#merge_releases"),a.$releaseIds=a.$id.find("[name=release_id]"),a.$accurateData=a.$id.find("[name=accurate_data]"),a.$mergeErrors=a.$id.find(".merge_errors"),a.$mergePreviews=a.$id.find(".merge_previews"),a.$reason=a.$id.find("[name=reason]"),a.$submit=a.$id.find("[name=submit]"),a.$result=a.$id.find(".result"),a.$releaseIds.on("change",$.proxy(a.preview,a)),a.$submit.on("click",$.proxy(a.submit,a)),_.isEmpty(a.params)?a.$releaseIds.filter(":first").focus():_.has(a.params,"release_id")&&(_.isString(a.params.release_id)?(a.$releaseIds.filter(":first").val(a.params.release_id).change(),a.$releaseIds.filter(":last").focus()):_.isArray(a.params.release_id)&&_.each(a.$releaseIds,function(b,c){$(b).val(a.params.release_id[c]).change()})),!0},ds.release.merge.preview=function(a){var b=this,c=$(a.target),d=c.data("index"),e=b.$mergeErrors.filter("[data-index="+d+"]"),f=b.$mergePreviews.filter("[data-index="+d+"]"),g=b.apiReleasesUri+c.val()+"?callback=?",h=function(a){return f.html(ds.templates.releaseMergePreview({release:a.data})),a},i=function(){var a="Release not found. Please try another Release ID.";return e.html(a),a};return e.html(""),f.html(""),$.getJSON(g).then(h,i)},ds.release.merge.valid=function(a,b,c,d){var e=[];return 2!==_.uniq(a).length&&e.push("Please enter 2 unique Release IDs."),b===!1&&e.push("Please enter 2 valid Release IDs."),_.isNaN(c)&&e.push("Please indicate which Release ID has accurate data."),d.length<10&&e.push("Please provide a detailed reason for the merge."),e},ds.release.merge.disable=function(a){a.$releaseIds.prop("disabled",!0),a.$accurateData.prop("disabled",!0),a.$reason.prop("disabled",!0),a.$submit.prop("disabled",!0)},ds.release.merge.submit=function(){var a=this,b=_.map(a.$releaseIds,function(a){return parseInt($(a).val(),10)}),c=parseInt(a.$accurateData.filter(":checked").val(),10),d=a.$reason.val(),e=_.all(a.$mergePreviews,function(a){return""!==$(a).html()}),f=ds.release.merge.valid(b,e,c,d),g=0===f.length,h="/release/merge_json",i={release_ids:b,accurate_data_index:c,reason:d};g?(a.disable(a),$.ajax({contentType:"application/json; charset=utf-8",type:"POST",dataType:"json",url:h,data:JSON.stringify(i),success:function(b){_.has(b,"errors")?ds.util.alert(b.errors.join("\n")):a.$result.html(b.history_note.split("\n").join("<br />"))}})):ds.util.alert(f.join("\n"))},ds.update.images=ds.update.images||{},ds.update.images.init=function(){return this.$imgList=$("#img_list"),this.$imgList.length<1?!1:(this.$hiddenList=$("#hidden_list"),this.$acImages=$("#ac_images"),this.$hiImages=$("#hi_images"),this.$modified=$("#is_modified"),this.$fileField=$("#thefile"),$("#img_list, #hidden_list").sortable({connectWith:".draglist",items:".dditem",receive:ds.update.images.updateHiddenImageFields,update:ds.update.images.updateHiddenImageFields}),$("#update_images_upload").submit(ds.update.images.submitForm),window.onbeforeunload=this.onBeforeUnload,this.$parent=$("#updateImages"),this.$parent.on("click",".disable_image",ds.update.images.disableImage),this.$parent.on("click",".enable_image",ds.update.images.enableImage),!0)},ds.update.images.updateHiddenImageFields=function(){var a=ds.update.images;a.$acImages.val(a.$imgList.sortable("toArray")),a.$hiImages.val(a.$hiddenList.sortable("toArray")),a.$modified.val("1")},ds.update.images.submitForm=function(){var a=ds.update.images;return $(this).ajaxSubmit({beforeSubmit:a.beforeSubmit,success:a.submitSuccess,iframe:!0}),!1},ds.update.images.beforeSubmit=function(a){var b=ds.update.images;return _.isEmpty(a)?(b.$fileField.stop(!0,!0).effect("highlight",{},3e3),!1):void 0},ds.update.images.submitSuccess=function(a){var b=ds.update.images;/^Th/.test(a)?ds.util.alert(a):(b.$imgList.append(a),b.updateHiddenImageFields()),b.$fileField.val("")},ds.update.images.onBeforeUnload=function(){var a=ds.update.images;return"1"===a.$modified.val()&&_.isBlank($("#comment").val())?($("#saveFormWrapper").effect("pulsate"),"You have unsaved changes! Fill out the submission notes to save your changes."):void 0},ds.update.images.disableImage=function(){var a=$(this).parents("li");return a.appendTo(".upload_new_image_list_disabled"),a.find(".enable_image").show(),a.find(".disable_image").hide(),ds.update.images.updateHiddenImageFields(),!1},ds.update.images.enableImage=function(){var a=$(this).parents("li");return a.appendTo("#img_list"),a.find(".enable_image").hide(),a.find(".disable_image").show(),ds.update.images.updateHiddenImageFields(),!1},ds.update.list=ds.update.list||{},ds.update.list.listedit=ds.update.list.listedit||{},ds.update.list.textedit=ds.update.list.textedit||{},ds.update.list.init=function(){function a(a){return"string"==typeof a?a.replace(/(^")|("$)/g,""):a}if($("#listtitle").length<1||!ds.datagrab.get("lists/view:editMode"))return!1;ds.lists.initialized||ds.util.initComponent(ds,"lists"),ds.update.list.listedit.title=a(ds.datagrab.get("lists/view:listTitle")||""),ds.update.list.listedit.description=a(ds.datagrab.get("lists/view:listDescription")||""),ds.update.list.listedit.comment={};for(var b,c,d,e,f=0,g="lists/view:itemType",h="lists/view:itemObid",i="lists/view:commentVal";ds.datagrab.get(g+f);)b=ds.datagrab.get(g+f),c=ds.datagrab.get(h+f),e=a(ds.datagrab.get(i+f)||""),d=b+"_"+c,ds.update.list.listedit.comment[d]=e,f++;return $(".listitem_move").on("click",ds.update.list.moveSpecial),$(".listitem_remove").on("click",ds.update.list.removeItem),$(".listitem_comment").on("click",".textedit_content, .textedit_marker",ds.update.list.editComment),$("#listtitle").on("click",ds.update.list.editTitle),$("#listdesc").on("click",ds.update.list.editDescription),$("#list_public, #list_private").on("click",ds.update.list.publish),$("#list_delete").on("click",ds.update.list.deleteList),this.$listitems=$("#listitems"),this.$listitems.sortable({items:".listitem",update:ds.update.list.moveItem}),$("#list_details a").on("click",function(a){a.stopPropagation()}),!0},ds.update.list.getId=function(){var a=$("#list_details").attr("class"),b=a.match(/list_(\d+)/),c=parseInt(b[1],10);return c},ds.update.list.getItemIds=function(a){a=a.target?$(a.target):a;var b,c=a.closest("li"),d=c.attr("id");return b=d.match(/listitem_(\d+)_([RAML])_(\d+)/),b.splice(1,3)},ds.update.list.getItemQuery=function(a,b){a=a&&a.target?$(a.target):a;var c=b||ds.update.list.getItemIds(a);return"list="+c[0]+"&what="+c[1]+"&obid="+c[2]},ds.update.list.renumber=function(){var a=parseInt($("#listitems").attr("start"),10),b=$("#listitems .listitem_number");b.each(function(){$(this).html(a),a++})},ds.update.list.moveItem=function(a,b){b=b.item;var c=parseInt($("#listitems").attr("start"),10)-1;c+=b.index(),ds.update.list.renumber(),$.ajax({type:"POST",url:"/lists/update_item",data:ds.update.list.getItemQuery(b)+"&pos="+c,success:ds.update.list.updateItemResponse})},ds.update.list.updateItemResponse=function(a){var b,c;_.has(a,"edit_text")&&"done"===a.edit_text&&ds.update.list.editTextDone(),_.has(a,"success")&&a.success&&(_.has(a,"list_comment")&&(b=["comment","content",a.list_comment.list_id,a.list_comment.what,a.list_comment.obid].join("_"),c=$("#"+b),c.length?c.html(a.list_comment.content):ds.util.alert("Does not exist: "+b)),_.has(a,"remove_item")&&(b=["listitem",a.remove_item.list_id,a.remove_item.what,a.remove_item.obid].join("_"),c=$("[id="+b+"]"),c.length?c.remove():ds.util.alert("Does not exist: "+b))),_.has(a,"list_renumber")&&a.list_renumber&&ds.update.list.renumber(),_.has(a,"window_reload")&&a.window_reload&&window.location.reload()},ds.update.list.updateResponse=function(a){_.has(a,"edit_text")&&"done"===a.edit_text&&ds.update.list.editTextDone(),_.has(a,"success")&&a.success&&(_.has(a,"list_title")&&$("#listtitle_content").html(a.list_title),_.has(a,"list_desc")&&(a.list_desc?$("#listdesc_content").html(a.list_desc):$("#listdesc_content").empty()))},ds.update.list.removeItem=function(a){a=a.target?$(a.target):$(a);var b=a.closest("li").find("a").eq(1).html();ds.util.confirm("Are you sure you want to remove "+b+"?",function(){$.ajax({type:"POST",url:"/lists/update_item",data:ds.update.list.getItemQuery(a)+"&remove=1",success:ds.update.list.updateItemResponse}),a.closest("li").hide()})},ds.update.list.moveSpecial=function(a){a=a.target?$(a.target):$(a);var b=$('<input id="list_move_special" size="5" />');ds.update.list.listedit.$movebox=b,ds.update.list.listedit.moving=ds.update.list.getItemIds(a),b.insertBefore(a),b.focus(),$("#list_details").removeClass("editable"),ds.update.list.$listitems.sortable("disable"),b.keyup(ds.update.list.moveSpecialKeyUp),setTimeout(function(){$("body").click(ds.update.list.moveSpecialCancel)},0)},ds.update.list.moveSpecialCancel=function(){$("body").unbind("click",ds.update.list.moveSpecialCancel),ds.update.list.$listitems.sortable("enable"),$("#list_details").addClass("editable"),ds.update.list.listedit.$movebox.remove()},ds.update.list.moveSpecialKeyUp=function(a){if(13===a.keyCode){var b=parseInt($("#list_move_special").val(),10);ds.update.list.moveSpecialCancel(),b&&$.ajax({type:"POST",url:"/lists/update_item",data:ds.update.list.getItemQuery(null,ds.update.list.listedit.moving)+"&pos="+(b-1)+"&reload=1",success:ds.update.list.updateItemResponse})}},ds.update.list.update=function(a){$.ajax({type:"POST",url:"/lists/update",data:"list="+ds.update.list.getId()+"&"+a,success:ds.update.list.updateResponse})},ds.update.list.publish=function(a){if(a=$(this),!a.hasClass("true")){a.addClass("true");var b="list_public"===a.attr("id");return b?($("#list_private").removeClass("true button_blue"),$("#list_public").addClass("button_blue")):($("#list_public").removeClass("true button_blue"),$("#list_private").addClass("button_blue")),b=b?1:0,ds.update.list.update("pub="+b),!1}},ds.update.list.deleteList=function(){var a=$(this).data("list-id");ds.util.confirm("Are you sure you want to delete this list?",function(){window.location=window.location.pathname+"?delete="+a})},ds.update.list.saveTitle=function(a,b){b=_.stripTags(b),b?(ds.update.list.listedit.title=b,ds.update.list.update("title="+encodeURIComponent(b))):ds.util.alert("Please enter a title.")},ds.update.list.editTitle=function(a){a=a.target?$(a.target):$(a),ds.update.list.editTextOk(a)&&ds.update.list.editText($("#listtitle"),ds.update.list.listedit.title,ds.update.list.saveTitle)},ds.update.list.saveDescription=function(a,b){b=_.stripTags(b),ds.update.list.listedit.description=b,ds.update.list.update("desc="+encodeURIComponent(b||" "))},ds.update.list.editDescription=function(a){a=a.target?$(a.target):$(a),ds.update.list.editTextOk(a)&&ds.update.list.editText($("#listdesc"),ds.update.list.listedit.description,ds.update.list.saveDescription)},ds.update.list.saveComment=function(a,b){b=_.stripTags(b);var c=ds.update.list.getItemIds(a);ds.update.list.listedit.comment[c[1]+"_"+c[2]]=b,$.ajax({type:"POST",url:"/lists/update_item",data:ds.update.list.getItemQuery(null,c)+"&comment="+encodeURIComponent(b||" "),success:ds.update.list.updateItemResponse})},ds.update.list.doneWithComment=function(){ds.update.list.$listitems.sortable("enable")},ds.update.list.editComment=function(){var a,b,c=$(this),d=c.is("span.textedit_marker")?c.prev():c;d.parents(".editable").length>0&&(ds.update.list.$listitems.sortable("disable"),a=ds.update.list.getItemIds(d),b=ds.update.list.listedit.comment[a[1]+"_"+a[2]]||"",ds.update.list.editText(d,b,ds.update.list.saveComment,ds.update.list.doneWithComment))},ds.update.list.editTextOk=function(a){return a=a.target?$(a.target):$(a),$("#text_edit").length>0||a.is("button")?!1:!0},ds.update.list.editTextSave=function(){if(ds.update.list.textedit.save){var a=$("#text_edit").val();ds.update.list.textedit.save(ds.update.list.textedit.target,a),$(ds.update.list.textedit.editable).addClass("editable")}},ds.update.list.editTextDone=function(){ds.update.list.textedit.target.html(ds.update.list.textedit.oldhtml),$(ds.update.list.textedit.editable).addClass("editable"),ds.update.list.textedit.done&&ds.update.list.textedit.done!==ds.update.list.editTextDone&&ds.update.list.textedit.done(),ds.update.list.textedit={}},ds.update.list.editText=function(a,b,c,d){a=a.target?$(a.target):$(a),a.is(":not(div)")&&(a=a.parents("div")),ds.update.list.textedit={target:a,content:b,oldhtml:a.html(),save:c,done:d,editable:a.parents(".editable")},$(ds.update.list.textedit.editable).removeClass("editable");var e='<textarea id="text_edit" rows="3" cols="50">'+b+"</textarea>"+'<button class="button button_green" onclick="ds.update.list.editTextSave();">Save</button>'+'<button class="button" '+'onclick="ds.update.list.editTextDone();">Cancel</button>';a.html(e),$("#text_edit").focus()},ds.update.preview=ds.update.preview||{},ds.update.preview.init=function(){if($("#previewDiv").length<1)return!1;var a=$("body");return a.on("click","#previewBtn",ds.update.preview.show),!0},ds.update.preview.show=function(){var a,b,c,d=$("#previewDiv");d.html("Previewing..."),d.show(),_.defer(function(){ds.util.scrollTo(d)}),a=$("#ac").val(),b=$("#qs").val(),c=$("#form1").serialize(),$.post("/update/"+a+"?"+b,c,ds.update.preview.reply)},ds.update.preview.reply=function(a){var b=$("#previewDiv");b.html("<h3>Preview</h3>"+a),ds.util.scrollTo(b)},ds.update.videos=ds.update.videos||{},ds.update.videos.init=function(){if(!ds.util.inUrl("update/videos")||$("#vid_current").length<1)return!1;var a=$("body");return this.index=1,this.$saveObid=$(".video-save-obid"),this.$search=$(".video-search-js"),this.$more=$(".video-more-js"),this.$searchInput=$("#video_q"),this.videoTitles={},this.$panel="",this.panelConfig={width:465,title:"Video",autoOpen:!1,close:this.closePanel},this.youtubeTemplate=['<iframe width="425" height="344" ','src="http://www.youtube.com/embed/{{videoID}}" ','frameborder="0" allowfullscreen>',"</iframe>"].join(""),this.videoLineTemplate=_.template($("#videoItemTemplate").html()),this.$saveObid.length>0&&this.$saveObid.click(this.saveObid),this.$search.length>0&&this.$search.click(this.search),this.$more.length>0&&this.$more.click(this.more),this.$searchInput.length>0&&this.$searchInput.keypress(this.keypressSearchInput),a.on("click",".vid_btn_add",this.add),a.on("click",".vid_btn_del",this.remove),a.on("click",".vid_btn_play",this.play),$("#vid_current, #vid_remove").sortable({items:".video_li",connectWith:"#vid_current, #vid_remove"}),this.search(),!0},ds.update.videos.search=function(){var a=ds.update.videos;a.index=1,a.more()},ds.update.videos.saveObid=function(){var a=$(this).data("obid");ds.update.videos.save(a)},ds.update.videos.save=function(a){var b=$("#vid_current").children(),c=[];b.each(function(){c.push(this.id.substr(4))}),c=c.join(",")||0,$.post("/update/video_save",{obid:a,vids:c},ds.update.videos.saveResponse)},ds.update.videos.saveResponse=function(a){!_.isEmpty(a)&&a.redirect&&ds.util.redirect(a.redirect)},ds.update.videos.more=function(){var a=ds.update.videos;$.post("/update/video_search",{q:a.$searchInput.val(),start:a.index},ds.update.videos.moreResponse)},ds.update.videos.moreResponse=function(a){var b,c,d,e=[],f=ds.update.videos,g=$("#vid_results");if(!_.isEmpty(a)){f.index=parseInt(a.videoIndex,10),c=a.videos,f.videoTitles={};var h=[];$("#vid_current").children().each(function(){h.push(this.id.substr(4))});for(b in c)c.hasOwnProperty(b)&&(d=c[b],-1===jQuery.inArray(d.id,h)&&(f.videoTitles[d.id]=d.title,d.dur=parseInt(d.dur/60,10)+":"+d.dur%60,d.desc=_($.trim(d.desc)).stripTags(),d.desc=_(d.desc).prune(200),d=f.videoLineTemplate(d),e.push(d)));g.html(e.join("")),a.checkEmptySearch&&f.checkEmptySearch()}},ds.update.videos.remove=function(){var a=ds.update.videos.getId(this),b=$("#vid_"+a);$("#vid_remove").append(b)},ds.update.videos.add=function(){var a=ds.update.videos.getId(this),b=$("#vid_"+a);$("#vid_current").append(b)},ds.update.videos.play=function(){var a=ds.update.videos.getId(this),b=ds.update.videos,c=b.youtubeTemplate.replace("{{videoID}}",a);b.initializePanel(),b.$panel.dialog("option","title",b.videoTitles[a]),b.$panel.html(c),b.$panel.dialog("open")},ds.update.videos.getId=function(a){var b,c=$(a).data("video-id");return c||(b=$(a).parent(),c=b.attr("id").replace("vid_","")),c},ds.update.videos.initializePanel=function(){var a=ds.update.videos;_.isEmpty(a.$panel)&&(a.$panel=$('<div id="video_player"></div>').appendTo($("body")),a.$panel.discogsDialog(a.panelConfig))},ds.update.videos.keypressSearchInput=function(a){return 13===a.which?(ds.update.videos.search(),!1):void 0},ds.update.videos.closePanel=function(){ds.update.videos.$panel.html("")},ds.update.videos.checkEmptySearch=function(){$("#vid_results").children().length<1&&ds.update.videos.more()};